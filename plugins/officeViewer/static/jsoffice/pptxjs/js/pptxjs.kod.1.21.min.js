!function($){$.fn.pptxToHtml=function(options){function updateProgressBar(percent){var progressBarElemtnt=$(".slides-loading-progress-bar");progressBarElemtnt.width(percent+"%"),progressBarElemtnt.html("<span style='text-align: center;'>Loading...("+percent+"%)</span>")}function convertToHtml(file){if(file.byteLength<10)return console.error("file url error ("+settings.pptxFileUrl+"0)"),void $(".slides-loadnig-msg").remove();var zip=new JSZip;zip=zip.load(file);for(var rslt_ary=processPPTX(zip),i=0;i<rslt_ary.length;i++)switch(rslt_ary[i].type){case"slide":$result.append(rslt_ary[i].data);break;case"pptx-thumb":break;case"slideSize":slideWidth=rslt_ary[i].data.width,slideHeight=rslt_ary[i].data.height;break;case"globalCSS":$result.append("<style>"+rslt_ary[i].data+"</style>");break;case"ExecutionTime":processMsgQueue(MsgQueue),setNumericBullets($(".block")),setNumericBullets($("table td")),isDone=!0,settings.slideMode&&!isSlideMode?(isSlideMode=!0,initSlideMode(divId,settings)):settings.slideMode||$(".slides-loadnig-msg").remove();break;case"progress-update":updateProgressBar(rslt_ary[i].data)}(!settings.slideMode||settings.slideMode&&"revealjs"==settings.slideType)&&(null===document.getElementById("all_slides_warpper")&&$("#"+divId+" .slide").wrapAll("<div id='all_slides_warpper' class='slides'></div>"),settings.slideMode&&"revealjs"==settings.slideType&&$("#"+divId).addClass("reveal"));var sScale=settings.slidesScale,trnsfrmScl="";if(""!=sScale){var numsScale=parseInt(sScale),scaleVal=numsScale/100;settings.slideMode&&"revealjs"!=settings.slideType&&(trnsfrmScl="transform:scale("+scaleVal+"); transform-origin:top")}var slidesHeight=$("#"+divId+" .slide").height(),numOfSlides=$("#"+divId+" .slide").length,sScaleVal=""!=sScale?scaleVal:1;$("#all_slides_warpper").attr({style:trnsfrmScl+";height: "+numOfSlides*slidesHeight*sScaleVal+"px"})}function initSlideMode(divId,settings){if(""==settings.slideType||"divs2slidesjs"==settings.slideType){var slidesHeight=$("#"+divId+" .slide").height();$("#"+divId+" .slide").hide(),setTimeout(function(){var slideConf=settings.slideModeConfig;$(".slides-loadnig-msg").remove(),$("#"+divId).divs2slides({first:slideConf.first,nav:slideConf.nav,showPlayPauseBtn:settings.showPlayPauseBtn,navTxtColor:slideConf.navTxtColor,keyBoardShortCut:slideConf.keyBoardShortCut,showSlideNum:slideConf.showSlideNum,showTotalSlideNum:slideConf.showTotalSlideNum,autoSlide:slideConf.autoSlide,randomAutoSlide:slideConf.randomAutoSlide,loop:slideConf.loop,background:slideConf.background,transition:slideConf.transition,transitionTime:slideConf.transitionTime});var sScale=settings.slidesScale,trnsfrmScl="";if(""!=sScale){var numsScale=parseInt(sScale),scaleVal=numsScale/100;trnsfrmScl="transform:scale("+scaleVal+"); transform-origin:top"}var numOfSlides=1,sScaleVal=""!=sScale?scaleVal:1;$("#all_slides_warpper").attr({style:trnsfrmScl+";height: "+numOfSlides*slidesHeight*sScaleVal+"px"})},5)}else if("revealjs"==settings.slideType){$(".slides-loadnig-msg").remove();var revealjsPath="";revealjsPath=""!=settings.revealjsPath?settings.revealjsPath:"./revealjs/reveal.js",$.getScript(revealjsPath,function(response,status){"success"==status&&Reveal.initialize(settings.revealjsConfig)})}}function processPPTX(zip){var post_ary=[],dateBefore=new Date;if(null!==zip.file("docProps/thumbnail.jpeg")){var pptxThumbImg=base64ArrayBuffer(zip.file("docProps/thumbnail.jpeg").asArrayBuffer());post_ary.push({type:"pptx-thumb",data:pptxThumbImg,slide_num:-1})}var filesInfo=getContentTypes(zip),slideSize=getSlideSizeAndSetDefaultTextStyle(zip);tableStyles=readXmlFile(zip,"ppt/tableStyles.xml"),post_ary.push({type:"slideSize",data:slideSize,slide_num:0});for(var numOfSlides=filesInfo.slides.length,i=0;numOfSlides>i;i++){var filename=filesInfo.slides[i],filename_no_path="",filename_no_path_ary=[];-1!=filename.indexOf("/")?(filename_no_path_ary=filename.split("/"),filename_no_path=filename_no_path_ary.pop()):filename_no_path=filename;var filename_no_path_no_ext="";if(-1!=filename_no_path.indexOf(".")){var filename_no_path_no_ext_ary=filename_no_path.split(".");filename_no_path_no_ext_ary.pop();filename_no_path_no_ext=filename_no_path_no_ext_ary.join(".")}var slide_number=1;""!=filename_no_path_no_ext&&-1!=filename_no_path.indexOf("slide")&&(slide_number=Number(filename_no_path_no_ext.substr(5)));var slideHtml=processSingleSlide(zip,filename,i,slideSize);post_ary.push({type:"slide",data:slideHtml,slide_num:slide_number,file_name:filename_no_path_no_ext}),post_ary.push({type:"progress-update",slide_num:numOfSlides+i+1,data:100*(i+1)/numOfSlides})}post_ary.sort(function(a,b){return a.slide_num-b.slide_num}),post_ary.push({type:"globalCSS",data:genGlobalCSS()});var dateAfter=new Date;return post_ary.push({type:"ExecutionTime",data:dateAfter-dateBefore}),post_ary}function readXmlFile(zip,filename,isSlideContent){try{var fileContent=zip.file(filename).asText();isSlideContent&&12>=app_verssion&&(fileContent=fileContent.replace(/<!\[CDATA\[(.*?)\]\]>/g,"$1"));var xmlData=tXml(fileContent,{simplify:1});return void 0!==xmlData["?xml"]?xmlData["?xml"]:xmlData}catch(e){return null}}function getContentTypes(zip){for(var ContentTypesJson=readXmlFile(zip,"[Content_Types].xml"),subObj=ContentTypesJson.Types.Override,slidesLocArray=[],slideLayoutsLocArray=[],i=0;i<subObj.length;i++)switch(subObj[i].attrs.ContentType){case"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":slidesLocArray.push(subObj[i].attrs.PartName.substr(1));break;case"application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml":slideLayoutsLocArray.push(subObj[i].attrs.PartName.substr(1))}return{slides:slidesLocArray,slideLayouts:slideLayoutsLocArray}}function getSlideSizeAndSetDefaultTextStyle(zip){var app=readXmlFile(zip,"docProps/app.xml"),app_verssion_str=app.Properties.AppVersion;app_verssion=parseInt(app_verssion_str),console.log("create by Office PowerPoint app verssion: ",app_verssion_str);var rtenObj={},content=readXmlFile(zip,"ppt/presentation.xml"),sldSzAttrs=content["p:presentation"]["p:sldSz"].attrs,sldSzWidth=parseInt(sldSzAttrs.cx),sldSzHeight=parseInt(sldSzAttrs.cy),sldSzType=sldSzAttrs.type;return console.log("Presentation size type: ",sldSzType),defaultTextStyle=content["p:presentation"]["p:defaultTextStyle"],slideWidth=sldSzWidth*slideFactor+settings.incSlide.width|0,slideHeight=sldSzHeight*slideFactor+settings.incSlide.height|0,rtenObj={width:slideWidth,height:slideHeight}}function processSingleSlide(zip,sldFileName,index,slideSize){var resName=sldFileName.replace("slides/slide","slides/_rels/slide")+".rels",resContent=readXmlFile(zip,resName),RelationshipArray=resContent.Relationships.Relationship,layoutFilename="",diagramFilename="",slideResObj={};if(RelationshipArray.constructor===Array)for(var i=0;i<RelationshipArray.length;i++)switch(RelationshipArray[i].attrs.Type){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout":layoutFilename=RelationshipArray[i].attrs.Target.replace("../","ppt/");break;case"http://schemas.microsoft.com/office/2007/relationships/diagramDrawing":diagramFilename=RelationshipArray[i].attrs.Target.replace("../","ppt/"),slideResObj[RelationshipArray[i].attrs.Id]={type:RelationshipArray[i].attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:RelationshipArray[i].attrs.Target.replace("../","ppt/")};break;case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesSlide":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart":case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink":default:slideResObj[RelationshipArray[i].attrs.Id]={type:RelationshipArray[i].attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:RelationshipArray[i].attrs.Target.replace("../","ppt/")}}else layoutFilename=RelationshipArray.attrs.Target.replace("../","ppt/");var slideLayoutContent=readXmlFile(zip,layoutFilename),slideLayoutTables=indexNodes(slideLayoutContent),sldLayoutClrOvr=getTextByPathList(slideLayoutContent,["p:sldLayout","p:clrMapOvr","a:overrideClrMapping"]);void 0!==sldLayoutClrOvr&&(slideLayoutClrOvride=sldLayoutClrOvr.attrs);var slideLayoutResFilename=layoutFilename.replace("slideLayouts/slideLayout","slideLayouts/_rels/slideLayout")+".rels",slideLayoutResContent=readXmlFile(zip,slideLayoutResFilename);RelationshipArray=slideLayoutResContent.Relationships.Relationship;var masterFilename="",layoutResObj={};if(RelationshipArray.constructor===Array)for(var i=0;i<RelationshipArray.length;i++)switch(RelationshipArray[i].attrs.Type){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster":masterFilename=RelationshipArray[i].attrs.Target.replace("../","ppt/");break;default:layoutResObj[RelationshipArray[i].attrs.Id]={type:RelationshipArray[i].attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:RelationshipArray[i].attrs.Target.replace("../","ppt/")}}else masterFilename=RelationshipArray.attrs.Target.replace("../","ppt/");var slideMasterContent=readXmlFile(zip,masterFilename),slideMasterTextStyles=getTextByPathList(slideMasterContent,["p:sldMaster","p:txStyles"]),slideMasterTables=indexNodes(slideMasterContent),slideMasterResFilename=masterFilename.replace("slideMasters/slideMaster","slideMasters/_rels/slideMaster")+".rels",slideMasterResContent=readXmlFile(zip,slideMasterResFilename);RelationshipArray=slideMasterResContent.Relationships.Relationship;var themeFilename="",masterResObj={};if(RelationshipArray.constructor===Array)for(var i=0;i<RelationshipArray.length;i++)switch(RelationshipArray[i].attrs.Type){case"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":themeFilename=RelationshipArray[i].attrs.Target.replace("../","ppt/");break;default:masterResObj[RelationshipArray[i].attrs.Id]={type:RelationshipArray[i].attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:RelationshipArray[i].attrs.Target.replace("../","ppt/")}}else themeFilename=RelationshipArray.attrs.Target.replace("../","ppt/");var themeResObj={};if(void 0!==themeFilename){var themeName=themeFilename.split("/").pop(),themeResFileName=themeFilename.replace(themeName,"_rels/"+themeName)+".rels",themeContent=readXmlFile(zip,themeFilename),themeResContent=readXmlFile(zip,themeResFileName);if(null!==themeResContent){var relationshipArray=themeResContent.Relationships.Relationship;if(void 0!==relationshipArray){var themeFilename="";if(relationshipArray.constructor===Array)for(var i=0;i<relationshipArray.length;i++)themeResObj[relationshipArray[i].attrs.Id]={type:relationshipArray[i].attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:relationshipArray[i].attrs.Target.replace("../","ppt/")};else themeResObj[relationshipArray.attrs.Id]={type:relationshipArray.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:relationshipArray.attrs.Target.replace("../","ppt/")}}}}var diagramResObj={},digramFileContent={};if(void 0!==diagramFilename){var diagName=diagramFilename.split("/").pop(),diagramResFileName=diagramFilename.replace(diagName,"_rels/"+diagName)+".rels";if(digramFileContent=readXmlFile(zip,diagramFilename),null!==digramFileContent&&void 0!==digramFileContent&&""!=digramFileContent){var digramFileContentObjToStr=JSON.stringify(digramFileContent);digramFileContentObjToStr=digramFileContentObjToStr.replace(/dsp:/g,"p:"),digramFileContent=JSON.parse(digramFileContentObjToStr)}var digramResContent=readXmlFile(zip,diagramResFileName);if(null!==digramResContent){var relationshipArray=digramResContent.Relationships.Relationship,themeFilename="";if(relationshipArray.constructor===Array)for(var i=0;i<relationshipArray.length;i++)diagramResObj[relationshipArray[i].attrs.Id]={type:relationshipArray[i].attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:relationshipArray[i].attrs.Target.replace("../","ppt/")};else diagramResObj[relationshipArray.attrs.Id]={type:relationshipArray.attrs.Type.replace("http://schemas.openxmlformats.org/officeDocument/2006/relationships/",""),target:relationshipArray.attrs.Target.replace("../","ppt/")}}}var slideContent=readXmlFile(zip,sldFileName,!0),nodes=slideContent["p:sld"]["p:cSld"]["p:spTree"],warpObj={zip:zip,slideLayoutContent:slideLayoutContent,slideLayoutTables:slideLayoutTables,slideMasterContent:slideMasterContent,slideMasterTables:slideMasterTables,slideContent:slideContent,slideResObj:slideResObj,slideMasterTextStyles:slideMasterTextStyles,layoutResObj:layoutResObj,masterResObj:masterResObj,themeContent:themeContent,themeResObj:themeResObj,digramFileContent:digramFileContent,diagramResObj:diagramResObj,defaultTextStyle:defaultTextStyle},bgResult="";processFullTheme===!0&&(bgResult=getBackground(warpObj,slideSize,index));var bgColor="";if("colorsAndImageOnly"==processFullTheme&&(bgColor=getSlideBackgroundFill(warpObj,index)),settings.slideMode&&"revealjs"==settings.slideType)var result="<section class='slide' style='width:"+slideSize.width+"px; height:"+slideSize.height+"px;"+bgColor+"'>";else var result="<div class='slide' style='width:"+slideSize.width+"px; height:"+slideSize.height+"px;"+bgColor+"'>";result+=bgResult;for(var nodeKey in nodes)if(nodes[nodeKey].constructor===Array)for(var i=0;i<nodes[nodeKey].length;i++)result+=processNodesInSlide(nodeKey,nodes[nodeKey][i],nodes,warpObj,"slide");else result+=processNodesInSlide(nodeKey,nodes[nodeKey],nodes,warpObj,"slide");return settings.slideMode&&"revealjs"==settings.slideType?result+"</div></section>":result+"</div></div>"}function indexNodes(content){var keys=Object.keys(content),spTreeNode=content[keys[0]]["p:cSld"]["p:spTree"],idTable={},idxTable={},typeTable={};for(var key in spTreeNode)if("p:nvGrpSpPr"!=key&&"p:grpSpPr"!=key){var targetNode=spTreeNode[key];if(targetNode.constructor===Array)for(var i=0;i<targetNode.length;i++){var nvSpPrNode=targetNode[i]["p:nvSpPr"],id=getTextByPathList(nvSpPrNode,["p:cNvPr","attrs","id"]),idx=getTextByPathList(nvSpPrNode,["p:nvPr","p:ph","attrs","idx"]),type=getTextByPathList(nvSpPrNode,["p:nvPr","p:ph","attrs","type"]);void 0!==id&&(idTable[id]=targetNode[i]),void 0!==idx&&(idxTable[idx]=targetNode[i]),void 0!==type&&(typeTable[type]=targetNode[i])}else{var nvSpPrNode=targetNode["p:nvSpPr"],id=getTextByPathList(nvSpPrNode,["p:cNvPr","attrs","id"]),idx=getTextByPathList(nvSpPrNode,["p:nvPr","p:ph","attrs","idx"]),type=getTextByPathList(nvSpPrNode,["p:nvPr","p:ph","attrs","type"]);void 0!==id&&(idTable[id]=targetNode),void 0!==idx&&(idxTable[idx]=targetNode),void 0!==type&&(typeTable[type]=targetNode)}}return{idTable:idTable,idxTable:idxTable,typeTable:typeTable}}function processNodesInSlide(nodeKey,nodeValue,nodes,warpObj,source,sType){var result="";switch(nodeKey){case"p:sp":result=processSpNode(nodeValue,nodes,warpObj,source,sType);break;case"p:cxnSp":result=processCxnSpNode(nodeValue,nodes,warpObj,source,sType);break;case"p:pic":result=processPicNode(nodeValue,warpObj,source,sType);break;case"p:graphicFrame":result=processGraphicFrameNode(nodeValue,warpObj,source,sType);break;case"p:grpSp":result=processGroupSpNode(nodeValue,warpObj,source);break;case"mc:AlternateContent":var mcFallbackNode=getTextByPathList(nodeValue,["mc:Fallback"]);result=processGroupSpNode(mcFallbackNode,warpObj,source)}return result}function processGroupSpNode(node,warpObj,source){var xfrmNode=getTextByPathList(node,["p:grpSpPr","a:xfrm"]);if(void 0!==xfrmNode){var x=parseInt(xfrmNode["a:off"].attrs.x)*slideFactor,y=parseInt(xfrmNode["a:off"].attrs.y)*slideFactor,chx=parseInt(xfrmNode["a:chOff"].attrs.x)*slideFactor,chy=parseInt(xfrmNode["a:chOff"].attrs.y)*slideFactor,cx=parseInt(xfrmNode["a:ext"].attrs.cx)*slideFactor,cy=parseInt(xfrmNode["a:ext"].attrs.cy)*slideFactor,chcx=parseInt(xfrmNode["a:chExt"].attrs.cx)*slideFactor,chcy=parseInt(xfrmNode["a:chExt"].attrs.cy)*slideFactor,rotate=parseInt(xfrmNode.attrs.rot),rotStr="",top=y-chy,left=x-chx,width=cx-chcx,height=cy-chcy,sType="group";isNaN(rotate)||(rotate=angleToDegrees(rotate),rotStr+="transform: rotate("+rotate+"deg) ; transform-origin: center;",0!=rotate&&(top=y,left=x,width=cx,height=cy,sType="group-rotate"))}var grpStyle="";void 0!==rotStr&&""!=rotStr&&(grpStyle+=rotStr),void 0!==top&&(grpStyle+="top: "+top+"px;"),void 0!==left&&(grpStyle+="left: "+left+"px;"),void 0!==width&&(grpStyle+="width:"+width+"px;"),void 0!==height&&(grpStyle+="height: "+height+"px;");var order=node.attrs.order,result="<div class='block group' style='z-index: "+order+";"+grpStyle+" border:1px solid red;'>";for(var nodeKey in node)if(node[nodeKey].constructor===Array)for(var i=0;i<node[nodeKey].length;i++)result+=processNodesInSlide(nodeKey,node[nodeKey][i],node,warpObj,source,sType);else result+=processNodesInSlide(nodeKey,node[nodeKey],node,warpObj,source,sType);return result+="</div>"}function processSpNode(node,pNode,warpObj,source,sType){var isUserDrawnBg,id=getTextByPathList(node,["p:nvSpPr","p:cNvPr","attrs","id"]),name=getTextByPathList(node,["p:nvSpPr","p:cNvPr","attrs","name"]),idx=void 0===getTextByPathList(node,["p:nvSpPr","p:nvPr","p:ph","attrs","idx"])?void 0:getTextByPathList(node,["p:nvSpPr","p:nvPr","p:ph","attrs","idx"]),type=void 0===getTextByPathList(node,["p:nvSpPr","p:nvPr","p:ph","attrs","type"])?void 0:getTextByPathList(node,["p:nvSpPr","p:nvPr","p:ph","attrs","type"]),order=getTextByPathList(node,["attrs","order"]);if("slideLayoutBg"==source||"slideMasterBg"==source){var userDrawn=getTextByPathList(node,["p:nvSpPr","p:nvPr","attrs","userDrawn"]);isUserDrawnBg="1"==userDrawn?!0:!1}var slideLayoutSpNode=void 0,slideMasterSpNode=void 0;return void 0!==idx?(slideLayoutSpNode=warpObj.slideLayoutTables.idxTable[idx],slideMasterSpNode=void 0!==type?warpObj.slideMasterTables.typeTable[type]:warpObj.slideMasterTables.idxTable[idx]):void 0!==type&&(slideLayoutSpNode=warpObj.slideLayoutTables.typeTable[type],slideMasterSpNode=warpObj.slideMasterTables.typeTable[type]),void 0===type&&(txBoxVal=getTextByPathList(node,["p:nvSpPr","p:cNvSpPr","attrs","txBox"]),"1"==txBoxVal&&(type="textBox")),void 0===type&&(type=getTextByPathList(slideLayoutSpNode,["p:nvSpPr","p:nvPr","p:ph","attrs","type"]),void 0===type&&(type="diagramBg"==source?"diagram":"obj")),genShape(node,pNode,slideLayoutSpNode,slideMasterSpNode,id,name,idx,type,order,warpObj,isUserDrawnBg,sType,source)}function processCxnSpNode(node,pNode,warpObj,source,sType){var id=node["p:nvCxnSpPr"]["p:cNvPr"].attrs.id,name=node["p:nvCxnSpPr"]["p:cNvPr"].attrs.name,idx=void 0===node["p:nvCxnSpPr"]["p:nvPr"]["p:ph"]?void 0:node["p:nvSpPr"]["p:nvPr"]["p:ph"].attrs.idx,type=void 0===node["p:nvCxnSpPr"]["p:nvPr"]["p:ph"]?void 0:node["p:nvSpPr"]["p:nvPr"]["p:ph"].attrs.type,order=node.attrs.order;return genShape(node,pNode,void 0,void 0,id,name,idx,type,order,warpObj,void 0,sType,source)}function genShape(node,pNode,slideLayoutSpNode,slideMasterSpNode,id,name,idx,type,order,warpObj,isUserDrawnBg,sType,source){var xfrmList=["p:spPr","a:xfrm"],slideXfrmNode=getTextByPathList(node,xfrmList),slideLayoutXfrmNode=getTextByPathList(slideLayoutSpNode,xfrmList),slideMasterXfrmNode=getTextByPathList(slideMasterSpNode,xfrmList),result="",shpId=getTextByPathList(node,["attrs","order"]),shapType=getTextByPathList(node,["p:spPr","a:prstGeom","attrs","prst"]),custShapType=getTextByPathList(node,["p:spPr","a:custGeom"]),isFlipV=!1,isFlipH=!1,flip="";"1"===getTextByPathList(slideXfrmNode,["attrs","flipV"])&&(isFlipV=!0),"1"===getTextByPathList(slideXfrmNode,["attrs","flipH"])&&(isFlipH=!0),isFlipH&&!isFlipV?flip=" scale(-1,1)":!isFlipH&&isFlipV?flip=" scale(1,-1)":isFlipH&&isFlipV&&(flip=" scale(-1,-1)");var txtRotate,rotate=angleToDegrees(getTextByPathList(slideXfrmNode,["attrs","rot"])),txtXframeNode=getTextByPathList(node,["p:txXfrm"]);if(void 0!==txtXframeNode){var txtXframeRot=getTextByPathList(txtXframeNode,["attrs","rot"]);void 0!==txtXframeRot&&(txtRotate=angleToDegrees(txtXframeRot)+90)}else txtRotate=rotate;if(void 0!==shapType||void 0!==custShapType){var off=getTextByPathList(slideXfrmNode,["a:off","attrs"]),ext=(parseInt(off.x)*slideFactor,parseInt(off.y)*slideFactor,getTextByPathList(slideXfrmNode,["a:ext","attrs"])),w=parseInt(ext.cx)*slideFactor,h=parseInt(ext.cy)*slideFactor,svgCssName="_svg_css_"+(Object.keys(styleTable).length+1)+"_"+Math.floor(1001*Math.random()),effectsClassName=svgCssName+"_effects";result+="<svg class='drawing "+svgCssName+" "+effectsClassName+" ' _id='"+id+"' _idx='"+idx+"' _type='"+type+"' _name='"+name+"'' style='"+getPosition(slideXfrmNode,pNode,void 0,void 0,sType)+getSize(slideXfrmNode,void 0,void 0)+" z-index: "+order+";transform: rotate("+(void 0!==rotate?rotate:0)+"deg)"+flip+";'>",result+="<defs>";var fillColor=getShapeFill(node,pNode,!0,warpObj,source),grndFillFlg=!1,imgFillFlg=!1,clrFillType=getFillType(getTextByPathList(node,["p:spPr"]));if("GROUP_FILL"==clrFillType&&(clrFillType=getFillType(getTextByPathList(pNode,["p:grpSpPr"]))),"GRADIENT_FILL"==clrFillType){grndFillFlg=!0;var color_arry=fillColor.color,angl=fillColor.rot+90,svgGrdnt=getSvgGradient(w,h,angl,color_arry,shpId);result+=svgGrdnt}else if("PIC_FILL"==clrFillType){imgFillFlg=!0;var svgBgImg=getSvgImagePattern(node,fillColor,shpId,warpObj);result+=svgBgImg}else if("PATTERN_FILL"==clrFillType){var styleText=fillColor;styleText in styleTable&&(styleText+="do-nothing: "+svgCssName+";"),styleTable[styleText]={name:svgCssName,text:styleText},fillColor="none"}else"SOLID_FILL"==clrFillType||"PATTERN_FILL"==clrFillType||"arc"!=shapType&&"bracketPair"!=shapType&&"bracePair"!=shapType&&"leftBracket"!=shapType&&"leftBrace"!=shapType&&"rightBrace"!=shapType&&"rightBracket"!=shapType||(fillColor="none");var border=getBorder(node,pNode,!0,"shape",warpObj),headEndNodeAttrs=getTextByPathList(node,["p:spPr","a:ln","a:headEnd","attrs"]),tailEndNodeAttrs=getTextByPathList(node,["p:spPr","a:ln","a:tailEnd","attrs"]),outerShdwNode=getTextByPathList(node,["p:spPr","a:effectLst","a:outerShdw"]),oShadowSvgUrlStr="";if(void 0!==outerShdwNode){var chdwClrNode=getSolidFill(outerShdwNode,void 0,void 0,warpObj),outerShdwAttrs=outerShdwNode.attrs,dir=outerShdwAttrs.dir?parseInt(outerShdwAttrs.dir)/6e4:0,dist=parseInt(outerShdwAttrs.dist)*slideFactor,blurRad=outerShdwAttrs.blurRad?parseInt(outerShdwAttrs.blurRad)*slideFactor:"",vx=dist*Math.sin(dir*Math.PI/180),hx=dist*Math.cos(dir*Math.PI/180),svg_css_shadow="filter:drop-shadow("+hx+"px "+vx+"px "+blurRad+"px #"+chdwClrNode+");";svg_css_shadow in styleTable&&(svg_css_shadow+="do-nothing: "+svgCssName+";"),styleTable[svg_css_shadow]={name:effectsClassName,text:svg_css_shadow}}if(void 0!==headEndNodeAttrs&&("triangle"===headEndNodeAttrs.type||"arrow"===headEndNodeAttrs.type)||void 0!==tailEndNodeAttrs&&("triangle"===tailEndNodeAttrs.type||"arrow"===tailEndNodeAttrs.type)){var triangleMarker="<marker id='markerTriangle_"+shpId+"' viewBox='0 0 10 10' refX='1' refY='5' markerWidth='5' markerHeight='5' stroke='"+border.color+"' fill='"+border.color+"' orient='auto-start-reverse' markerUnits='strokeWidth'><path d='M 0 0 L 10 5 L 0 10 z' /></marker>";result+=triangleMarker}result+="</defs>"}if(void 0!==shapType&&void 0===custShapType){switch(shapType){case"rect":case"flowChartProcess":case"flowChartPredefinedProcess":case"flowChartInternalStorage":case"actionButtonBlank":result+="<rect x='0' y='0' width='"+w+"' height='"+h+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' "+oShadowSvgUrlStr+"  />","flowChartPredefinedProcess"==shapType?result+="<rect x='"+w*(1/8)+"' y='0' width='"+.75*w+"' height='"+h+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />":"flowChartInternalStorage"==shapType&&(result+=" <polyline points='"+w*(1/8)+" 0,"+w*(1/8)+" "+h+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />",result+=" <polyline points='0 "+h*(1/8)+","+w+" "+h*(1/8)+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />");break;case"flowChartCollate":var d="M 0,0 L"+w+",0 L0,"+h+" L"+w+","+h+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartDocument":var y1,y2,y3,x1;x1=10800*w/21600,y1=17322*h/21600,y2=20172*h/21600,y3=23922*h/21600;var d="M0,0 L"+w+",0 L"+w+","+y1+" C"+x1+","+y1+" "+x1+","+y3+" 0,"+y2+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartMultidocument":var y1,y2,y3,y4,y5,y6,y7,y8,y9,x1,x2,x3,x4,x5,x6,x7;y1=18022*h/21600,y2=3675*h/21600,y3=23542*h/21600,y4=1815*h/21600,y5=16252*h/21600,y6=16352*h/21600,y7=14392*h/21600,y8=20782*h/21600,y9=14467*h/21600,x1=1532*w/21600,x2=2e4*w/21600,x3=9298*w/21600,x4=19298*w/21600,x5=18595*w/21600,x6=2972*w/21600,x7=20800*w/21600;var d="M0,"+y2+" L"+x5+","+y2+" L"+x5+","+y1+" C"+x3+","+y1+" "+x3+","+y3+" 0,"+y8+" zM"+x1+","+y2+" L"+x1+","+y4+" L"+x2+","+y4+" L"+x2+","+y5+" C"+x4+","+y5+" "+x5+","+y6+" "+x5+","+y6+"M"+x6+","+y4+" L"+x6+",0 L"+w+",0 L"+w+","+y7+" C"+x7+","+y7+" "+x2+","+y9+" "+x2+","+y9;result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonBackPrevious":var dx2,g9,g10,g11,g12,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2;var d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" zM"+g11+","+vc+" L"+g12+","+g9+" L"+g12+","+g10+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonBeginning":var dx2,g9,g10,g11,g12,g13,g14,g15,g16,g17,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2,g13=3*ss/4,g14=g13/8,g15=g13/4,g16=g11+g14,g17=g11+g15;var d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" zM"+g17+","+vc+" L"+g12+","+g9+" L"+g12+","+g10+" zM"+g16+","+g9+" L"+g11+","+g9+" L"+g11+","+g10+" L"+g16+","+g10+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonDocument":var dx2,g9,g10,dx1,g11,g12,g13,g14,g15,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,dx1=9*ss/32,g11=hc-dx1,g12=hc+dx1,g13=3*ss/16,g14=g12-g13,g15=g9+g13;var d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" zM"+g11+","+g9+" L"+g14+","+g9+" L"+g12+","+g15+" L"+g12+","+g10+" L"+g11+","+g10+" zM"+g14+","+g9+" L"+g14+","+g15+" L"+g12+","+g15+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonEnd":var dx2,g9,g10,g11,g12,g13,g14,g15,g16,g17,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2,g13=3*ss/4,g14=3*g13/4,g15=7*g13/8,g16=g11+g14,g17=g11+g15;var d="M0,"+h+" L"+w+","+h+" L"+w+",0 L0,0 z M"+g17+","+g9+" L"+g12+","+g9+" L"+g12+","+g10+" L"+g17+","+g10+" z M"+g16+","+vc+" L"+g11+","+g9+" L"+g11+","+g10+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonForwardNext":var dx2,g9,g10,g11,g12,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2;var d="M0,"+h+" L"+w+","+h+" L"+w+",0 L0,0 z M"+g12+","+vc+" L"+g11+","+g9+" L"+g11+","+g10+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonHelp":var dx2,g9,g11,g13,g14,g15,g16,g19,g20,g21,g23,g24,g27,g29,g30,g31,g33,g36,g37,g41,g42,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g11=hc-dx2,g13=3*ss/4,g14=g13/7,g15=3*g13/14,g16=2*g13/7,g19=3*g13/7,g20=4*g13/7,g21=17*g13/28,g23=21*g13/28,g24=11*g13/14,g27=g9+g16,g29=g9+g21,g30=g9+g23,g31=g9+g24,g33=g11+g15,g36=g11+g19,g37=g11+g20,g41=g13/14,g42=3*g13/28;var cX1=g33+g16,cX2=g36+g14,cY3=g31+g42,cX4=(g37+g36+g16)/2,d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" zM"+g33+","+g27+shapeArc(cX1,g27,g16,g16,180,360,!1).replace("M","L")+shapeArc(cX4,g27,g14,g15,0,90,!1).replace("M","L")+shapeArc(cX4,g29,g41,g42,270,180,!1).replace("M","L")+" L"+g37+","+g30+" L"+g36+","+g30+" L"+g36+","+g29+shapeArc(cX2,g29,g14,g15,180,270,!1).replace("M","L")+shapeArc(g37,g27,g41,g42,90,0,!1).replace("M","L")+shapeArc(cX1,g27,g14,g14,0,-180,!1).replace("M","L")+" zM"+hc+","+g31+shapeArc(hc,cY3,g42,g42,270,630,!1).replace("M","L")+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonHome":var dx2,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,g27,g28,g29,g30,g31,g32,g33,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2,g13=3*ss/4,g14=g13/16,g15=g13/8,g16=3*g13/16,g17=5*g13/16,g18=7*g13/16,g19=9*g13/16,g20=11*g13/16,g21=3*g13/4,g22=13*g13/16,g23=7*g13/8,g24=g9+g14,g25=g9+g16,g26=g9+g17,g27=g9+g21,g28=g11+g15,g29=g11+g18,g30=g11+g19,g31=g11+g20,g32=g11+g22,g33=g11+g23;var d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+hc+","+g9+" L"+g11+","+vc+" L"+g28+","+vc+" L"+g28+","+g10+" L"+g33+","+g10+" L"+g33+","+vc+" L"+g12+","+vc+" L"+g32+","+g26+" L"+g32+","+g24+" L"+g31+","+g24+" L"+g31+","+g25+" z M"+g29+","+g27+" L"+g30+","+g27+" L"+g30+","+g10+" L"+g29+","+g10+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonInformation":var dx2,g9,g11,g13,g14,g17,g18,g19,g20,g22,g23,g24,g25,g28,g29,g30,g31,g32,g34,g35,g37,g38,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g11=hc-dx2,g13=3*ss/4,g14=g13/32,g17=5*g13/16,g18=3*g13/8,g19=13*g13/32,g20=19*g13/32,g22=11*g13/16,g23=13*g13/16,g24=7*g13/8,g25=g9+g14,g28=g9+g17,g29=g9+g18,g30=g9+g23,g31=g9+g24,g32=g11+g17,g34=g11+g19,g35=g11+g20,g37=g11+g22,g38=3*g13/32;var cY1=g9+dx2,cY2=g25+g38,d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" zM"+hc+","+g9+shapeArc(hc,cY1,dx2,dx2,270,630,!1).replace("M","L")+" zM"+hc+","+g25+shapeArc(hc,cY2,g38,g38,270,630,!1).replace("M","L")+"M"+g32+","+g28+" L"+g35+","+g28+" L"+g35+","+g30+" L"+g37+","+g30+" L"+g37+","+g31+" L"+g32+","+g31+" L"+g32+","+g30+" L"+g34+","+g30+" L"+g34+","+g29+" L"+g32+","+g29+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";
break;case"actionButtonMovie":var dx2,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,g27,g28,g29,g30,g31,g32,g33,g34,g35,g36,g37,g38,g39,g40,g41,g42,g43,g44,g45,g46,g47,g48,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2,g13=3*ss/4,g14=1455*g13/21600,g15=1905*g13/21600,g16=2325*g13/21600,g17=16155*g13/21600,g18=17010*g13/21600,g19=19335*g13/21600,g20=19725*g13/21600,g21=20595*g13/21600,g22=5280*g13/21600,g23=5730*g13/21600,g24=6630*g13/21600,g25=7492*g13/21600,g26=9067*g13/21600,g27=9555*g13/21600,g28=13342*g13/21600,g29=14580*g13/21600,g30=15592*g13/21600,g31=g11+g14,g32=g11+g15,g33=g11+g16,g34=g11+g17,g35=g11+g18,g36=g11+g19,g37=g11+g20,g38=g11+g21,g39=g9+g22,g40=g9+g23,g41=g9+g24,g42=g9+g25,g43=g9+g26,g44=g9+g27,g45=g9+g28,g46=g9+g29,g47=g9+g30,g48=g9+g31;var d="M0,"+h+" L"+w+","+h+" L"+w+",0 L0,0 zM"+g11+","+g39+" L"+g11+","+g44+" L"+g31+","+g44+" L"+g32+","+g43+" L"+g33+","+g43+" L"+g33+","+g47+" L"+g35+","+g47+" L"+g35+","+g45+" L"+g36+","+g45+" L"+g38+","+g46+" L"+g12+","+g46+" L"+g12+","+g41+" L"+g38+","+g41+" L"+g37+","+g42+" L"+g35+","+g42+" L"+g35+","+g41+" L"+g34+","+g40+" L"+g32+","+g40+" L"+g31+","+g39+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonReturn":var dx2,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,g27,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2,g13=3*ss/4,g14=7*g13/8,g15=3*g13/4,g16=5*g13/8,g17=3*g13/8,g18=g13/4,g19=g9+g15,g20=g9+g16,g21=g9+g18,g22=g11+g14,g23=g11+g15,g24=g11+g16,g25=g11+g17,g26=g11+g18,g27=g13/8;var cX1=g24-g27,cY2=g19-g27,cX3=g11+g17,cY4=g10-g17,d="M0,"+h+" L"+w+","+h+" L"+w+",0 L0,0 z M"+g12+","+g21+" L"+g23+","+g9+" L"+hc+","+g21+" L"+g24+","+g21+" L"+g24+","+g20+shapeArc(cX1,g20,g27,g27,0,90,!1).replace("M","L")+" L"+g25+","+g19+shapeArc(g25,cY2,g27,g27,90,180,!1).replace("M","L")+" L"+g26+","+g21+" L"+g11+","+g21+" L"+g11+","+g20+shapeArc(cX3,g20,g17,g17,180,90,!1).replace("M","L")+" L"+hc+","+g10+shapeArc(hc,cY4,g17,g17,90,0,!1).replace("M","L")+" L"+g22+","+g21+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"actionButtonSound":var dx2,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,hc=w/2,vc=h/2,ss=Math.min(w,h);dx2=3*ss/8,g9=vc-dx2,g10=vc+dx2,g11=hc-dx2,g12=hc+dx2,g13=3*ss/4,g14=g13/8,g15=5*g13/16,g16=5*g13/8,g17=11*g13/16,g18=3*g13/4,g19=7*g13/8,g20=g9+g14,g21=g9+g15,g22=g9+g17,g23=g9+g19,g24=g11+g15,g25=g11+g16,g26=g11+g18;var d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+g11+","+g21+" L"+g24+","+g21+" L"+g25+","+g9+" L"+g25+","+g10+" L"+g24+","+g22+" L"+g11+","+g22+" z M"+g26+","+g21+" L"+g12+","+g20+" M"+g26+","+vc+" L"+g12+","+vc+" M"+g26+","+g22+" L"+g12+","+g23;result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"irregularSeal1":case"irregularSeal2":if("irregularSeal1"==shapType)var d="M"+10800*w/21600+","+5800*h/21600+" L"+14522*w/21600+",0 L"+14155*w/21600+","+5325*h/21600+" L"+18380*w/21600+","+4457*h/21600+" L"+16702*w/21600+","+7315*h/21600+" L"+21097*w/21600+","+8137*h/21600+" L"+17607*w/21600+","+10475*h/21600+" L"+w+","+13290*h/21600+" L"+16837*w/21600+","+12942*h/21600+" L"+18145*w/21600+","+18095*h/21600+" L"+14020*w/21600+","+14457*h/21600+" L"+13247*w/21600+","+19737*h/21600+" L"+10532*w/21600+","+14935*h/21600+" L"+8485*w/21600+","+h+" L"+7715*w/21600+","+15627*h/21600+" L"+4762*w/21600+","+17617*h/21600+" L"+5667*w/21600+","+13937*h/21600+" L"+135*w/21600+","+14587*h/21600+" L"+3722*w/21600+","+11775*h/21600+" L0,"+8615*h/21600+" L"+4627*w/21600+","+7617*h/21600+" L"+370*w/21600+","+2295*h/21600+" L"+7312*w/21600+","+6320*h/21600+" L"+8352*w/21600+","+2295*h/21600+" z";else if("irregularSeal2"==shapType)var d="M"+11462*w/21600+","+4342*h/21600+" L"+14790*w/21600+",0 L"+14525*w/21600+","+5777*h/21600+" L"+18007*w/21600+","+3172*h/21600+" L"+16380*w/21600+","+6532*h/21600+" L"+w+","+6645*h/21600+" L"+16985*w/21600+","+9402*h/21600+" L"+18270*w/21600+","+11290*h/21600+" L"+16380*w/21600+","+12310*h/21600+" L"+18877*w/21600+","+15632*h/21600+" L"+14640*w/21600+","+14350*h/21600+" L"+14942*w/21600+","+17370*h/21600+" L"+12180*w/21600+","+15935*h/21600+" L"+11612*w/21600+","+18842*h/21600+" L"+9872*w/21600+","+17370*h/21600+" L"+8700*w/21600+","+19712*h/21600+" L"+7527*w/21600+","+18125*h/21600+" L"+4917*w/21600+","+h+" L"+4805*w/21600+","+18240*h/21600+" L"+1285*w/21600+","+17825*h/21600+" L"+3330*w/21600+","+15370*h/21600+" L0,"+12877*h/21600+" L"+3935*w/21600+","+11592*h/21600+" L"+1172*w/21600+","+8270*h/21600+" L"+5372*w/21600+","+7817*h/21600+" L"+4502*w/21600+","+3625*h/21600+" L"+8550*w/21600+","+6382*h/21600+" L"+9722*w/21600+","+1887*h/21600+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartTerminator":var x1,x2,y1,cd2=180,cd4=90,c3d4=270;x1=3475*w/21600,x2=18125*w/21600,y1=10800*h/21600;var d="M"+x1+",0 L"+x2+",0"+shapeArc(x2,h/2,x1,y1,c3d4,c3d4+cd2,!1).replace("M","L")+" L"+x1+","+h+shapeArc(x1,h/2,x1,y1,cd4,cd4+cd2,!1).replace("M","L")+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartPunchedTape":var x1,x1,y1,y2,cd2=180;x1=5*w/20,y1=2*h/20,y2=18*h/20;var d="M0,"+y1+shapeArc(x1,y1,x1,y1,cd2,0,!1).replace("M","L")+shapeArc(.75*w,y1,x1,y1,cd2,360,!1).replace("M","L")+" L"+w+","+y2+shapeArc(.75*w,y2,x1,y1,0,-cd2,!1).replace("M","L")+shapeArc(x1,y2,x1,y1,0,cd2,!1).replace("M","L")+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartOnlineStorage":var x1,y1,c3d4=270,cd4=90;x1=1*w/6,y1=3*h/6;var d="M"+x1+",0 L"+w+",0"+shapeArc(w,h/2,x1,y1,c3d4,90,!1).replace("M","L")+" L"+x1+","+h+shapeArc(x1,h/2,x1,y1,cd4,270,!1).replace("M","L")+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartDisplay":var x1,x2,y1,c3d4=270,cd2=180;x1=1*w/6,x2=5*w/6,y1=3*h/6;var d="M0,"+y1+" L"+x1+",0 L"+x2+",0"+shapeArc(w,h/2,x1,y1,c3d4,c3d4+cd2,!1).replace("M","L")+" L"+x1+","+h+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartDelay":var wd2=w/2,hd2=h/2,cd2=180,c3d4=270,cd4=90,d="M0,0 L"+wd2+",0"+shapeArc(wd2,hd2,wd2,hd2,c3d4,c3d4+cd2,!1).replace("M","L")+" L0,"+h+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"flowChartMagneticTape":var idy,ib,ang1,wd2=w/2,hd2=h/2,cd2=180,c3d4=270,cd4=90;idy=hd2*Math.sin(Math.PI/4),ib=hd2+idy,ang1=Math.atan(h/w);var ang1Dg=180*ang1/Math.PI,d="M"+wd2+","+h+shapeArc(wd2,hd2,wd2,hd2,cd4,cd2,!1).replace("M","L")+shapeArc(wd2,hd2,wd2,hd2,cd2,c3d4,!1).replace("M","L")+shapeArc(wd2,hd2,wd2,hd2,c3d4,360,!1).replace("M","L")+shapeArc(wd2,hd2,wd2,hd2,0,ang1Dg,!1).replace("M","L")+" L"+w+","+ib+" L"+w+","+h+" z";result+="<path d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"ellipse":case"flowChartConnector":case"flowChartSummingJunction":case"flowChartOr":if(result+="<ellipse cx='"+w/2+"' cy='"+h/2+"' rx='"+w/2+"' ry='"+h/2+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />","flowChartOr"==shapType)result+=" <polyline points='"+w/2+" 0,"+w/2+" "+h+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />",result+=" <polyline points='0 "+h/2+","+w+" "+h/2+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";else if("flowChartSummingJunction"==shapType){var iDx,idy,il,ir,it,ib,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,angVal=Math.PI/4;iDx=wd2*Math.cos(angVal),idy=hd2*Math.sin(angVal),il=hc-iDx,ir=hc+iDx,it=vc-idy,ib=vc+idy,result+=" <polyline points='"+il+" "+it+","+ir+" "+ib+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />",result+=" <polyline points='"+ir+" "+it+","+il+" "+ib+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />"}break;case"roundRect":case"round1Rect":case"round2DiagRect":case"round2SameRect":case"snip1Rect":case"snip2DiagRect":case"snip2SameRect":case"flowChartAlternateProcess":case"flowChartPunchedCard":var sAdj1,sAdj1_val,sAdj2,sAdj2_val,shpTyp,adjTyp,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst_ary&&shapAdjst_ary.constructor===Array)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=parseInt(sAdj1.substr(4))/5e4):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj2_val=parseInt(sAdj2.substr(4))/5e4)}else if(void 0!==shapAdjst_ary&&shapAdjst_ary.constructor!==Array){var sAdj=getTextByPathList(shapAdjst_ary,["attrs","fmla"]);sAdj1_val=parseInt(sAdj.substr(4))/5e4,sAdj2_val=0}var tranglRott="";switch(shapType){case"roundRect":case"flowChartAlternateProcess":shpTyp="round",adjTyp="cornrAll",void 0===sAdj1_val&&(sAdj1_val=.33334),sAdj2_val=0;break;case"round1Rect":shpTyp="round",adjTyp="cornr1",void 0===sAdj1_val&&(sAdj1_val=.33334),sAdj2_val=0;break;case"round2DiagRect":shpTyp="round",adjTyp="diag",void 0===sAdj1_val&&(sAdj1_val=.33334),void 0===sAdj2_val&&(sAdj2_val=0);break;case"round2SameRect":shpTyp="round",adjTyp="cornr2",void 0===sAdj1_val&&(sAdj1_val=.33334),void 0===sAdj2_val&&(sAdj2_val=0);break;case"snip1Rect":case"flowChartPunchedCard":shpTyp="snip",adjTyp="cornr1",void 0===sAdj1_val&&(sAdj1_val=.33334),sAdj2_val=0,"flowChartPunchedCard"==shapType&&(tranglRott="transform='translate("+w+",0) scale(-1,1)'");break;case"snip2DiagRect":shpTyp="snip",adjTyp="diag",void 0===sAdj1_val&&(sAdj1_val=0),void 0===sAdj2_val&&(sAdj2_val=.33334);break;case"snip2SameRect":shpTyp="snip",adjTyp="cornr2",void 0===sAdj1_val&&(sAdj1_val=.33334),void 0===sAdj2_val&&(sAdj2_val=0)}var d_val=shapeSnipRoundRect(w,h,sAdj1_val,sAdj2_val,shpTyp,adjTyp);result+="<path "+tranglRott+"  d='"+d_val+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"snipRoundRect":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=.33334,sAdj2_val=.33334;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=parseInt(sAdj1.substr(4))/5e4):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj2_val=parseInt(sAdj2.substr(4))/5e4)}var d_val="M0,"+h+" L"+w+","+h+" L"+w+","+h/2*sAdj2_val+" L"+(w/2+w/2*(1-sAdj2_val))+",0 L"+w/2*sAdj1_val+",0 Q0,0 0,"+h/2*sAdj1_val+" z";result+="<path   d='"+d_val+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"bentConnector2":var d="";d="M "+w+" 0 L "+w+" "+h+" L 0 "+h,result+="<path d='"+d+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' fill='none' ",void 0===headEndNodeAttrs||"triangle"!==headEndNodeAttrs.type&&"arrow"!==headEndNodeAttrs.type||(result+="marker-start='url(#markerTriangle_"+shpId+")' "),void 0===tailEndNodeAttrs||"triangle"!==tailEndNodeAttrs.type&&"arrow"!==tailEndNodeAttrs.type||(result+="marker-end='url(#markerTriangle_"+shpId+")' "),result+="/>";break;case"rtTriangle":result+=" <polygon points='0 0,0 "+h+","+w+" "+h+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"triangle":case"flowChartExtract":case"flowChartMerge":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),shapAdjst_val=.5;void 0!==shapAdjst&&(shapAdjst_val=parseInt(shapAdjst.substr(4))*slideFactor*.1);var tranglRott="";"flowChartMerge"==shapType&&(tranglRott="transform='rotate(180 "+w/2+","+h/2+")'"),result+=" <polygon "+tranglRott+" points='"+w*shapAdjst_val+" 0,0 "+h+","+w+" "+h+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"diamond":case"flowChartDecision":case"flowChartSort":result+=" <polygon points='"+w/2+" 0,0 "+h/2+","+w/2+" "+h+","+w+" "+h/2+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />","flowChartSort"==shapType&&(result+=" <polyline points='0 "+h/2+","+w+" "+h/2+"' fill='none' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />");break;case"trapezoid":case"flowChartManualOperation":case"flowChartManualInput":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adjst_val=.2,max_adj_const=.7407;if(void 0!==shapAdjst){var adjst=parseInt(shapAdjst.substr(4))*slideFactor;adjst_val=.5*adjst/max_adj_const}var cnstVal=0,tranglRott="";"flowChartManualOperation"==shapType&&(tranglRott="transform='rotate(180 "+w/2+","+h/2+")'"),"flowChartManualInput"==shapType&&(adjst_val=0,cnstVal=h/5),result+=" <polygon "+tranglRott+" points='"+w*adjst_val+" "+cnstVal+",0 "+h+","+w+" "+h+","+(1-adjst_val)*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"parallelogram":case"flowChartInputOutput":var max_adj_const,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adjst_val=.25;if(max_adj_const=w>h?w/h:h/w,void 0!==shapAdjst){var adjst=parseInt(shapAdjst.substr(4))/1e5;adjst_val=adjst/max_adj_const}result+=" <polygon points='"+adjst_val*w+" 0,0 "+h+","+(1-adjst_val)*w+" "+h+","+w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"pentagon":result+=" <polygon points='"+.5*w+" 0,0 "+.375*h+","+.15*w+" "+h+","+.85*w+" "+h+","+w+" "+.375*h+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"hexagon":case"flowChartPreparation":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=25e3*slideFactor,vf=115470*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,angVal1=60*Math.PI/180;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var maxAdj,a,shd2,x1,x2,dy1,y1,y2,vc=h/2,hd2=h/2,ss=Math.min(w,h);maxAdj=cnstVal1*w/ss,a=0>adj?0:adj>maxAdj?maxAdj:adj,shd2=hd2*vf/cnstVal2,x1=ss*a/cnstVal2,x2=w-x1,dy1=shd2*Math.sin(angVal1),y1=vc-dy1,y2=vc+dy1;var d="M0,"+vc+" L"+x1+","+y1+" L"+x2+","+y1+" L"+w+","+vc+" L"+x2+","+y2+" L"+x1+","+y2+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"heptagon":result+=" <polygon points='"+.5*w+" 0,"+w/8+" "+h/4+",0 "+5/8*h+","+w/4+" "+h+","+.75*w+" "+h+","+w+" "+5/8*h+","+7/8*w+" "+h/4+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"octagon":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj1=.25;void 0!==shapAdjst&&(adj1=parseInt(shapAdjst.substr(4))/1e5);var adj2=1-adj1;result+=" <polygon points='"+adj1*w+" 0,0 "+adj1*h+",0 "+adj2*h+","+adj1*w+" "+h+","+adj2*w+" "+h+","+w+" "+adj2*h+","+w+" "+adj1*h+","+adj2*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"decagon":result+=" <polygon points='"+3/8*w+" 0,"+w/8+" "+h/8+",0 "+h/2+","+w/8+" "+7/8*h+","+3/8*w+" "+h+","+5/8*w+" "+h+","+7/8*w+" "+7/8*h+","+w+" "+h/2+","+7/8*w+" "+h/8+","+5/8*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"dodecagon":result+=" <polygon points='"+3/8*w+" 0,"+w/8+" "+h/8+",0 "+3/8*h+",0 "+5/8*h+","+w/8+" "+7/8*h+","+3/8*w+" "+h+","+5/8*w+" "+h+","+7/8*w+" "+7/8*h+","+w+" "+5/8*h+","+w+" "+3/8*h+","+7/8*w+" "+h/8+","+5/8*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star4":var a,iwd2,ihd2,sdx,sdy,sx1,sx2,sy1,sy2,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,adj=19098*slideFactor,cnstVal1=5e4*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst){var name=shapAdjst.attrs.name;"adj"==name&&(adj=parseInt(shapAdjst.attrs.fmla.substr(4))*slideFactor)}a=0>adj?0:adj>cnstVal1?cnstVal1:adj,iwd2=wd2*a/cnstVal1,ihd2=hd2*a/cnstVal1,sdx=iwd2*Math.cos(.7853981634),sdy=ihd2*Math.sin(.7853981634),sx1=hc-sdx,sx2=hc+sdx,sy1=vc-sdy,sy2=vc+sdy,yAdj=vc-ihd2;var d="M0,"+vc+" L"+sx1+","+sy1+" L"+hc+",0 L"+sx2+","+sy1+" L"+w+","+vc+" L"+sx2+","+sy2+" L"+hc+","+h+" L"+sx1+","+sy2+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star5":var a,swd2,shd2,svc,dx1,dx2,dy1,dy2,x1,x2,x3,x4,y1,y2,iwd2,ihd2,sdx1,sdx2,sdy1,sdy2,sx1,sx2,sx3,sx4,sy1,sy2,sy3,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,adj=19098*slideFactor,hf=105146*slideFactor,vf=110557*slideFactor,maxAdj=5e4*slideFactor,cnstVal1=1e5*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);void 0!==shapAdjst&&Object.keys(shapAdjst).forEach(function(key){var name=shapAdjst[key].attrs.name;"adj"==name?adj=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor:"hf"==name?hf=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor:"vf"==name&&(vf=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor)}),a=0>adj?0:adj>maxAdj?maxAdj:adj,swd2=wd2*hf/cnstVal1,shd2=hd2*vf/cnstVal1,svc=vc*vf/cnstVal1,dx1=swd2*Math.cos(.31415926536),dx2=swd2*Math.cos(5.3407075111),dy1=shd2*Math.sin(.31415926536),dy2=shd2*Math.sin(5.3407075111),x1=hc-dx1,x2=hc-dx2,x3=hc+dx2,x4=hc+dx1,y1=svc-dy1,y2=svc-dy2,iwd2=swd2*a/maxAdj,ihd2=shd2*a/maxAdj,sdx1=iwd2*Math.cos(5.9690260418),sdx2=iwd2*Math.cos(.94247779608),sdy1=ihd2*Math.sin(.94247779608),sdy2=ihd2*Math.sin(5.9690260418),sx1=hc-sdx1,sx2=hc-sdx2,sx3=hc+sdx2,sx4=hc+sdx1,sy1=svc-sdy1,sy2=svc-sdy2,sy3=svc+ihd2,yAdj=svc-ihd2;var d="M"+x1+","+y1+" L"+sx2+","+sy1+" L"+hc+",0 L"+sx3+","+sy1+" L"+x4+","+y1+" L"+sx4+","+sy2+" L"+x3+","+y2+" L"+hc+","+sy3+" L"+x2+","+y2+" L"+sx1+","+sy2+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star6":var a,swd2,dx1,x1,x2,y2,iwd2,ihd2,sdx2,sx1,sx2,sx3,sx4,sdy1,sy1,sy2,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,hd4=h/4,adj=28868*slideFactor,hf=115470*slideFactor,maxAdj=5e4*slideFactor,cnstVal1=1e5*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);void 0!==shapAdjst&&Object.keys(shapAdjst).forEach(function(key){var name=shapAdjst[key].attrs.name;"adj"==name?adj=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor:"hf"==name&&(hf=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor)}),a=0>adj?0:adj>maxAdj?maxAdj:adj,swd2=wd2*hf/cnstVal1,dx1=swd2*Math.cos(.5235987756),x1=hc-dx1,x2=hc+dx1,y2=vc+hd4,iwd2=swd2*a/maxAdj,ihd2=hd2*a/maxAdj,sdx2=iwd2/2,sx1=hc-iwd2,sx2=hc-sdx2,sx3=hc+sdx2,sx4=hc+iwd2,sdy1=ihd2*Math.sin(1.0471975512),sy1=vc-sdy1,sy2=vc+sdy1,yAdj=vc-ihd2;var d="M"+x1+","+hd4+" L"+sx2+","+sy1+" L"+hc+",0 L"+sx3+","+sy1+" L"+x2+","+hd4+" L"+sx4+","+vc+" L"+x2+","+y2+" L"+sx3+","+sy2+" L"+hc+","+h+" L"+sx2+","+sy2+" L"+x1+","+y2+" L"+sx1+","+vc+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star7":var a,swd2,shd2,svc,dx1,dx2,dx3,dy1,dy2,dy3,x1,x2,x3,x4,x5,x6,y1,y2,y3,iwd2,ihd2,sdx1,sdx2,sdx3,sx1,sx2,sx3,sx4,sx5,sx6,sdy1,sdy2,sdy3,sy1,sy2,sy3,sy4,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,adj=34601*slideFactor,hf=102572*slideFactor,vf=105210*slideFactor,maxAdj=5e4*slideFactor,cnstVal1=1e5*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);void 0!==shapAdjst&&Object.keys(shapAdjst).forEach(function(key){var name=shapAdjst[key].attrs.name;"adj"==name?adj=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor:"hf"==name?hf=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor:"vf"==name&&(vf=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor)}),a=0>adj?0:adj>maxAdj?maxAdj:adj,swd2=wd2*hf/cnstVal1,shd2=hd2*vf/cnstVal1,svc=vc*vf/cnstVal1,dx1=97493*swd2/1e5,dx2=78183*swd2/1e5,dx3=43388*swd2/1e5,dy1=62349*shd2/1e5,dy2=22252*shd2/1e5,dy3=90097*shd2/1e5,x1=hc-dx1,x2=hc-dx2,x3=hc-dx3,x4=hc+dx3,x5=hc+dx2,x6=hc+dx1,y1=svc-dy1,y2=svc+dy2,y3=svc+dy3,iwd2=swd2*a/maxAdj,ihd2=shd2*a/maxAdj,sdx1=97493*iwd2/1e5,sdx2=78183*iwd2/1e5,sdx3=43388*iwd2/1e5,sx1=hc-sdx1,sx2=hc-sdx2,sx3=hc-sdx3,sx4=hc+sdx3,sx5=hc+sdx2,sx6=hc+sdx1,sdy1=90097*ihd2/1e5,sdy2=22252*ihd2/1e5,sdy3=62349*ihd2/1e5,sy1=svc-sdy1,sy2=svc-sdy2,sy3=svc+sdy3,sy4=svc+ihd2,yAdj=svc-ihd2;var d="M"+x1+","+y2+" L"+sx1+","+sy2+" L"+x2+","+y1+" L"+sx3+","+sy1+" L"+hc+",0 L"+sx4+","+sy1+" L"+x5+","+y1+" L"+sx6+","+sy2+" L"+x6+","+y2+" L"+sx5+","+sy3+" L"+x4+","+y3+" L"+hc+","+sy4+" L"+x3+","+y3+" L"+sx2+","+sy3+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star8":var a,dx1,x1,x2,dy1,y1,y2,iwd2,ihd2,sdx1,sdx2,sdy1,sdy2,sx1,sx2,sx3,sx4,sy1,sy2,sy3,sy4,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,adj=37500*slideFactor,maxAdj=5e4*slideFactor,cnstVal1=1e5*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst){var name=shapAdjst.attrs.name;"adj"==name&&(adj=parseInt(shapAdjst.attrs.fmla.substr(4))*slideFactor)}a=0>adj?0:adj>maxAdj?maxAdj:adj,dx1=wd2*Math.cos(.7853981634),x1=hc-dx1,x2=hc+dx1,dy1=hd2*Math.sin(.7853981634),y1=vc-dy1,y2=vc+dy1,iwd2=wd2*a/maxAdj,ihd2=hd2*a/maxAdj,sdx1=92388*iwd2/1e5,sdx2=38268*iwd2/1e5,sdy1=92388*ihd2/1e5,sdy2=38268*ihd2/1e5,sx1=hc-sdx1,sx2=hc-sdx2,sx3=hc+sdx2,sx4=hc+sdx1,sy1=vc-sdy1,sy2=vc-sdy2,sy3=vc+sdy2,sy4=vc+sdy1,yAdj=vc-ihd2;var d="M0,"+vc+" L"+sx1+","+sy2+" L"+x1+","+y1+" L"+sx2+","+sy1+" L"+hc+",0 L"+sx3+","+sy1+" L"+x2+","+y1+" L"+sx4+","+sy2+" L"+w+","+vc+" L"+sx4+","+sy3+" L"+x2+","+y2+" L"+sx3+","+sy4+" L"+hc+","+h+" L"+sx2+","+sy4+" L"+x1+","+y2+" L"+sx1+","+sy3+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star10":var a,swd2,dx1,dx2,x1,x2,x3,x4,dy1,dy2,y1,y2,y3,y4,iwd2,ihd2,sdx1,sdx2,sdy1,sdy2,sx1,sx2,sx3,sx4,sx5,sx6,sy1,sy2,sy3,sy4,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,adj=42533*slideFactor,hf=105146*slideFactor,maxAdj=5e4*slideFactor,cnstVal1=1e5*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);void 0!==shapAdjst&&Object.keys(shapAdjst).forEach(function(key){var name=shapAdjst[key].attrs.name;"adj"==name?adj=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor:"hf"==name&&(hf=parseInt(shapAdjst[key].attrs.fmla.substr(4))*slideFactor)}),a=0>adj?0:adj>maxAdj?maxAdj:adj,swd2=wd2*hf/cnstVal1,dx1=95106*swd2/1e5,dx2=58779*swd2/1e5,x1=hc-dx1,x2=hc-dx2,x3=hc+dx2,x4=hc+dx1,dy1=80902*hd2/1e5,dy2=30902*hd2/1e5,y1=vc-dy1,y2=vc-dy2,y3=vc+dy2,y4=vc+dy1,iwd2=swd2*a/maxAdj,ihd2=hd2*a/maxAdj,sdx1=80902*iwd2/1e5,sdx2=30902*iwd2/1e5,sdy1=95106*ihd2/1e5,sdy2=58779*ihd2/1e5,sx1=hc-iwd2,sx2=hc-sdx1,sx3=hc-sdx2,sx4=hc+sdx2,sx5=hc+sdx1,sx6=hc+iwd2,sy1=vc-sdy1,sy2=vc-sdy2,sy3=vc+sdy2,sy4=vc+sdy1,yAdj=vc-ihd2;var d="M"+x1+","+y2+" L"+sx2+","+sy2+" L"+x2+","+y1+" L"+sx3+","+sy1+" L"+hc+",0 L"+sx4+","+sy1+" L"+x3+","+y1+" L"+sx5+","+sy2+" L"+x4+","+y2+" L"+sx6+","+vc+" L"+x4+","+y3+" L"+sx5+","+sy3+" L"+x3+","+y4+" L"+sx4+","+sy4+" L"+hc+","+h+" L"+sx3+","+sy4+" L"+x2+","+y4+" L"+sx2+","+sy3+" L"+x1+","+y3+" L"+sx1+","+vc+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star12":var a,dx1,dy1,x1,x3,x4,y1,y3,y4,iwd2,ihd2,sdx1,sdx2,sdx3,sdy1,sdy2,sdy3,sx1,sx2,sx3,sx4,sx5,sx6,sy1,sy2,sy3,sy4,sy5,sy6,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,hd4=h/4,wd4=w/4,adj=37500*slideFactor,maxAdj=5e4*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst){var name=shapAdjst.attrs.name;"adj"==name&&(adj=parseInt(shapAdjst.attrs.fmla.substr(4))*slideFactor)}a=0>adj?0:adj>maxAdj?maxAdj:adj,dx1=wd2*Math.cos(.5235987756),dy1=hd2*Math.sin(1.0471975512),x1=hc-dx1,x3=3*w/4,x4=hc+dx1,y1=vc-dy1,y3=3*h/4,y4=vc+dy1,iwd2=wd2*a/maxAdj,ihd2=hd2*a/maxAdj,sdx1=iwd2*Math.cos(.2617993878),sdx2=iwd2*Math.cos(.7853981634),sdx3=iwd2*Math.cos(1.308996939),sdy1=ihd2*Math.sin(1.308996939),sdy2=ihd2*Math.sin(.7853981634),sdy3=ihd2*Math.sin(.2617993878),sx1=hc-sdx1,sx2=hc-sdx2,sx3=hc-sdx3,sx4=hc+sdx3,sx5=hc+sdx2,sx6=hc+sdx1,sy1=vc-sdy1,sy2=vc-sdy2,sy3=vc-sdy3,sy4=vc+sdy3,sy5=vc+sdy2,sy6=vc+sdy1,yAdj=vc-ihd2;var d="M0,"+vc+" L"+sx1+","+sy3+" L"+x1+","+hd4+" L"+sx2+","+sy2+" L"+wd4+","+y1+" L"+sx3+","+sy1+" L"+hc+",0 L"+sx4+","+sy1+" L"+x3+","+y1+" L"+sx5+","+sy2+" L"+x4+","+hd4+" L"+sx6+","+sy3+" L"+w+","+vc+" L"+sx6+","+sy4+" L"+x4+","+y3+" L"+sx5+","+sy5+" L"+x3+","+y4+" L"+sx4+","+sy6+" L"+hc+","+h+" L"+sx3+","+sy6+" L"+wd4+","+y4+" L"+sx2+","+sy5+" L"+x1+","+y3+" L"+sx1+","+sy4+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star16":var a,dx1,dx2,dx3,dy1,dy2,dy3,x1,x2,x3,x4,x5,x6,y1,y2,y3,y4,y5,y6,iwd2,ihd2,sdx1,sdx2,sdx3,sdx4,sdy1,sdy2,sdy3,sdy4,sx1,sx2,sx3,sx4,sx5,sx6,sx7,sx8,sy1,sy2,sy3,sy4,sy5,sy6,sy7,sy8,iDx,idy,il,it,ir,ib,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,adj=37500*slideFactor,maxAdj=5e4*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst){var name=shapAdjst.attrs.name;"adj"==name&&(adj=parseInt(shapAdjst.attrs.fmla.substr(4))*slideFactor)}a=0>adj?0:adj>maxAdj?maxAdj:adj,dx1=92388*wd2/1e5,dx2=70711*wd2/1e5,dx3=38268*wd2/1e5,dy1=92388*hd2/1e5,dy2=70711*hd2/1e5,dy3=38268*hd2/1e5,x1=hc-dx1,x2=hc-dx2,x3=hc-dx3,x4=hc+dx3,x5=hc+dx2,x6=hc+dx1,y1=vc-dy1,y2=vc-dy2,y3=vc-dy3,y4=vc+dy3,y5=vc+dy2,y6=vc+dy1,iwd2=wd2*a/maxAdj,ihd2=hd2*a/maxAdj,sdx1=98079*iwd2/1e5,sdx2=83147*iwd2/1e5,sdx3=55557*iwd2/1e5,sdx4=19509*iwd2/1e5,sdy1=98079*ihd2/1e5,sdy2=83147*ihd2/1e5,sdy3=55557*ihd2/1e5,sdy4=19509*ihd2/1e5,sx1=hc-sdx1,sx2=hc-sdx2,sx3=hc-sdx3,sx4=hc-sdx4,sx5=hc+sdx4,sx6=hc+sdx3,sx7=hc+sdx2,sx8=hc+sdx1,sy1=vc-sdy1,sy2=vc-sdy2,sy3=vc-sdy3,sy4=vc-sdy4,sy5=vc+sdy4,sy6=vc+sdy3,sy7=vc+sdy2,sy8=vc+sdy1,iDx=iwd2*Math.cos(.7853981634),idy=ihd2*Math.sin(.7853981634),il=hc-iDx,it=vc-idy,ir=hc+iDx,ib=vc+idy,yAdj=vc-ihd2;var d="M0,"+vc+" L"+sx1+","+sy4+" L"+x1+","+y3+" L"+sx2+","+sy3+" L"+x2+","+y2+" L"+sx3+","+sy2+" L"+x3+","+y1+" L"+sx4+","+sy1+" L"+hc+",0 L"+sx5+","+sy1+" L"+x4+","+y1+" L"+sx6+","+sy2+" L"+x5+","+y2+" L"+sx7+","+sy3+" L"+x6+","+y3+" L"+sx8+","+sy4+" L"+w+","+vc+" L"+sx8+","+sy5+" L"+x6+","+y4+" L"+sx7+","+sy6+" L"+x5+","+y5+" L"+sx6+","+sy7+" L"+x4+","+y6+" L"+sx5+","+sy8+" L"+hc+","+h+" L"+sx4+","+sy8+" L"+x3+","+y6+" L"+sx3+","+sy7+" L"+x2+","+y5+" L"+sx2+","+sy6+" L"+x1+","+y4+" L"+sx1+","+sy5+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star24":var a,dx1,dx2,dx3,dx4,dx5,dy1,dy2,dy3,dy4,dy5,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,iwd2,ihd2,sdx1,sdx2,sdx3,sdx4,sdx5,sdx6,sdy1,sdy2,sdy3,sdy4,sdy5,sdy6,sx1,sx2,sx3,sx4,sx5,sx6,sx7,sx8,sx9,sx10,sx11,sx12,sy1,sy2,sy3,sy4,sy5,sy6,sy7,sy8,sy9,sy10,sy11,sy12,iDx,idy,il,it,ir,ib,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,hd4=h/4,wd4=w/4,adj=37500*slideFactor,maxAdj=5e4*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst){var name=shapAdjst.attrs.name;"adj"==name&&(adj=parseInt(shapAdjst.attrs.fmla.substr(4))*slideFactor)}a=0>adj?0:adj>maxAdj?maxAdj:adj,dx1=wd2*Math.cos(.2617993878),dx2=wd2*Math.cos(.5235987756),
dx3=wd2*Math.cos(.7853981634),dx4=wd4,dx5=wd2*Math.cos(1.308996939),dy1=hd2*Math.sin(1.308996939),dy2=hd2*Math.sin(1.0471975512),dy3=hd2*Math.sin(.7853981634),dy4=hd4,dy5=hd2*Math.sin(.2617993878),x1=hc-dx1,x2=hc-dx2,x3=hc-dx3,x4=hc-dx4,x5=hc-dx5,x6=hc+dx5,x7=hc+dx4,x8=hc+dx3,x9=hc+dx2,x10=hc+dx1,y1=vc-dy1,y2=vc-dy2,y3=vc-dy3,y4=vc-dy4,y5=vc-dy5,y6=vc+dy5,y7=vc+dy4,y8=vc+dy3,y9=vc+dy2,y10=vc+dy1,iwd2=wd2*a/maxAdj,ihd2=hd2*a/maxAdj,sdx1=99144*iwd2/1e5,sdx2=92388*iwd2/1e5,sdx3=79335*iwd2/1e5,sdx4=60876*iwd2/1e5,sdx5=38268*iwd2/1e5,sdx6=13053*iwd2/1e5,sdy1=99144*ihd2/1e5,sdy2=92388*ihd2/1e5,sdy3=79335*ihd2/1e5,sdy4=60876*ihd2/1e5,sdy5=38268*ihd2/1e5,sdy6=13053*ihd2/1e5,sx1=hc-sdx1,sx2=hc-sdx2,sx3=hc-sdx3,sx4=hc-sdx4,sx5=hc-sdx5,sx6=hc-sdx6,sx7=hc+sdx6,sx8=hc+sdx5,sx9=hc+sdx4,sx10=hc+sdx3,sx11=hc+sdx2,sx12=hc+sdx1,sy1=vc-sdy1,sy2=vc-sdy2,sy3=vc-sdy3,sy4=vc-sdy4,sy5=vc-sdy5,sy6=vc-sdy6,sy7=vc+sdy6,sy8=vc+sdy5,sy9=vc+sdy4,sy10=vc+sdy3,sy11=vc+sdy2,sy12=vc+sdy1,iDx=iwd2*Math.cos(.7853981634),idy=ihd2*Math.sin(.7853981634),il=hc-iDx,it=vc-idy,ir=hc+iDx,ib=vc+idy,yAdj=vc-ihd2;var d="M0,"+vc+" L"+sx1+","+sy6+" L"+x1+","+y5+" L"+sx2+","+sy5+" L"+x2+","+y4+" L"+sx3+","+sy4+" L"+x3+","+y3+" L"+sx4+","+sy3+" L"+x4+","+y2+" L"+sx5+","+sy2+" L"+x5+","+y1+" L"+sx6+","+sy1+" L"+hc+",0 L"+sx7+","+sy1+" L"+x6+","+y1+" L"+sx8+","+sy2+" L"+x7+","+y2+" L"+sx9+","+sy3+" L"+x8+","+y3+" L"+sx10+","+sy4+" L"+x9+","+y4+" L"+sx11+","+sy5+" L"+x10+","+y5+" L"+sx12+","+sy6+" L"+w+","+vc+" L"+sx12+","+sy7+" L"+x10+","+y6+" L"+sx11+","+sy8+" L"+x9+","+y7+" L"+sx10+","+sy9+" L"+x8+","+y8+" L"+sx9+","+sy10+" L"+x7+","+y9+" L"+sx8+","+sy11+" L"+x6+","+y10+" L"+sx7+","+sy12+" L"+hc+","+h+" L"+sx6+","+sy12+" L"+x5+","+y10+" L"+sx5+","+sy11+" L"+x4+","+y9+" L"+sx4+","+sy10+" L"+x3+","+y8+" L"+sx3+","+sy9+" L"+x2+","+y7+" L"+sx2+","+sy8+" L"+x1+","+y6+" L"+sx1+","+sy7+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"star32":var a,dx1,dx2,dx3,dx4,dx5,dx6,dx7,dy1,dy2,dy3,dy4,dy5,dy6,dy7,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,y11,y12,y13,y14,iwd2,ihd2,sdx1,sdx2,sdx3,sdx4,sdx5,sdx6,sdx7,sdx8,sdy1,sdy2,sdy3,sdy4,sdy5,sdy6,sdy7,sdy8,sx1,sx2,sx3,sx4,sx5,sx6,sx7,sx8,sx9,sx10,sx11,sx12,sx13,sx14,sx15,sx16,sy1,sy2,sy3,sy4,sy5,sy6,sy7,sy8,sy9,sy10,sy11,sy12,sy13,sy14,sy15,sy16,iDx,idy,il,it,ir,ib,yAdj,hc=w/2,vc=h/2,wd2=w/2,hd2=h/2,hd4=h/4,wd4=w/4,adj=37500*slideFactor,maxAdj=5e4*slideFactor,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst){var name=shapAdjst.attrs.name;"adj"==name&&(adj=parseInt(shapAdjst.attrs.fmla.substr(4))*slideFactor)}a=0>adj?0:adj>maxAdj?maxAdj:adj,dx1=98079*wd2/1e5,dx2=92388*wd2/1e5,dx3=83147*wd2/1e5,dx4=wd2*Math.cos(.7853981634),dx5=55557*wd2/1e5,dx6=38268*wd2/1e5,dx7=19509*wd2/1e5,dy1=98079*hd2/1e5,dy2=92388*hd2/1e5,dy3=83147*hd2/1e5,dy4=hd2*Math.sin(.7853981634),dy5=55557*hd2/1e5,dy6=38268*hd2/1e5,dy7=19509*hd2/1e5,x1=hc-dx1,x2=hc-dx2,x3=hc-dx3,x4=hc-dx4,x5=hc-dx5,x6=hc-dx6,x7=hc-dx7,x8=hc+dx7,x9=hc+dx6,x10=hc+dx5,x11=hc+dx4,x12=hc+dx3,x13=hc+dx2,x14=hc+dx1,y1=vc-dy1,y2=vc-dy2,y3=vc-dy3,y4=vc-dy4,y5=vc-dy5,y6=vc-dy6,y7=vc-dy7,y8=vc+dy7,y9=vc+dy6,y10=vc+dy5,y11=vc+dy4,y12=vc+dy3,y13=vc+dy2,y14=vc+dy1,iwd2=wd2*a/maxAdj,ihd2=hd2*a/maxAdj,sdx1=99518*iwd2/1e5,sdx2=95694*iwd2/1e5,sdx3=88192*iwd2/1e5,sdx4=77301*iwd2/1e5,sdx5=63439*iwd2/1e5,sdx6=47140*iwd2/1e5,sdx7=29028*iwd2/1e5,sdx8=9802*iwd2/1e5,sdy1=99518*ihd2/1e5,sdy2=95694*ihd2/1e5,sdy3=88192*ihd2/1e5,sdy4=77301*ihd2/1e5,sdy5=63439*ihd2/1e5,sdy6=47140*ihd2/1e5,sdy7=29028*ihd2/1e5,sdy8=9802*ihd2/1e5,sx1=hc-sdx1,sx2=hc-sdx2,sx3=hc-sdx3,sx4=hc-sdx4,sx5=hc-sdx5,sx6=hc-sdx6,sx7=hc-sdx7,sx8=hc-sdx8,sx9=hc+sdx8,sx10=hc+sdx7,sx11=hc+sdx6,sx12=hc+sdx5,sx13=hc+sdx4,sx14=hc+sdx3,sx15=hc+sdx2,sx16=hc+sdx1,sy1=vc-sdy1,sy2=vc-sdy2,sy3=vc-sdy3,sy4=vc-sdy4,sy5=vc-sdy5,sy6=vc-sdy6,sy7=vc-sdy7,sy8=vc-sdy8,sy9=vc+sdy8,sy10=vc+sdy7,sy11=vc+sdy6,sy12=vc+sdy5,sy13=vc+sdy4,sy14=vc+sdy3,sy15=vc+sdy2,sy16=vc+sdy1,iDx=iwd2*Math.cos(.7853981634),idy=ihd2*Math.sin(.7853981634),il=hc-iDx,it=vc-idy,ir=hc+iDx,ib=vc+idy,yAdj=vc-ihd2;var d="M0,"+vc+" L"+sx1+","+sy8+" L"+x1+","+y7+" L"+sx2+","+sy7+" L"+x2+","+y6+" L"+sx3+","+sy6+" L"+x3+","+y5+" L"+sx4+","+sy5+" L"+x4+","+y4+" L"+sx5+","+sy4+" L"+x5+","+y3+" L"+sx6+","+sy3+" L"+x6+","+y2+" L"+sx7+","+sy2+" L"+x7+","+y1+" L"+sx8+","+sy1+" L"+hc+",0 L"+sx9+","+sy1+" L"+x8+","+y1+" L"+sx10+","+sy2+" L"+x9+","+y2+" L"+sx11+","+sy3+" L"+x10+","+y3+" L"+sx12+","+sy4+" L"+x11+","+y4+" L"+sx13+","+sy5+" L"+x12+","+y5+" L"+sx14+","+sy6+" L"+x13+","+y6+" L"+sx15+","+sy7+" L"+x14+","+y7+" L"+sx16+","+sy8+" L"+w+","+vc+" L"+sx16+","+sy9+" L"+x14+","+y8+" L"+sx15+","+sy10+" L"+x13+","+y9+" L"+sx14+","+sy11+" L"+x12+","+y10+" L"+sx13+","+sy12+" L"+x11+","+y11+" L"+sx12+","+sy13+" L"+x10+","+y12+" L"+sx11+","+sy14+" L"+x9+","+y13+" L"+sx10+","+sy15+" L"+x8+","+y14+" L"+sx9+","+sy16+" L"+hc+","+h+" L"+sx8+","+sy16+" L"+x7+","+y14+" L"+sx7+","+sy15+" L"+x6+","+y13+" L"+sx6+","+sy14+" L"+x5+","+y12+" L"+sx5+","+sy13+" L"+x4+","+y11+" L"+sx4+","+sy12+" L"+x3+","+y10+" L"+sx3+","+sy11+" L"+x2+","+y9+" L"+sx2+","+sy10+" L"+x1+","+y8+" L"+sx1+","+sy9+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"pie":case"pieWedge":case"arc":var adj1,adj2,H,shapAdjst1,shapAdjst2,isClose,shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);"pie"==shapType?(adj1=0,adj2=270,H=h,isClose=!0):"pieWedge"==shapType?(adj1=180,adj2=270,H=2*h,isClose=!0):"arc"==shapType&&(adj1=270,adj2=0,H=h,isClose=!1),void 0!==shapAdjst&&(shapAdjst1=getTextByPathList(shapAdjst,["attrs","fmla"]),shapAdjst2=shapAdjst1,void 0===shapAdjst1&&(shapAdjst1=shapAdjst[0].attrs.fmla,shapAdjst2=shapAdjst[1].attrs.fmla),void 0!==shapAdjst1&&(adj1=parseInt(shapAdjst1.substr(4))/6e4),void 0!==shapAdjst2&&(adj2=parseInt(shapAdjst2.substr(4))/6e4));var pieVals=shapePie(H,w,adj1,adj2,isClose);result+="<path   d='"+pieVals[0]+"' transform='"+pieVals[1]+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"chord":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=45,sAdj2_val=270;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=parseInt(sAdj1.substr(4))/6e4):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj2_val=parseInt(sAdj2.substr(4))/6e4)}var hR=h/2,wR=w/2,d_val=shapeArc(wR,hR,wR,hR,sAdj1_val,sAdj2_val,!0);result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"frame":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj1=12500*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;void 0!==shapAdjst&&(adj1=parseInt(shapAdjst.substr(4))*slideFactor);var a1,x1,x4,y4;a1=0>adj1?0:adj1>cnstVal1?cnstVal1:adj1,x1=Math.min(w,h)*a1/cnstVal2,x4=w-x1,y4=h-x1;var d="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" zM"+x1+","+x1+" L"+x1+","+y4+" L"+x4+","+y4+" L"+x4+","+x1+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"donut":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,dr,iwd2,ihd2;a=0>adj?0:adj>cnstVal1?cnstVal1:adj,dr=Math.min(w,h)*a/cnstVal2,iwd2=w/2-dr,ihd2=h/2-dr;var d="M0,"+h/2+shapeArc(w/2,h/2,w/2,h/2,180,270,!1).replace("M","L")+shapeArc(w/2,h/2,w/2,h/2,270,360,!1).replace("M","L")+shapeArc(w/2,h/2,w/2,h/2,0,90,!1).replace("M","L")+shapeArc(w/2,h/2,w/2,h/2,90,180,!1).replace("M","L")+" zM"+dr+","+h/2+shapeArc(w/2,h/2,iwd2,ihd2,180,90,!1).replace("M","L")+shapeArc(w/2,h/2,iwd2,ihd2,90,0,!1).replace("M","L")+shapeArc(w/2,h/2,iwd2,ihd2,0,-90,!1).replace("M","L")+shapeArc(w/2,h/2,iwd2,ihd2,270,180,!1).replace("M","L")+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"noSmoking":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=18750*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,dr,iwd2,ihd2,ang,ct,st,m,n,drd2,dang,dang2,swAng,t3,stAng1,stAng2;a=0>adj?0:adj>cnstVal1?cnstVal1:adj,dr=Math.min(w,h)*a/cnstVal2,iwd2=w/2-dr,ihd2=h/2-dr,ang=Math.atan(h/w),ct=ihd2*Math.cos(ang),st=iwd2*Math.sin(ang),m=Math.sqrt(ct*ct+st*st),n=iwd2*ihd2/m,drd2=dr/2,dang=Math.atan(drd2/n),dang2=2*dang,swAng=-Math.PI+dang2,stAng1=ang-dang,stAng2=stAng1-Math.PI;var ct1,st1,m1,n1,dx1,dy1,x1,y1,y1,y2;ct1=ihd2*Math.cos(stAng1),st1=iwd2*Math.sin(stAng1),m1=Math.sqrt(ct1*ct1+st1*st1),n1=iwd2*ihd2/m1,dx1=n1*Math.cos(stAng1),dy1=n1*Math.sin(stAng1),x1=w/2+dx1,y1=h/2+dy1,x2=w/2-dx1,y2=h/2-dy1;var stAng1deg=180*stAng1/Math.PI,stAng2deg=180*stAng2/Math.PI,swAng2deg=180*swAng/Math.PI,d="M0,"+h/2+shapeArc(w/2,h/2,w/2,h/2,180,270,!1).replace("M","L")+shapeArc(w/2,h/2,w/2,h/2,270,360,!1).replace("M","L")+shapeArc(w/2,h/2,w/2,h/2,0,90,!1).replace("M","L")+shapeArc(w/2,h/2,w/2,h/2,90,180,!1).replace("M","L")+" zM"+x1+","+y1+shapeArc(w/2,h/2,iwd2,ihd2,stAng1deg,stAng1deg+swAng2deg,!1).replace("M","L")+" zM"+x2+","+y2+shapeArc(w/2,h/2,iwd2,ihd2,stAng2deg,stAng2deg+swAng2deg,!1).replace("M","L")+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"halfFrame":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=3.5,sAdj2_val=3.5,cnsVal=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj2_val=parseInt(sAdj2.substr(4))*slideFactor)}var a1,a2,minWH=Math.min(w,h),maxAdj2=cnsVal*w/minWH;a2=0>sAdj2_val?0:sAdj2_val>maxAdj2?maxAdj2:sAdj2_val;var x1=minWH*a2/cnsVal,g1=h*x1/w,g2=h-g1,maxAdj1=cnsVal*g2/minWH;a1=0>sAdj1_val?0:sAdj1_val>maxAdj1?maxAdj1:sAdj1_val;var y1=minWH*a1/cnsVal,dx2=y1*w/h,x2=w-dx2,dy2=x1*h/w,y2=h-dy2,d="M0,0 L"+w+",0 L"+x2+","+y1+" L"+x1+","+y1+" L"+x1+","+y2+" L0,"+h+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"blockArc":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=180,adj2=0,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))/6e4):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))/6e4):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var stAng,istAng,a3,sw11,sw12,swAng,iswAng,cd1=360;stAng=0>adj1?0:adj1>cd1?cd1:adj1,istAng=0>adj2?0:adj2>cd1?cd1:adj2,a3=0>adj3?0:adj3>cnstVal1?cnstVal1:adj3,sw11=istAng-stAng,sw12=sw11+cd1,swAng=sw11>0?sw11:sw12,iswAng=-swAng;var wt1,ht1,dx1,dy1,x1,y1,stRd,istRd,wd2,hd2,hc,vc,endAng=stAng+swAng,iendAng=istAng+iswAng;stRd=stAng*Math.PI/180,istRd=istAng*Math.PI/180,wd2=w/2,hd2=h/2,hc=w/2,vc=h/2,stAng>90&&270>stAng?(wt1=wd2*Math.sin(Math.PI/2-stRd),ht1=hd2*Math.cos(Math.PI/2-stRd),dx1=wd2*Math.cos(Math.atan(ht1/wt1)),dy1=hd2*Math.sin(Math.atan(ht1/wt1)),x1=hc-dx1,y1=vc-dy1):(wt1=wd2*Math.sin(stRd),ht1=hd2*Math.cos(stRd),dx1=wd2*Math.cos(Math.atan(wt1/ht1)),dy1=hd2*Math.sin(Math.atan(wt1/ht1)),x1=hc+dx1,y1=vc+dy1);var dr,iwd2,ihd2,wt2,ht2,dx2,dy2,x2,y2;dr=Math.min(w,h)*a3/cnstVal2,iwd2=wd2-dr,ihd2=hd2-dr,450>=endAng&&endAng>270||endAng>=630&&720>endAng?(wt2=iwd2*Math.sin(istRd),ht2=ihd2*Math.cos(istRd),dx2=iwd2*Math.cos(Math.atan(wt2/ht2)),dy2=ihd2*Math.sin(Math.atan(wt2/ht2)),x2=hc+dx2,y2=vc+dy2):(wt2=iwd2*Math.sin(Math.PI/2-istRd),ht2=ihd2*Math.cos(Math.PI/2-istRd),dx2=iwd2*Math.cos(Math.atan(ht2/wt2)),dy2=ihd2*Math.sin(Math.atan(ht2/wt2)),x2=hc-dx2,y2=vc-dy2);var d="M"+x1+","+y1+shapeArc(wd2,hd2,wd2,hd2,stAng,endAng,!1).replace("M","L")+" L"+x2+","+y2+shapeArc(wd2,hd2,iwd2,ihd2,istAng,iendAng,!1).replace("M","L")+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"bracePair":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=8333*slideFactor,cnstVal1=25e3*slideFactor,cnstVal2=5e4*slideFactor,cnstVal3=1e5*slideFactor;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,x1,x2,x3,x4,y2,y3,y4,vc=h/2,cd=360,cd2=180,cd4=90,c3d4=270;a=0>adj?0:adj>cnstVal1?cnstVal1:adj;var minWH=Math.min(w,h);x1=minWH*a/cnstVal3,x2=minWH*a/cnstVal2,x3=w-x2,x4=w-x1,y2=vc-x1,y3=vc+x1,y4=h-x1;var d="M"+x2+","+h+shapeArc(x2,y4,x1,x1,cd4,cd2,!1).replace("M","L")+" L"+x1+","+y3+shapeArc(0,y3,x1,x1,0,-cd4,!1).replace("M","L")+shapeArc(0,y2,x1,x1,cd4,0,!1).replace("M","L")+" L"+x1+","+x1+shapeArc(x2,x1,x1,x1,cd2,c3d4,!1).replace("M","L")+" M"+x3+",0"+shapeArc(x3,x1,x1,x1,c3d4,cd,!1).replace("M","L")+" L"+x4+","+y2+shapeArc(w,y2,x1,x1,cd2,cd4,!1).replace("M","L")+shapeArc(w,y3,x1,x1,c3d4,cd2,!1).replace("M","L")+" L"+x4+","+y4+shapeArc(x3,y4,x1,x1,0,cd4,!1).replace("M","L");result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftBrace":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=8333*slideFactor,adj2=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor)}var a1,a2,q1,q2,q3,y1,y2,y3,y4,vc=h/2,cd2=180,cd4=90,c3d4=270;a2=0>adj2?0:adj2>cnstVal2?cnstVal2:adj2;var minWH=Math.min(w,h);q1=cnstVal2-a2,q2=a2>q1?q1:a2,q3=q2/2;var maxAdj1=q3*h/minWH;a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,y1=minWH*a1/cnstVal2,y3=h*a2/cnstVal2,y2=y3-y1,y4=y3+y1;var d="M"+w+","+h+shapeArc(w,h-y1,w/2,y1,cd4,cd2,!1).replace("M","L")+" L"+w/2+","+y4+shapeArc(0,y4,w/2,y1,0,-cd4,!1).replace("M","L")+shapeArc(0,y2,w/2,y1,cd4,0,!1).replace("M","L")+" L"+w/2+","+y1+shapeArc(w,y1,w/2,y1,cd2,c3d4,!1).replace("M","L");result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"rightBrace":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=8333*slideFactor,adj2=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor)}var a1,a2,q1,q2,q3,y1,y2,y3,y4,vc=h/2,cd=360,cd2=180,cd4=90,c3d4=270;a2=0>adj2?0:adj2>cnstVal2?cnstVal2:adj2;var minWH=Math.min(w,h);q1=cnstVal2-a2,q2=a2>q1?q1:a2,q3=q2/2;var maxAdj1=q3*h/minWH;a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,y1=minWH*a1/cnstVal2,y3=h*a2/cnstVal2,y2=y3-y1,y4=h-y1;var d="M0,0"+shapeArc(0,y1,w/2,y1,c3d4,cd,!1).replace("M","L")+" L"+w/2+","+y2+shapeArc(w,y2,w/2,y1,cd2,cd4,!1).replace("M","L")+shapeArc(w,y3+y1,w/2,y1,c3d4,cd2,!1).replace("M","L")+" L"+w/2+","+y4+shapeArc(0,y4,w/2,y1,0,cd4,!1).replace("M","L");result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"bracketPair":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=16667*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,x1,x2,y2,r=w,b=h,cd2=180,cd4=90,c3d4=270;a=0>adj?0:adj>cnstVal1?cnstVal1:adj,x1=Math.min(w,h)*a/cnstVal2,x2=r-x1,y2=b-x1;var d=shapeArc(x1,x1,x1,x1,c3d4,cd2,!1)+shapeArc(x1,y2,x1,x1,cd2,cd4,!1).replace("M","L")+shapeArc(x2,x1,x1,x1,c3d4,c3d4+cd4,!1)+shapeArc(x2,y2,x1,x1,0,cd4,!1).replace("M","L");result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftBracket":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=8333*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,maxAdj=cnstVal1*h/Math.min(w,h);void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,y1,y2,r=w,b=h,cd2=180,cd4=90,c3d4=270;a=0>adj?0:adj>maxAdj?maxAdj:adj,y1=Math.min(w,h)*a/cnstVal2,y1>w&&(y1=w),y2=b-y1;var d="M"+r+","+b+shapeArc(y1,y2,y1,y1,cd4,cd2,!1).replace("M","L")+" L0,"+y1+shapeArc(y1,y1,y1,y1,cd2,c3d4,!1).replace("M","L")+" L"+r+",0";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"rightBracket":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=8333*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,maxAdj=cnstVal1*h/Math.min(w,h);void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,y1,y2,y3,cd=360,cd2=180,cd4=90,c3d4=270;a=0>adj?0:adj>maxAdj?maxAdj:adj,y1=Math.min(w,h)*a/cnstVal2,y2=h-y1,y3=w-y1;var d="M0,"+h+shapeArc(y3,y2,y1,y1,cd4,0,!1).replace("M","L")+" L"+w+","+h/2+shapeArc(y3,y1,y1,y1,cd,c3d4,!1).replace("M","L")+" L0,0";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"moon":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=.5;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))/1e5);var hd2,cd2,cd4;hd2=h/2,cd2=180,cd4=90;var adj2=(1-adj)*w,d="M"+w+","+h+shapeArc(w,hd2,w,hd2,cd4,cd4+cd2,!1).replace("M","L")+shapeArc(w,hd2,adj2,hd2,cd4+cd2,cd4,!1).replace("M","L")+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"corner":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=5e4*slideFactor,sAdj2_val=5e4*slideFactor,cnsVal=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj2_val=parseInt(sAdj2.substr(4))*slideFactor)}var a1,a2,x1,dy1,y1,minWH=Math.min(w,h),maxAdj1=cnsVal*h/minWH,maxAdj2=cnsVal*w/minWH;a1=0>sAdj1_val?0:sAdj1_val>maxAdj1?maxAdj1:sAdj1_val,a2=0>sAdj2_val?0:sAdj2_val>maxAdj2?maxAdj2:sAdj2_val,x1=minWH*a2/cnsVal,dy1=minWH*a1/cnsVal,y1=h-dy1;var d="M0,0 L"+x1+",0 L"+x1+","+y1+" L"+w+","+y1+" L"+w+","+h+" L0,"+h+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"diagStripe":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),sAdj1_val=5e4*slideFactor,cnsVal=1e5*slideFactor;void 0!==shapAdjst&&(sAdj1_val=parseInt(shapAdjst.substr(4))*slideFactor);var a1,x2,y2;a1=0>sAdj1_val?0:sAdj1_val>cnsVal?cnsVal:sAdj1_val,x2=w*a1/cnsVal,y2=h*a1/cnsVal;var d="M0,"+y2+" L"+x2+",0 L"+w+",0 L0,"+h+" z";result+="<path   d='"+d+"'  fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"gear6":case"gear9":txtRotate=0;var d,gearNum=shapType.substr(4);d="6"==gearNum?shapeGear(w,h/3.5,parseInt(gearNum)):shapeGear(w,h/3.5,parseInt(gearNum)),result+="<path   d='"+d+"' transform='rotate(20,"+3/7*h+","+3/7*h+")' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"bentConnector3":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),shapAdjst_val=.5;void 0!==shapAdjst&&(shapAdjst_val=parseInt(shapAdjst.substr(4))/1e5,result+=" <polyline points='0 0,"+shapAdjst_val*w+" 0,"+shapAdjst_val*w+" "+h+","+w+" "+h+"' fill='transparent'' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' ",void 0===headEndNodeAttrs||"triangle"!==headEndNodeAttrs.type&&"arrow"!==headEndNodeAttrs.type||(result+="marker-start='url(#markerTriangle_"+shpId+")' "),void 0===tailEndNodeAttrs||"triangle"!==tailEndNodeAttrs.type&&"arrow"!==tailEndNodeAttrs.type||(result+="marker-end='url(#markerTriangle_"+shpId+")' "),result+="/>");break;case"plus":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj1=.25;void 0!==shapAdjst&&(adj1=parseInt(shapAdjst.substr(4))/1e5);var adj2=1-adj1;result+=" <polygon points='"+adj1*w+" 0,"+adj1*w+" "+adj1*h+",0 "+adj1*h+",0 "+adj2*h+","+adj1*w+" "+adj2*h+","+adj1*w+" "+h+","+adj2*w+" "+h+","+adj2*w+" "+adj2*h+","+w+" "+adj2*h+","+ +w+" "+adj1*h+","+adj2*w+" "+adj1*h+","+adj2*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"teardrop":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj1=1e5*slideFactor,cnsVal1=adj1,cnsVal2=2e5*slideFactor;void 0!==shapAdjst&&(adj1=parseInt(shapAdjst.substr(4))*slideFactor);var a1,r2,tw,th,sw,sh,dx1,dy1,x1,y1,x2,y2,rd45;a1=0>adj1?0:adj1>cnsVal2?cnsVal2:adj1,r2=Math.sqrt(2),tw=r2*(w/2),th=r2*(h/2),sw=tw*a1/cnsVal1,sh=th*a1/cnsVal1,rd45=45*Math.PI/180,dx1=sw*Math.cos(rd45),dy1=sh*Math.cos(rd45),x1=w/2+dx1,y1=h/2-dy1,x2=(w/2+x1)/2,y2=(h/2+y1)/2;var d_val=shapeArc(w/2,h/2,w/2,h/2,180,270,!1)+"Q "+x2+",0 "+x1+","+y1+"Q "+w+","+y2+" "+w+","+h/2+shapeArc(w/2,h/2,w/2,h/2,0,90,!1).replace("M","L")+shapeArc(w/2,h/2,w/2,h/2,90,180,!1).replace("M","L")+" z";result+="<path   d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"plaque":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj1=16667*slideFactor,cnsVal1=5e4*slideFactor,cnsVal2=1e5*slideFactor;void 0!==shapAdjst&&(adj1=parseInt(shapAdjst.substr(4))*slideFactor);var a1,x1,x2,y2;a1=0>adj1?0:adj1>cnsVal1?cnsVal1:adj1,x1=a1*Math.min(w,h)/cnsVal2,x2=w-x1,y2=h-x1;var d_val="M0,"+x1+shapeArc(0,0,x1,x1,90,0,!1).replace("M","L")+" L"+x2+",0"+shapeArc(w,0,x1,x1,180,90,!1).replace("M","L")+" L"+w+","+y2+shapeArc(w,h,x1,x1,270,180,!1).replace("M","L")+" L"+x1+","+h+shapeArc(0,h,x1,x1,0,-90,!1).replace("M","L")+" z";result+="<path   d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"sun":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),refr=slideFactor,adj1=25e3*refr,cnstVal1=12500*refr,cnstVal2=46875*refr;void 0!==shapAdjst&&(adj1=parseInt(shapAdjst.substr(4))*refr);var a1;a1=cnstVal1>adj1?cnstVal1:adj1>cnstVal2?cnstVal2:adj1;var cnstVa3=5e4*refr,cnstVa4=1e5*refr,g0=cnstVa3-a1,g1=g0*(30274*refr)/(32768*refr),g2=g0*(12540*refr)/(32768*refr),g3=g1+cnstVa3,g4=g2+cnstVa3,g5=cnstVa3-g1,g6=cnstVa3-g2,g7=g0*(23170*refr)/(32768*refr),g8=cnstVa3+g7,g9=cnstVa3-g7,g10=3*g5/4,g11=3*g6/4,g12=g10+3662*refr,g13=g11+36620*refr,g14=g11+12500*refr,g15=cnstVa4-g10,g16=cnstVa4-g12,g17=cnstVa4-g13,g18=cnstVa4-g14,ox1=w*(18436*refr)/(21600*refr),oy1=h*(3163*refr)/(21600*refr),ox2=w*(3163*refr)/(21600*refr),oy2=h*(18436*refr)/(21600*refr),x8=w*g8/cnstVa4,x9=w*g9/cnstVa4,x10=w*g10/cnstVa4,x12=w*g12/cnstVa4,x13=w*g13/cnstVa4,x14=w*g14/cnstVa4,x15=w*g15/cnstVa4,x16=w*g16/cnstVa4,x17=w*g17/cnstVa4,x18=w*g18/cnstVa4,x19=w*a1/cnstVa4,wR=w*g0/cnstVa4,hR=h*g0/cnstVa4,y8=h*g8/cnstVa4,y9=h*g9/cnstVa4,y10=h*g10/cnstVa4,y12=h*g12/cnstVa4,y13=h*g13/cnstVa4,y14=h*g14/cnstVa4,y15=h*g15/cnstVa4,y16=h*g16/cnstVa4,y17=h*g17/cnstVa4,y18=h*g18/cnstVa4,d_val="M"+w+","+h/2+" L"+x15+","+y18+" L"+x15+","+y14+"z M"+ox1+","+oy1+" L"+x16+","+y17+" L"+x13+","+y12+"z M"+w/2+",0 L"+x18+","+y10+" L"+x14+","+y10+"z M"+ox2+","+oy1+" L"+x17+","+y12+" L"+x12+","+y17+"z M0,"+h/2+" L"+x10+","+y14+" L"+x10+","+y18+"z M"+ox2+","+oy2+" L"+x12+","+y13+" L"+x17+","+y16+"z M"+w/2+","+h+" L"+x14+","+y15+" L"+x18+","+y15+"z M"+ox1+","+oy2+" L"+x13+","+y16+" L"+x16+","+y13+" z M"+x19+","+h/2+shapeArc(w/2,h/2,wR,hR,180,540,!1).replace("M","L")+" z";result+="<path   d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"heart":var dx1,dx2,x1,x2,x3,x4,y1;dx1=49*w/48,dx2=10*w/48,x1=w/2-dx1,x2=w/2-dx2,x3=w/2+dx2,x4=w/2+dx1,y1=-h/3;var d_val="M"+w/2+","+h/4+"C"+x3+","+y1+" "+x4+","+h/4+" "+w/2+","+h+"C"+x1+","+h/4+" "+x2+","+y1+" "+w/2+","+h/4+" z";result+="<path   d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"lightningBolt":var x1=5022*w/21600,x2=11050*w/21600,x3=8472*w/21600,x4=8757*w/21600,x5=10012*w/21600,x6=14767*w/21600,x7=12222*w/21600,x8=12860*w/21600,x9=13917*w/21600,x10=7602*w/21600,x11=16577*w/21600,y1=3890*h/21600,y2=6080*h/21600,y3=6797*h/21600,y4=7437*h/21600,y5=12877*h/21600,y6=9705*h/21600,y7=12007*h/21600,y8=13987*h/21600,y9=8382*h/21600,y10=14277*h/21600,y11=14915*h/21600,d_val="M"+x3+",0 L"+x8+","+y2+" L"+x2+","+y3+" L"+x11+","+y7+" L"+x6+","+y5+" L"+w+","+h+" L"+x5+","+y11+" L"+x7+","+y8+" L"+x1+","+y6+" L"+x10+","+y9+" L0,"+y1+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"cube":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),refr=slideFactor,adj=25e3*refr;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*refr);var d_val,a,y1,y4,x4,cnstVal2=1e5*refr,ss=Math.min(w,h);a=0>adj?0:adj>cnstVal2?cnstVal2:adj,y1=ss*a/cnstVal2,y4=h-y1,x4=w-y1,d_val="M0,"+y1+" L"+y1+",0 L"+w+",0 L"+w+","+y4+" L"+x4+","+h+" L0,"+h+" zM0,"+y1+" L"+x4+","+y1+" M"+x4+","+y1+" L"+w+",0M"+x4+","+y1+" L"+x4+","+h,result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"bevel":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),refr=slideFactor,adj=12500*refr;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*refr);var d_val,a,x1,x2,y2,cnstVal1=5e4*refr,cnstVal2=1e5*refr,ss=Math.min(w,h);a=0>adj?0:adj>cnstVal1?cnstVal1:adj,x1=ss*a/cnstVal2,x2=w-x1,y2=h-x1,d_val="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+x1+","+x1+" L"+x2+","+x1+" L"+x2+","+y2+" L"+x1+","+y2+" z M0,0 L"+x1+","+x1+" M0,"+h+" L"+x1+","+y2+" M"+w+",0 L"+x2+","+x1+" M"+w+","+h+" L"+x2+","+y2,result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"foldedCorner":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),refr=slideFactor,adj=16667*refr;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*refr);var d_val,a,dy2,dy1,x1,x2,y2,y1,cnstVal1=5e4*refr,cnstVal2=1e5*refr,ss=Math.min(w,h);a=0>adj?0:adj>cnstVal1?cnstVal1:adj,dy2=ss*a/cnstVal2,dy1=dy2/5,x1=w-dy2,x2=x1+dy1,y2=h-dy2,y1=y2+dy1,d_val="M"+x1+","+h+" L"+x2+","+y1+" L"+w+","+y2+" L"+x1+","+h+" L0,"+h+" L0,0 L"+w+",0 L"+w+","+y2,result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"cloud":case"cloudCallout":var x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,y0,y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,y11,rx2,rx3,rx4,rx5,rx6,rx7,ry1,ry2,ry3,ry4;x0=3900*w/43200,x1=4693*w/43200,x2=6928*w/43200,x3=16478*w/43200,x4=28827*w/43200,x5=34129*w/43200,x6=41798*w/43200,
x7=38324*w/43200,x8=29078*w/43200,x9=22141*w/43200,x10=14e3*w/43200,x11=4127*w/43200,y0=14370*h/43200,y1=26177*h/43200,y2=34899*h/43200,y3=39090*h/43200,y4=34751*h/43200,y5=22954*h/43200,y6=15354*h/43200,y7=5426*h/43200,y8=3952*h/43200,y9=4720*h/43200,y10=5192*h/43200,y11=15789*h/43200;var cX0,cX1,cX2,cX3,cX4,cX5,cX6,cX7,cX8,cX9,cX10,cY0,cY1,cY2,cY3,cY4,cY5,cY6,cY7,cY8,cY9,cY10,arc1,arc2,arc3,arc4,arc5,arc6,arc7,arc8,arc9,arc10,arc11,lxy1,lxy2,lxy3,lxy4,lxy5,lxy6,lxy7,lxy8,lxy9,lxy10,rX1=6753*w/43200,rY1=9190*h/43200,rX2=5333*w/43200,rY2=7267*h/43200,rX3=4365*w/43200,rY3=5945*h/43200,rX4=4857*w/43200,rY4=6595*h/43200,rY5=7273*h/43200,rX6=6775*w/43200,rY6=9220*h/43200,rX7=5785*w/43200,rY7=7867*h/43200,rX8=6752*w/43200,rY8=9215*h/43200,rX9=7720*w/43200,rY9=10543*h/43200,rX10=4360*w/43200,rY10=5918*h/43200,rX11=4345*w/43200,sA1=-11429249/6e4,wA1=7426832/6e4,sA2=-8646143/6e4,wA2=5396714/6e4,sA3=-8748475/6e4,wA3=5983381/6e4,sA4=-7859164/6e4,wA4=7034504/6e4,sA5=-4722533/6e4,wA5=6541615/6e4,sA6=-46.26725,wA6=130.269,sA7=37501/6e4,wA7=6842e3/6e4,sA8=22.4516,wA8=115.17255,sA9=3974558/6e4,wA9=4542661/6e4,sA10=-16496525/6e4,wA10=8804134/6e4,sA11=-246.8285,wA11=152.51885;cX0=x0-rX1*Math.cos(sA1*Math.PI/180),cY0=y0-rY1*Math.sin(sA1*Math.PI/180),arc1=shapeArc(cX0,cY0,rX1,rY1,sA1,sA1+wA1,!1).replace("M","L"),lxy1=arc1.substr(arc1.lastIndexOf("L")+1).split(" "),cX1=parseInt(lxy1[0])-rX2*Math.cos(sA2*Math.PI/180),cY1=parseInt(lxy1[1])-rY2*Math.sin(sA2*Math.PI/180),arc2=shapeArc(cX1,cY1,rX2,rY2,sA2,sA2+wA2,!1).replace("M","L"),lxy2=arc2.substr(arc2.lastIndexOf("L")+1).split(" "),cX2=parseInt(lxy2[0])-rX3*Math.cos(sA3*Math.PI/180),cY2=parseInt(lxy2[1])-rY3*Math.sin(sA3*Math.PI/180),arc3=shapeArc(cX2,cY2,rX3,rY3,sA3,sA3+wA3,!1).replace("M","L"),lxy3=arc3.substr(arc3.lastIndexOf("L")+1).split(" "),cX3=parseInt(lxy3[0])-rX4*Math.cos(sA4*Math.PI/180),cY3=parseInt(lxy3[1])-rY4*Math.sin(sA4*Math.PI/180),arc4=shapeArc(cX3,cY3,rX4,rY4,sA4,sA4+wA4,!1).replace("M","L"),lxy4=arc4.substr(arc4.lastIndexOf("L")+1).split(" "),cX4=parseInt(lxy4[0])-rX2*Math.cos(sA5*Math.PI/180),cY4=parseInt(lxy4[1])-rY5*Math.sin(sA5*Math.PI/180),arc5=shapeArc(cX4,cY4,rX2,rY5,sA5,sA5+wA5,!1).replace("M","L"),lxy5=arc5.substr(arc5.lastIndexOf("L")+1).split(" "),cX5=parseInt(lxy5[0])-rX6*Math.cos(sA6*Math.PI/180),cY5=parseInt(lxy5[1])-rY6*Math.sin(sA6*Math.PI/180),arc6=shapeArc(cX5,cY5,rX6,rY6,sA6,sA6+wA6,!1).replace("M","L"),lxy6=arc6.substr(arc6.lastIndexOf("L")+1).split(" "),cX6=parseInt(lxy6[0])-rX7*Math.cos(sA7*Math.PI/180),cY6=parseInt(lxy6[1])-rY7*Math.sin(sA7*Math.PI/180),arc7=shapeArc(cX6,cY6,rX7,rY7,sA7,sA7+wA7,!1).replace("M","L"),lxy7=arc7.substr(arc7.lastIndexOf("L")+1).split(" "),cX7=parseInt(lxy7[0])-rX8*Math.cos(sA8*Math.PI/180),cY7=parseInt(lxy7[1])-rY8*Math.sin(sA8*Math.PI/180),arc8=shapeArc(cX7,cY7,rX8,rY8,sA8,sA8+wA8,!1).replace("M","L"),lxy8=arc8.substr(arc8.lastIndexOf("L")+1).split(" "),cX8=parseInt(lxy8[0])-rX9*Math.cos(sA9*Math.PI/180),cY8=parseInt(lxy8[1])-rY9*Math.sin(sA9*Math.PI/180),arc9=shapeArc(cX8,cY8,rX9,rY9,sA9,sA9+wA9,!1).replace("M","L"),lxy9=arc9.substr(arc9.lastIndexOf("L")+1).split(" "),cX9=parseInt(lxy9[0])-rX10*Math.cos(sA10*Math.PI/180),cY9=parseInt(lxy9[1])-rY10*Math.sin(sA10*Math.PI/180),arc10=shapeArc(cX9,cY9,rX10,rY10,sA10,sA10+wA10,!1).replace("M","L"),lxy10=arc10.substr(arc10.lastIndexOf("L")+1).split(" "),cX10=parseInt(lxy10[0])-rX11*Math.cos(sA11*Math.PI/180),cY10=parseInt(lxy10[1])-rY3*Math.sin(sA11*Math.PI/180),arc11=shapeArc(cX10,cY10,rX11,rY3,sA11,sA11+wA11,!1).replace("M","L");var d1="M"+x0+","+y0+arc1+arc2+arc3+arc4+arc5+arc6+arc7+arc8+arc9+arc10+arc11+" z";if("cloudCallout"==shapType){var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),refr=slideFactor,adj1=-20833*refr,adj2=62500*refr;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*refr):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*refr)}var d_val,dxPos,dyPos,xPos,yPos,ht,wt,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,x23,x24,x25,cnstVal2=1e5*refr,ss=Math.min(w,h),wd2=w/2,hd2=h/2;dxPos=w*adj1/cnstVal2,dyPos=h*adj2/cnstVal2,xPos=wd2+dxPos,yPos=hd2+dyPos,ht=hd2*Math.cos(Math.atan(dyPos/dxPos)),wt=wd2*Math.sin(Math.atan(dyPos/dxPos)),g2=wd2*Math.cos(Math.atan(wt/ht)),g3=hd2*Math.sin(Math.atan(wt/ht)),adj1>=0?(g4=wd2+g2,g5=hd2+g3):(g4=wd2-g2,g5=hd2-g3),g6=g4-xPos,g7=g5-yPos,g8=Math.sqrt(g6*g6+g7*g7),g9=6600*ss/21600,g10=g8-g9,g11=g10/3,g12=1800*ss/21600,g13=g11+g12,g14=g13*g6/g8,g15=g13*g7/g8,g16=g14+xPos,g17=g15+yPos,g18=4800*ss/21600,g19=2*g11,g20=g18+g19,g21=g20*g6/g8,g22=g20*g7/g8,g23=g21+xPos,g24=g22+yPos,g25=1200*ss/21600,g26=600*ss/21600,x23=xPos+g26,x24=g16+g25,x25=g23+g12,d_val=shapeArc(x23-g26,yPos,g26,g26,0,360,!1)+" z M"+x24+","+g17+shapeArc(x24-g25,g17,g25,g25,0,360,!1).replace("M","L")+" z M"+x25+","+g24+shapeArc(x25-g12,g24,g12,g12,0,360,!1).replace("M","L")+" z",d1+=d_val}result+="<path d='"+d1+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"smileyFace":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),refr=slideFactor,adj=4653*refr;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*refr);var d_val,a,x1,x2,x3,x4,y1,y3,dy2,y2,y4,dy3,y5,wR,hR,wd2,hd2,cnstVal1=5e4*refr,cnstVal2=1e5*refr,cnstVal3=4653*refr,ss=Math.min(w,h);wd2=w/2,hd2=h/2,a=-cnstVal3>adj?-cnstVal3:adj>cnstVal3?cnstVal3:adj,x1=4969*w/21699,x2=6215*w/21600,x3=13135*w/21600,x4=16640*w/21600,y1=7570*h/21600,y3=16515*h/21600,dy2=h*a/cnstVal2,y2=y3-dy2,y4=y3+dy2,dy3=h*a/cnstVal1,y5=y4+dy3,wR=1125*w/21600,hR=1125*h/21600;var cX1=x2-wR*Math.cos(Math.PI),cY1=y1-hR*Math.sin(Math.PI),cX2=x3-wR*Math.cos(Math.PI);d_val=shapeArc(cX1,cY1,wR,hR,180,540,!1)+shapeArc(cX2,cY1,wR,hR,180,540,!1)+" M"+x1+","+y2+" Q"+wd2+","+y5+" "+x4+","+y2+" Q"+wd2+","+y5+" "+x1+","+y2+" M0,"+hd2+shapeArc(wd2,hd2,wd2,hd2,180,540,!1).replace("M","L")+" z",result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"verticalScroll":case"horizontalScroll":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),refr=slideFactor,adj=12500*refr;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*refr);var d_val,a,ch,ch2,ch4,cnstVal1=25e3*refr,cnstVal2=1e5*refr,ss=Math.min(w,h),t=0,l=0,b=h,r=w;if(a=0>adj?0:adj>cnstVal1?cnstVal1:adj,ch=ss*a/cnstVal2,ch2=ch/2,ch4=ch/4,"verticalScroll"==shapType){var x3,x4,x6,x7,x5,y3,y4;x3=ch+ch2,x4=ch+ch,x6=r-ch,x7=r-ch2,x5=x6-ch2,y3=b-ch,y4=b-ch2,d_val="M"+ch+","+y3+" L"+ch+","+ch2+shapeArc(x3,ch2,ch2,ch2,180,270,!1).replace("M","L")+" L"+x7+","+t+shapeArc(x7,ch2,ch2,ch2,270,450,!1).replace("M","L")+" L"+x6+","+ch+" L"+x6+","+y4+shapeArc(x5,y4,ch2,ch2,0,90,!1).replace("M","L")+" L"+ch2+","+b+shapeArc(ch2,y4,ch2,ch2,90,270,!1).replace("M","L")+" z M"+x3+","+t+shapeArc(x3,ch2,ch2,ch2,270,450,!1).replace("M","L")+shapeArc(x3,x3/2,ch4,ch4,90,270,!1).replace("M","L")+" L"+x4+","+ch2+" M"+x6+","+ch+" L"+x3+","+ch+" M"+ch+","+y4+shapeArc(ch2,y4,ch2,ch2,0,270,!1).replace("M","L")+shapeArc(ch2,(y4+y3)/2,ch4,ch4,270,450,!1).replace("M","L")+" z M"+ch+","+y4+" L"+ch+","+y3}else if("horizontalScroll"==shapType){var y3,y4,y6,y7,y5,x3,x4;y3=ch+ch2,y4=ch+ch,y6=b-ch,y7=b-ch2,y5=y6-ch2,x3=r-ch,x4=r-ch2,d_val="M"+l+","+y3+shapeArc(ch2,y3,ch2,ch2,180,270,!1).replace("M","L")+" L"+x3+","+ch+" L"+x3+","+ch2+shapeArc(x4,ch2,ch2,ch2,180,360,!1).replace("M","L")+" L"+r+","+y5+shapeArc(x4,y5,ch2,ch2,0,90,!1).replace("M","L")+" L"+ch+","+y6+" L"+ch+","+y7+shapeArc(ch2,y7,ch2,ch2,0,180,!1).replace("M","L")+" zM"+x4+","+ch+shapeArc(x4,ch2,ch2,ch2,90,-180,!1).replace("M","L")+shapeArc((x3+x4)/2,ch2,ch4,ch4,180,0,!1).replace("M","L")+" z M"+x4+","+ch+" L"+x3+","+ch+" M"+ch2+","+y4+" L"+ch2+","+y3+shapeArc(y3/2,y3,ch4,ch4,180,360,!1).replace("M","L")+shapeArc(ch2,y3,ch2,ch2,0,180,!1).replace("M","L")+" M"+ch+","+y3+" L"+ch+","+y6}result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"wedgeEllipseCallout":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),refr=slideFactor,adj1=-20833*refr,adj2=62500*refr;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*refr):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*refr)}var d_val,dxPos,dyPos,xPos,yPos,sdx,sdy,pang,stAng,enAng,dx1,dy1,x1,y1,dx2,dy2,x2,y2,stAng1,swAng2,swAng,cnstVal1=1e5*slideFactor,angVal1=11*Math.PI/180,ss=Math.min(w,h),vc=h/2,hc=w/2;dxPos=w*adj1/cnstVal1,dyPos=h*adj2/cnstVal1,xPos=hc+dxPos,yPos=vc+dyPos,sdx=dxPos*h,sdy=dyPos*w,pang=Math.atan(sdy/sdx),stAng=pang+angVal1,enAng=pang-angVal1,console.log("dxPos: ",dxPos,"dyPos: ",dyPos),dx1=hc*Math.cos(stAng),dy1=vc*Math.sin(stAng),dx2=hc*Math.cos(enAng),dy2=vc*Math.sin(enAng),dxPos>=0?(x1=hc+dx1,y1=vc+dy1,x2=hc+dx2,y2=vc+dy2):(x1=hc-dx1,y1=vc-dy1,x2=hc-dx2,y2=vc-dy2),d_val="M"+x1+","+y1+" L"+xPos+","+yPos+" L"+x2+","+y2+shapeArc(hc,vc,hc,vc,0,360,!0),result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"wedgeRectCallout":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),refr=slideFactor,adj1=-20833*refr,adj2=62500*refr;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*refr):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*refr)}var d_val,dxPos,dyPos,xPos,yPos,dx,dy,dq,ady,adq,dz,xg1,xg2,x1,x2,yg1,yg2,y1,y2,t1,xl,t2,xt,t3,xr,t4,xb,t5,yl,t6,yt,t7,yr,t8,yb,cnstVal1=1e5*slideFactor,vc=h/2,hc=w/2;dxPos=w*adj1/cnstVal1,dyPos=h*adj2/cnstVal1,xPos=hc+dxPos,yPos=vc+dyPos,dx=xPos-hc,dy=yPos-vc,dq=dxPos*h/w,ady=Math.abs(dyPos),adq=Math.abs(dq),dz=ady-adq,xg1=dxPos>0?7:2,xg2=dxPos>0?10:5,x1=w*xg1/12,x2=w*xg2/12,yg1=dyPos>0?7:2,yg2=dyPos>0?10:5,y1=h*yg1/12,y2=h*yg2/12,t1=dxPos>0?0:xPos,xl=dz>0?0:t1,t2=dyPos>0?x1:xPos,xt=dz>0?t2:x1,t3=dxPos>0?xPos:w,xr=dz>0?w:t3,t4=dyPos>0?xPos:x1,xb=dz>0?t4:x1,t5=dxPos>0?y1:yPos,yl=dz>0?y1:t5,t6=dyPos>0?0:yPos,yt=dz>0?t6:0,t7=dxPos>0?yPos:y1,yr=dz>0?y1:t7,t8=dyPos>0?yPos:h,yb=dz>0?t8:h,d_val="M0,0 L"+x1+",0 L"+xt+","+yt+" L"+x2+",0 L"+w+",0 L"+w+","+y1+" L"+xr+","+yr+" L"+w+","+y2+" L"+w+","+h+" L"+x2+","+h+" L"+xb+","+yb+" L"+x1+","+h+" L0,"+h+" L0,"+y2+" L"+xl+","+yl+" L0,"+y1+" z",result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"wedgeRoundRectCallout":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),refr=slideFactor,adj1=-20833*refr,adj2=62500*refr,adj3=16667*refr;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*refr):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*refr):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*refr)}var d_val,dxPos,dyPos,xPos,yPos,dq,ady,adq,dz,xg1,xg2,x1,x2,yg1,yg2,y1,y2,t1,xl,t2,xt,t3,xr,t4,xb,t5,yl,t6,yt,t7,yr,t8,yb,u1,u2,v2,cnstVal1=1e5*slideFactor,ss=Math.min(w,h),vc=h/2,hc=w/2;dxPos=w*adj1/cnstVal1,dyPos=h*adj2/cnstVal1,xPos=hc+dxPos,yPos=vc+dyPos,dq=dxPos*h/w,ady=Math.abs(dyPos),adq=Math.abs(dq),dz=ady-adq,xg1=dxPos>0?7:2,xg2=dxPos>0?10:5,x1=w*xg1/12,x2=w*xg2/12,yg1=dyPos>0?7:2,yg2=dyPos>0?10:5,y1=h*yg1/12,y2=h*yg2/12,t1=dxPos>0?0:xPos,xl=dz>0?0:t1,t2=dyPos>0?x1:xPos,xt=dz>0?t2:x1,t3=dxPos>0?xPos:w,xr=dz>0?w:t3,t4=dyPos>0?xPos:x1,xb=dz>0?t4:x1,t5=dxPos>0?y1:yPos,yl=dz>0?y1:t5,t6=dyPos>0?0:yPos,yt=dz>0?t6:0,t7=dxPos>0?yPos:y1,yr=dz>0?y1:t7,t8=dyPos>0?yPos:h,yb=dz>0?t8:h,u1=ss*adj3/cnstVal1,u2=w-u1,v2=h-u1,d_val="M0,"+u1+shapeArc(u1,u1,u1,u1,180,270,!1).replace("M","L")+" L"+x1+",0 L"+xt+","+yt+" L"+x2+",0 L"+u2+",0"+shapeArc(u2,u1,u1,u1,270,360,!1).replace("M","L")+" L"+w+","+y1+" L"+xr+","+yr+" L"+w+","+y2+" L"+w+","+v2+shapeArc(u2,v2,u1,u1,0,90,!1).replace("M","L")+" L"+x2+","+h+" L"+xb+","+yb+" L"+x1+","+h+" L"+u1+","+h+shapeArc(u1,v2,u1,u1,90,180,!1).replace("M","L")+" L0,"+y2+" L"+xl+","+yl+" L0,"+y1+" z",result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"accentBorderCallout1":case"accentBorderCallout2":case"accentBorderCallout3":case"borderCallout1":case"borderCallout2":case"borderCallout3":case"accentCallout1":case"accentCallout2":case"accentCallout3":case"callout1":case"callout2":case"callout3":var sAdj1,sAdj2,sAdj3,sAdj4,sAdj5,sAdj6,sAdj7,sAdj8,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),refr=slideFactor,adj1=18750*refr,adj2=-8333*refr,adj3=18750*refr,adj4=-16667*refr,adj5=1e5*refr,adj6=-16667*refr,adj7=112963*refr,adj8=-8333*refr;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*refr):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*refr):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*refr):"adj4"==sAdj_name?(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*refr):"adj5"==sAdj_name?(sAdj5=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj5=parseInt(sAdj5.substr(4))*refr):"adj6"==sAdj_name?(sAdj6=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj6=parseInt(sAdj6.substr(4))*refr):"adj7"==sAdj_name?(sAdj7=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj7=parseInt(sAdj7.substr(4))*refr):"adj8"==sAdj_name&&(sAdj8=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj8=parseInt(sAdj8.substr(4))*refr)}var d_val,cnstVal1=1e5*refr,isBorder=!0;switch(shapType){case"borderCallout1":case"callout1":isBorder="borderCallout1"==shapType?!0:!1,void 0===shapAdjst_ary&&(adj1=18750*refr,adj2=-8333*refr,adj3=112500*refr,adj4=-38333*refr);var y1,x1,y2,x2;y1=h*adj1/cnstVal1,x1=w*adj2/cnstVal1,y2=h*adj3/cnstVal1,x2=w*adj4/cnstVal1,d_val="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+x1+","+y1+" L"+x2+","+y2;break;case"borderCallout2":case"callout2":isBorder="borderCallout2"==shapType?!0:!1,void 0===shapAdjst_ary&&(adj1=18750*refr,adj2=-8333*refr,adj3=18750*refr,adj4=-16667*refr,adj5=112500*refr,adj6=-46667*refr);var y1,x1,y2,x2,y3,x3;y1=h*adj1/cnstVal1,x1=w*adj2/cnstVal1,y2=h*adj3/cnstVal1,x2=w*adj4/cnstVal1,y3=h*adj5/cnstVal1,x3=w*adj6/cnstVal1,d_val="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+x1+","+y1+" L"+x2+","+y2+" L"+x3+","+y3+" L"+x2+","+y2;break;case"borderCallout3":case"callout3":isBorder="borderCallout3"==shapType?!0:!1,void 0===shapAdjst_ary&&(adj1=18750*refr,adj2=-8333*refr,adj3=18750*refr,adj4=-16667*refr,adj5=1e5*refr,adj6=-16667*refr,adj7=112963*refr,adj8=-8333*refr);var y1,x1,y2,x2,y3,x3,y4,x4;y1=h*adj1/cnstVal1,x1=w*adj2/cnstVal1,y2=h*adj3/cnstVal1,x2=w*adj4/cnstVal1,y3=h*adj5/cnstVal1,x3=w*adj6/cnstVal1,y4=h*adj7/cnstVal1,x4=w*adj8/cnstVal1,d_val="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+x1+","+y1+" L"+x2+","+y2+" L"+x3+","+y3+" L"+x4+","+y4+" L"+x3+","+y3+" L"+x2+","+y2;break;case"accentBorderCallout1":case"accentCallout1":isBorder="accentBorderCallout1"==shapType?!0:!1,void 0===shapAdjst_ary&&(adj1=18750*refr,adj2=-8333*refr,adj3=112500*refr,adj4=-38333*refr);var y1,x1,y2,x2;y1=h*adj1/cnstVal1,x1=w*adj2/cnstVal1,y2=h*adj3/cnstVal1,x2=w*adj4/cnstVal1,d_val="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+x1+","+y1+" L"+x2+","+y2+" M"+x1+",0 L"+x1+","+h;break;case"accentBorderCallout2":case"accentCallout2":isBorder="accentBorderCallout2"==shapType?!0:!1,void 0===shapAdjst_ary&&(adj1=18750*refr,adj2=-8333*refr,adj3=18750*refr,adj4=-16667*refr,adj5=112500*refr,adj6=-46667*refr);var y1,x1,y2,x2,y3,x3;y1=h*adj1/cnstVal1,x1=w*adj2/cnstVal1,y2=h*adj3/cnstVal1,x2=w*adj4/cnstVal1,y3=h*adj5/cnstVal1,x3=w*adj6/cnstVal1,d_val="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+x1+","+y1+" L"+x2+","+y2+" L"+x3+","+y3+" L"+x2+","+y2+" M"+x1+",0 L"+x1+","+h;break;case"accentBorderCallout3":case"accentCallout3":isBorder="accentBorderCallout3"==shapType?!0:!1,isBorder=!0,void 0===shapAdjst_ary&&(adj1=18750*refr,adj2=-8333*refr,adj3=18750*refr,adj4=-16667*refr,adj5=1e5*refr,adj6=-16667*refr,adj7=112963*refr,adj8=-8333*refr);var y1,x1,y2,x2,y3,x3,y4,x4;y1=h*adj1/cnstVal1,x1=w*adj2/cnstVal1,y2=h*adj3/cnstVal1,x2=w*adj4/cnstVal1,y3=h*adj5/cnstVal1,x3=w*adj6/cnstVal1,y4=h*adj7/cnstVal1,x4=w*adj8/cnstVal1,d_val="M0,0 L"+w+",0 L"+w+","+h+" L0,"+h+" z M"+x1+","+y1+" L"+x2+","+y2+" L"+x3+","+y3+" L"+x4+","+y4+" L"+x3+","+y3+" L"+x2+","+y2+" M"+x1+",0 L"+x1+","+h}result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftRightRibbon":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),refr=slideFactor,adj1=5e4*refr,adj2=5e4*refr,adj3=16667*refr;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*refr):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*refr):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*refr)}var d_val,a3,maxAdj1,a1,w1,maxAdj2,a2,x1,x4,dy1,dy2,ly1,ry4,ly2,ry3,ly4,ry1,ly3,ry2,hR,x2,x3,y1,y2,cnstVal1=33333*refr,cnstVal2=1e5*refr,cnstVal3=2e5*refr,cnstVal4=4e5*refr,ss=Math.min(w,h),wd32=w/32,vc=h/2,hc=w/2;a3=0>adj3?0:adj3>cnstVal1?cnstVal1:adj3,maxAdj1=cnstVal2-a3,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,w1=hc-wd32,maxAdj2=cnstVal2*w1/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,x1=ss*a2/cnstVal2,x4=w-x1,dy1=h*a1/cnstVal3,dy2=h*a3/-cnstVal3,ly1=vc+dy2-dy1,ry4=vc+dy1-dy2,ly2=ly1+dy1,ry3=h-ly2,ly4=2*ly2,ry1=h-ly4,ly3=ly4-ly1,ry2=h-ly3,hR=a3*ss/cnstVal4,x2=hc-wd32,x3=hc+wd32,y1=ly1+hR,y2=ry2-hR,d_val="M0,"+ly2+"L"+x1+",0L"+x1+","+ly1+"L"+hc+","+ly1+shapeArc(hc,y1,wd32,hR,270,450,!1).replace("M","L")+shapeArc(hc,y2,wd32,hR,270,90,!1).replace("M","L")+"L"+x4+","+ry2+"L"+x4+","+ry1+"L"+w+","+ry3+"L"+x4+","+h+"L"+x4+","+ry4+"L"+hc+","+ry4+shapeArc(hc,ry4-hR,wd32,hR,90,180,!1).replace("M","L")+"L"+x2+","+ly3+"L"+x1+","+ly3+"L"+x1+","+ly4+" zM"+x3+","+y1+"L"+x3+","+ry2+"M"+x2+","+y2+"L"+x2+","+ly3,result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"ribbon":case"ribbon2":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=16667*slideFactor,adj2=5e4*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor)}var d_val,a1,a2,x10,dx2,x2,x9,x3,x8,x5,x6,x4,x7,y1,y2,y4,y3,hR,y6,cnstVal1=25e3*slideFactor,cnstVal2=33333*slideFactor,cnstVal3=75e3*slideFactor,cnstVal4=1e5*slideFactor,cnstVal5=2e5*slideFactor,cnstVal6=4e5*slideFactor,hc=w/2,t=0,l=0,b=h,r=w,wd8=w/8,wd32=w/32;if(a1=0>adj1?0:adj1>cnstVal2?cnstVal2:adj1,a2=cnstVal1>adj2?cnstVal1:adj2>cnstVal3?cnstVal3:adj2,x10=r-wd8,dx2=w*a2/cnstVal5,x2=hc-dx2,x9=hc+dx2,x3=x2+wd32,x8=x9-wd32,x5=x2+wd8,x6=x9-wd8,x4=x5-wd32,x7=x6+wd32,hR=h*a1/cnstVal6,"ribbon2"==shapType){var dy1,dy2,y7;dy1=h*a1/cnstVal5,y1=b-dy1,dy2=h*a1/cnstVal4,y2=b-dy2,y4=t+dy2,y3=(y4+b)/2,y6=b-hR,y7=y1-hR,d_val="M"+l+","+b+" L"+wd8+","+y3+" L"+l+","+y4+" L"+x2+","+y4+" L"+x2+","+hR+shapeArc(x3,hR,wd32,hR,180,270,!1).replace("M","L")+" L"+x8+","+t+shapeArc(x8,hR,wd32,hR,270,360,!1).replace("M","L")+" L"+x9+","+y4+" L"+x9+","+y4+" L"+r+","+y4+" L"+x10+","+y3+" L"+r+","+b+" L"+x7+","+b+shapeArc(x7,y6,wd32,hR,90,270,!1).replace("M","L")+" L"+x8+","+y1+shapeArc(x8,y7,wd32,hR,90,-90,!1).replace("M","L")+" L"+x3+","+y2+shapeArc(x3,y7,wd32,hR,270,90,!1).replace("M","L")+" L"+x4+","+y1+shapeArc(x4,y6,wd32,hR,270,450,!1).replace("M","L")+" z M"+x5+","+y2+" L"+x5+","+y6+"M"+x6+","+y6+" L"+x6+","+y2+"M"+x2+","+y7+" L"+x2+","+y4+"M"+x9+","+y4+" L"+x9+","+y7}else if("ribbon"==shapType){var y5;y1=h*a1/cnstVal5,y2=h*a1/cnstVal4,y4=b-y2,y3=y4/2,y5=b-hR,y6=y2-hR,d_val="M"+l+","+t+" L"+x4+","+t+shapeArc(x4,hR,wd32,hR,270,450,!1).replace("M","L")+" L"+x3+","+y1+shapeArc(x3,y6,wd32,hR,270,90,!1).replace("M","L")+" L"+x8+","+y2+shapeArc(x8,y6,wd32,hR,90,-90,!1).replace("M","L")+" L"+x7+","+y1+shapeArc(x7,hR,wd32,hR,90,270,!1).replace("M","L")+" L"+r+","+t+" L"+x10+","+y3+" L"+r+","+y4+" L"+x9+","+y4+" L"+x9+","+y5+shapeArc(x8,y5,wd32,hR,0,90,!1).replace("M","L")+" L"+x3+","+b+shapeArc(x3,y5,wd32,hR,90,180,!1).replace("M","L")+" L"+x2+","+y4+" L"+l+","+y4+" L"+wd8+","+y3+" z M"+x5+","+hR+" L"+x5+","+y2+"M"+x6+","+y2+" L"+x6+","+hR+"M"+x2+","+y4+" L"+x2+","+y6+"M"+x9+","+y6+" L"+x9+","+y4}result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"doubleWave":case"wave":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1="doubleWave"==shapType?6250*slideFactor:12500*slideFactor,adj2=0;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor)}var d_val,cnstVal2=-1e4*slideFactor,cnstVal3=5e4*slideFactor,cnstVal4=1e5*slideFactor,hc=w/2,t=0,l=0,b=h,r=w,wd8=w/8,wd32=w/32;if("doubleWave"==shapType){var a1,a2,y1,dy2,y2,y3,y4,y5,y6,of2,dx2,x2,dx8,x8,dx3,x3,dx4,x4,x5,x6,x7,x9,x15,x10,x11,x12,x13,x14,cnstVal1=12500*slideFactor;a1=0>adj1?0:adj1>cnstVal1?cnstVal1:adj1,a2=cnstVal2>adj2?cnstVal2:adj2>cnstVal4?cnstVal4:adj2,y1=h*a1/cnstVal4,dy2=10*y1/3,y2=y1-dy2,y3=y1+dy2,y4=b-y1,y5=y4-dy2,y6=y4+dy2,of2=w*a2/cnstVal3,dx2=of2>0?0:of2,x2=l-dx2,dx8=of2>0?of2:0,x8=r-dx8,dx3=(dx2+x8)/6,x3=x2+dx3,dx4=(dx2+x8)/3,x4=x2+dx4,x5=(x2+x8)/2,x6=x5+dx3,x7=(x6+x8)/2,x9=l+dx8,x15=r+dx2,x10=x9+dx3,x11=x9+dx4,x12=(x9+x15)/2,x13=x12+dx3,x14=(x13+x15)/2,d_val="M"+x2+","+y1+" C"+x3+","+y2+" "+x4+","+y3+" "+x5+","+y1+" C"+x6+","+y2+" "+x7+","+y3+" "+x8+","+y1+" L"+x15+","+y4+" C"+x14+","+y6+" "+x13+","+y5+" "+x12+","+y4+" C"+x11+","+y6+" "+x10+","+y5+" "+x9+","+y4+" z"}else if("wave"==shapType){var a1,a2,y1,dy2,y2,y3,y4,y5,y6,of2,dx2,x2,dx5,x5,dx3,x3,x4,x6,x10,x7,x8,cnstVal5=2e4*slideFactor;a1=0>adj1?0:adj1>cnstVal5?cnstVal5:adj1,a2=cnstVal2>adj2?cnstVal2:adj2>cnstVal4?cnstVal4:adj2,y1=h*a1/cnstVal4,dy2=10*y1/3,y2=y1-dy2,y3=y1+dy2,y4=b-y1,y5=y4-dy2,y6=y4+dy2,of2=w*a2/cnstVal3,dx2=of2>0?0:of2,x2=l-dx2,dx5=of2>0?of2:0,x5=r-dx5,dx3=(dx2+x5)/3,x3=x2+dx3,x4=(x3+x5)/2,x6=l+dx5,x10=r+dx2,x7=x6+dx3,x8=(x7+x10)/2,d_val="M"+x2+","+y1+" C"+x3+","+y2+" "+x4+","+y3+" "+x5+","+y1+" L"+x10+","+y4+" C"+x8+","+y6+" "+x7+","+y5+" "+x6+","+y4+" z"}result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"ellipseRibbon":case"ellipseRibbon2":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=5e4*slideFactor,adj3=12500*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var d_val,a1,a2,q10,q11,q12,minAdj3,a3,dx2,x2,x3,x4,x5,x6,dy1,f1,q1,q2,cx1,cx2,q1,dy3,q3,q4,q5,rh,q8,cx4,q9,cx5,cnstVal1=25e3*slideFactor,cnstVal3=75e3*slideFactor,cnstVal4=1e5*slideFactor,cnstVal5=2e5*slideFactor,hc=w/2,t=0,l=0,b=h,r=w,wd8=w/8;if(a1=0>adj1?0:adj1>cnstVal4?cnstVal4:adj1,a2=cnstVal1>adj2?cnstVal1:adj2>cnstVal3?cnstVal3:adj2,q10=cnstVal4-a1,q11=q10/2,q12=a1-q11,minAdj3=0>q12?0:q12,a3=minAdj3>adj3?minAdj3:adj3>a1?a1:adj3,dx2=w*a2/cnstVal5,x2=hc-dx2,x3=x2+wd8,x4=r-x3,x5=r-x2,x6=r-wd8,dy1=h*a3/cnstVal4,f1=4*dy1/w,q1=x3*x3/w,q2=x3-q1,cx1=x3/2,cx2=r-cx1,q1=h*a1/cnstVal4,dy3=q1-dy1,q3=x2*x2/w,q4=x2-q3,q5=f1*q4,rh=b-q1,q8=14*dy1/16,cx4=x2/2,q9=f1*cx4,cx5=r-cx4,"ellipseRibbon"==shapType){var y1,cy1,y3,q6,q7,cy3,y2,y5,y6,cy4,cy6,y7,cy7,y8;y1=f1*q2,cy1=f1*cx1,y3=q5+dy3,q6=dy1+dy3-y3,q7=q6+dy1,cy3=q7+dy3,y2=(q8+rh)/2,y5=q5+rh,y6=y3+rh,cy4=q9+rh,cy6=cy3+rh,y7=y1+dy3,cy7=q1+q1-y7,y8=b-dy1,d_val="M"+l+","+t+" Q"+cx1+","+cy1+" "+x3+","+y1+" L"+x2+","+y3+" Q"+hc+","+cy3+" "+x5+","+y3+" L"+x4+","+y1+" Q"+cx2+","+cy1+" "+r+","+t+" L"+x6+","+y2+" L"+r+","+rh+" Q"+cx5+","+cy4+" "+x5+","+y5+" L"+x5+","+y6+" Q"+hc+","+cy6+" "+x2+","+y6+" L"+x2+","+y5+" Q"+cx4+","+cy4+" "+l+","+rh+" L"+wd8+","+y2+" zM"+x2+","+y5+" L"+x2+","+y3+"M"+x5+","+y3+" L"+x5+","+y5+"M"+x3+","+y1+" L"+x3+","+y7+"M"+x4+","+y7+" L"+x4+","+y1}else if("ellipseRibbon2"==shapType){var u1,y1,cu1,cy1,q3,q5,u3,y3,q6,q7,cu3,cy3,rh,q8,u2,y2,u5,y5,u6,y6,cu4,cy4,cu6,cy6,u7,y7,cu7,cy7;u1=f1*q2,y1=b-u1,cu1=f1*cx1,cy1=b-cu1,u3=q5+dy3,y3=b-u3,q6=dy1+dy3-u3,q7=q6+dy1,cu3=q7+dy3,cy3=b-cu3,u2=(q8+rh)/2,y2=b-u2,u5=q5+rh,y5=b-u5,u6=u3+rh,y6=b-u6,cu4=q9+rh,cy4=b-cu4,cu6=cu3+rh,cy6=b-cu6,u7=u1+dy3,y7=b-u7,cu7=q1+q1-u7,cy7=b-cu7,d_val="M"+l+","+b+" L"+wd8+","+y2+" L"+l+","+q1+" Q"+cx4+","+cy4+" "+x2+","+y5+" L"+x2+","+y6+" Q"+hc+","+cy6+" "+x5+","+y6+" L"+x5+","+y5+" Q"+cx5+","+cy4+" "+r+","+q1+" L"+x6+","+y2+" L"+r+","+b+" Q"+cx2+","+cy1+" "+x4+","+y1+" L"+x5+","+y3+" Q"+hc+","+cy3+" "+x2+","+y3+" L"+x3+","+y1+" Q"+cx1+","+cy1+" "+l+","+b+" zM"+x2+","+y3+" L"+x2+","+y5+"M"+x5+","+y5+" L"+x5+","+y3+"M"+x3+","+y7+" L"+x3+","+y1+"M"+x4+","+y1+" L"+x4+","+y7}result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"line":case"straightConnector1":case"bentConnector4":case"bentConnector5":case"curvedConnector2":case"curvedConnector3":case"curvedConnector4":case"curvedConnector5":result+="<line x1='0' y1='0' x2='"+w+"' y2='"+h+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' ",void 0===headEndNodeAttrs||"triangle"!==headEndNodeAttrs.type&&"arrow"!==headEndNodeAttrs.type||(result+="marker-start='url(#markerTriangle_"+shpId+")' "),void 0===tailEndNodeAttrs||"triangle"!==tailEndNodeAttrs.type&&"arrow"!==tailEndNodeAttrs.type||(result+="marker-end='url(#markerTriangle_"+shpId+")' "),result+="/>";break;case"rightArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=.25,sAdj2_val=.5,max_sAdj2_const=w/h;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);if("adj1"==sAdj_name)sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=.5-parseInt(sAdj1.substr(4))/2e5;else if("adj2"==sAdj_name){sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]);var sAdj2_val2=parseInt(sAdj2.substr(4))/1e5;sAdj2_val=1-sAdj2_val2/max_sAdj2_const}}result+=" <polygon points='"+w+" "+h/2+","+sAdj2_val*w+" 0,"+sAdj2_val*w+" "+sAdj1_val*h+",0 "+sAdj1_val*h+",0 "+(1-sAdj1_val)*h+","+sAdj2_val*w+" "+(1-sAdj1_val)*h+", "+sAdj2_val*w+" "+h+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=.25,sAdj2_val=.5,max_sAdj2_const=w/h;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);if("adj1"==sAdj_name)sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=.5-parseInt(sAdj1.substr(4))/2e5;else if("adj2"==sAdj_name){sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]);var sAdj2_val2=parseInt(sAdj2.substr(4))/1e5;sAdj2_val=sAdj2_val2/max_sAdj2_const}}result+=" <polygon points='0 "+h/2+","+sAdj2_val*w+" "+h+","+sAdj2_val*w+" "+(1-sAdj1_val)*h+","+w+" "+(1-sAdj1_val)*h+","+w+" "+sAdj1_val*h+","+sAdj2_val*w+" "+sAdj1_val*h+", "+sAdj2_val*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"downArrow":case"flowChartOffpageConnector":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=.25,sAdj2_val=.5,max_sAdj2_const=h/w;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);if("adj1"==sAdj_name)sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=parseInt(sAdj1.substr(4))/2e5;else if("adj2"==sAdj_name){sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]);var sAdj2_val2=parseInt(sAdj2.substr(4))/1e5;sAdj2_val=sAdj2_val2/max_sAdj2_const}}"flowChartOffpageConnector"==shapType&&(sAdj1_val=.5,sAdj2_val=.212),result+=" <polygon points='"+(.5-sAdj1_val)*w+" 0,"+(.5-sAdj1_val)*w+" "+(1-sAdj2_val)*h+",0 "+(1-sAdj2_val)*h+","+w/2+" "+h+","+w+" "+(1-sAdj2_val)*h+","+(.5+sAdj1_val)*w+" "+(1-sAdj2_val)*h+", "+(.5+sAdj1_val)*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";
break;case"upArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=.25,sAdj2_val=.5,max_sAdj2_const=h/w;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);if("adj1"==sAdj_name)sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=parseInt(sAdj1.substr(4))/2e5;else if("adj2"==sAdj_name){sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]);var sAdj2_val2=parseInt(sAdj2.substr(4))/1e5;sAdj2_val=sAdj2_val2/max_sAdj2_const}}result+=" <polygon points='"+w/2+" 0,0 "+sAdj2_val*h+","+(.5-sAdj1_val)*w+" "+sAdj2_val*h+","+(.5-sAdj1_val)*w+" "+h+","+(.5+sAdj1_val)*w+" "+h+","+(.5+sAdj1_val)*w+" "+sAdj2_val*h+", "+w+" "+sAdj2_val*h+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftRightArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=.25,sAdj2_val=.25,max_sAdj2_const=w/h;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);if("adj1"==sAdj_name)sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=.5-parseInt(sAdj1.substr(4))/2e5;else if("adj2"==sAdj_name){sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]);var sAdj2_val2=parseInt(sAdj2.substr(4))/1e5;sAdj2_val=sAdj2_val2/max_sAdj2_const}}result+=" <polygon points='0 "+h/2+","+sAdj2_val*w+" "+h+","+sAdj2_val*w+" "+(1-sAdj1_val)*h+","+(1-sAdj2_val)*w+" "+(1-sAdj1_val)*h+","+(1-sAdj2_val)*w+" "+h+","+w+" "+h/2+", "+(1-sAdj2_val)*w+" 0,"+(1-sAdj2_val)*w+" "+sAdj1_val*h+","+sAdj2_val*w+" "+sAdj1_val*h+","+sAdj2_val*w+" 0' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"upDownArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),sAdj1_val=.25,sAdj2_val=.25,max_sAdj2_const=h/w;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);if("adj1"==sAdj_name)sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),sAdj1_val=.5-parseInt(sAdj1.substr(4))/2e5;else if("adj2"==sAdj_name){sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]);var sAdj2_val2=parseInt(sAdj2.substr(4))/1e5;sAdj2_val=sAdj2_val2/max_sAdj2_const}}result+=" <polygon points='"+w/2+" 0,0 "+sAdj2_val*h+","+sAdj1_val*w+" "+sAdj2_val*h+","+sAdj1_val*w+" "+(1-sAdj2_val)*h+",0 "+(1-sAdj2_val)*h+","+w/2+" "+h+", "+w+" "+(1-sAdj2_val)*h+","+(1-sAdj1_val)*w+" "+(1-sAdj2_val)*h+","+(1-sAdj1_val)*w+" "+sAdj2_val*h+","+w+" "+sAdj2_val*h+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"quadArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=22500*slideFactor,adj2=22500*slideFactor,adj3=22500*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var a1,a2,a3,q1,x1,x2,dx2,x3,dx3,x4,x5,x6,y2,y3,y4,y5,y6,maxAdj1,maxAdj3,vc=h/2,hc=w/2,minWH=Math.min(w,h);a2=0>adj2?0:adj2>cnstVal1?cnstVal1:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,q1=cnstVal2-maxAdj1,maxAdj3=q1/2,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,x1=minWH*a3/cnstVal2,dx2=minWH*a2/cnstVal2,x2=hc-dx2,x5=hc+dx2,dx3=minWH*a1/cnstVal3,x3=hc-dx3,x4=hc+dx3,x6=w-x1,y2=vc-dx2,y5=vc+dx2,y3=vc-dx3,y4=vc+dx3,y6=h-x1;var d_val="M0,"+vc+" L"+x1+","+y2+" L"+x1+","+y3+" L"+x3+","+y3+" L"+x3+","+x1+" L"+x2+","+x1+" L"+hc+",0 L"+x5+","+x1+" L"+x4+","+x1+" L"+x4+","+y3+" L"+x6+","+y3+" L"+x6+","+y2+" L"+w+","+vc+" L"+x6+","+y5+" L"+x6+","+y4+" L"+x4+","+y4+" L"+x4+","+y6+" L"+x5+","+y6+" L"+hc+","+h+" L"+x2+","+y6+" L"+x3+","+y6+" L"+x3+","+y4+" L"+x1+","+y4+" L"+x1+","+y5+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftRightUpArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var a1,a2,a3,q1,x1,x2,dx2,x3,dx3,x4,x5,x6,y2,dy2,y3,y4,y5,maxAdj1,maxAdj3,vc=h/2,hc=w/2,minWH=Math.min(w,h);a2=0>adj2?0:adj2>cnstVal1?cnstVal1:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,q1=cnstVal2-maxAdj1,maxAdj3=q1/2,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,x1=minWH*a3/cnstVal2,dx2=minWH*a2/cnstVal2,x2=hc-dx2,x5=hc+dx2,dx3=minWH*a1/cnstVal3,x3=hc-dx3,x4=hc+dx3,x6=w-x1,dy2=minWH*a2/cnstVal1,y2=h-dy2,y4=h-dx2,y3=y4-dx3,y5=y4+dx3;var d_val="M0,"+y4+" L"+x1+","+y2+" L"+x1+","+y3+" L"+x3+","+y3+" L"+x3+","+x1+" L"+x2+","+x1+" L"+hc+",0 L"+x5+","+x1+" L"+x4+","+x1+" L"+x4+","+y3+" L"+x6+","+y3+" L"+x6+","+y2+" L"+w+","+y4+" L"+x6+","+h+" L"+x6+","+y5+" L"+x1+","+y5+" L"+x1+","+h+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftUpArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var a1,a2,a3,x1,x2,dx4,dx3,x3,x4,x5,y2,y3,y4,y5,maxAdj1,maxAdj3,vc=h/2,hc=w/2,minWH=Math.min(w,h);a2=0>adj2?0:adj2>cnstVal1?cnstVal1:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,maxAdj3=cnstVal2-maxAdj1,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,x1=minWH*a3/cnstVal2,dx2=minWH*a2/cnstVal1,x2=w-dx2,y2=h-dx2,dx4=minWH*a2/cnstVal2,x4=w-dx4,y4=h-dx4,dx3=minWH*a1/cnstVal3,x3=x4-dx3,x5=x4+dx3,y3=y4-dx3,y5=y4+dx3;var d_val="M0,"+y4+" L"+x1+","+y2+" L"+x1+","+y3+" L"+x3+","+y3+" L"+x3+","+x1+" L"+x2+","+x1+" L"+x4+",0 L"+w+","+x1+" L"+x5+","+x1+" L"+x5+","+y5+" L"+x1+","+y5+" L"+x1+","+h+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"bentUpArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var a1,a2,a3,dx1,x1,dx2,x2,dx3,x3,x4,y1,y2,dy2,vc=h/2,hc=w/2,minWH=Math.min(w,h);a1=0>adj1?0:adj1>cnstVal1?cnstVal1:adj1,a2=0>adj2?0:adj2>cnstVal1?cnstVal1:adj2,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,y1=minWH*a3/cnstVal2,dx1=minWH*a2/cnstVal1,x1=w-dx1,dx3=minWH*a2/cnstVal2,x3=w-dx3,dx2=minWH*a1/cnstVal3,x2=x3-dx2,x4=x3+dx2,dy2=minWH*a1/cnstVal2,y2=h-dy2;var d_val="M0,"+y2+" L"+x2+","+y2+" L"+x2+","+y1+" L"+x1+","+y1+" L"+x3+",0 L"+w+","+y1+" L"+x4+","+y1+" L"+x4+","+h+" L0,"+h+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"bentArrow":var sAdj1,sAdj2,sAdj3,sAdj4,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,adj4=43750*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name&&(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor)}var a1,a2,a3,a4,x3,x4,y3,y4,y5,y6,maxAdj1,maxAdj4,minWH=Math.min(w,h);a2=0>adj2?0:adj2>cnstVal1?cnstVal1:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,a3=0>adj3?0:adj3>cnstVal1?cnstVal1:adj3;var th,aw2,th2,dh2,ah,bw,bh,bs,bd,bd3,bd2,th=minWH*a1/cnstVal2;aw2=minWH*a2/cnstVal2,th2=th/2,dh2=aw2-th2,ah=minWH*a3/cnstVal2,bw=w-ah,bh=h-dh2,bs=bh>bw?bw:bh,maxAdj4=cnstVal2*bs/minWH,a4=0>adj4?0:adj4>maxAdj4?maxAdj4:adj4,bd=minWH*a4/cnstVal2,bd3=bd-th,bd2=bd3>0?bd3:0,x3=th+bd2,x4=w-ah,y3=dh2+th,y4=y3+dh2,y5=dh2+bd,y6=y3+bd2;var d_val="M0,"+h+" L0,"+y5+shapeArc(bd,y5,bd,bd,180,270,!1).replace("M","L")+" L"+x4+","+dh2+" L"+x4+",0 L"+w+","+aw2+" L"+x4+","+y4+" L"+x4+","+y3+" L"+x3+","+y3+shapeArc(x3,y6,bd2,bd2,270,180,!1).replace("M","L")+" L"+th+","+h+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"uturnArrow":var sAdj1,sAdj2,sAdj3,sAdj4,sAdj5,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,adj4=43750*slideFactor,adj5=75e3*slideFactor,cnstVal1=25e3*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name?(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor):"adj5"==sAdj_name&&(sAdj5=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj5=parseInt(sAdj5.substr(4))*slideFactor)}var a1,a2,a3,a4,a5,q1,q2,q3,x3,x4,x5,x6,x7,x8,x9,y4,y5,minAdj5,maxAdj1,maxAdj3,maxAdj4,minWH=Math.min(w,h);a2=0>adj2?0:adj2>cnstVal1?cnstVal1:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,q2=a1*minWH/h,q3=cnstVal2-q2,maxAdj3=q3*h/minWH,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,q1=a3+a1,minAdj5=q1*minWH/h,a5=minAdj5>adj5?minAdj5:adj5>cnstVal2?cnstVal2:adj5;var th,aw2,th2,dh2,ah,bw,bs,bd,bd3,bd2,th=minWH*a1/cnstVal2;aw2=minWH*a2/cnstVal2,th2=th/2,dh2=aw2-th2,y5=h*a5/cnstVal2,ah=minWH*a3/cnstVal2,y4=y5-ah,x9=w-dh2,bw=x9/2,bs=y4>bw?bw:y4,maxAdj4=cnstVal2*bs/minWH,a4=0>adj4?0:adj4>maxAdj4?maxAdj4:adj4,bd=minWH*a4/cnstVal2,bd3=bd-th,bd2=bd3>0?bd3:0,x3=th+bd2,x8=w-aw2,x6=x8-aw2,x7=x6+dh2,x4=x9-bd,x5=x7-bd2,cx=(th+x7)/2;var d_val="M0,"+h+" L0,"+bd+shapeArc(bd,bd,bd,bd,180,270,!1).replace("M","L")+" L"+x4+",0"+shapeArc(x4,bd,bd,bd,270,360,!1).replace("M","L")+" L"+x9+","+y4+" L"+w+","+y4+" L"+x8+","+y5+" L"+x6+","+y4+" L"+x7+","+y4+" L"+x7+","+x3+shapeArc(x5,x3,bd2,bd2,0,-90,!1).replace("M","L")+" L"+x3+","+th+shapeArc(x3,x3,bd2,bd2,270,180,!1).replace("M","L")+" L"+th+","+h+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"stripedRightArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=5e4*slideFactor,adj2=5e4*slideFactor,cnstVal1=1e5*slideFactor,cnstVal2=2e5*slideFactor,cnstVal3=84375*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor)}var a1,a2,x4,x5,dx5,x6,dx6,y1,dy1,y2,maxAdj2,vc=h/2,minWH=Math.min(w,h);maxAdj2=cnstVal3*w/minWH,a1=0>adj1?0:adj1>cnstVal1?cnstVal1:adj1,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,x4=5*minWH/32,dx5=minWH*a2/cnstVal1,x5=w-dx5,dy1=h*a1/cnstVal2,y1=vc-dy1,y2=vc+dy1;var ssd8=minWH/8,ssd16=minWH/16,ssd32=minWH/32,d_val="M0,"+y1+" L"+ssd32+","+y1+" L"+ssd32+","+y2+" L0,"+y2+" z M"+ssd16+","+y1+" L"+ssd8+","+y1+" L"+ssd8+","+y2+" L"+ssd16+","+y2+" z M"+x4+","+y1+" L"+x5+","+y1+" L"+x5+",0 L"+w+","+vc+" L"+x5+","+h+" L"+x5+","+y2+" L"+x4+","+y2+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"notchedRightArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=5e4*slideFactor,adj2=5e4*slideFactor,cnstVal1=1e5*slideFactor,cnstVal2=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor)}var a1,a2,x1,x2,dx2,y1,dy1,y2,maxAdj2,vc=h/2,hd2=vc,minWH=Math.min(w,h);maxAdj2=cnstVal1*w/minWH,a1=0>adj1?0:adj1>cnstVal1?cnstVal1:adj1,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,dx2=minWH*a2/cnstVal1,x2=w-dx2,dy1=h*a1/cnstVal2,y1=vc-dy1,y2=vc+dy1,x1=dy1*dx2/hd2;var d_val="M0,"+y1+" L"+x2+","+y1+" L"+x2+",0 L"+w+","+vc+" L"+x2+","+h+" L"+x2+","+y2+" L0,"+y2+" L"+x1+","+vc+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"homePlate":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=5e4*slideFactor,cnstVal1=1e5*slideFactor;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,x1,dx1,maxAdj,vc=h/2,minWH=Math.min(w,h);maxAdj=cnstVal1*w/minWH,a=0>adj?0:adj>maxAdj?maxAdj:adj,dx1=minWH*a/cnstVal1,x1=w-dx1;var d_val="M0,0 L"+x1+",0 L"+w+","+vc+" L"+x1+","+h+" L0,"+h+" z";result+="<path  d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"chevron":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=5e4*slideFactor,cnstVal1=1e5*slideFactor;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var a,x1,dx1,x2,maxAdj,vc=h/2,minWH=Math.min(w,h);maxAdj=cnstVal1*w/minWH,a=0>adj?0:adj>maxAdj?maxAdj:adj,x1=minWH*a/cnstVal1,x2=w-x1;var d_val="M0,0 L"+x2+",0 L"+w+","+vc+" L"+x2+","+h+" L0,"+h+" L"+x1+","+vc+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"rightArrowCallout":var sAdj1,sAdj2,sAdj3,sAdj4,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,adj4=64977*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name&&(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor)}var maxAdj2,a2,maxAdj1,a1,maxAdj3,a3,q2,maxAdj4,a4,dy1,dy2,y1,y2,y3,y4,dx3,x3,x2,x1,vc=h/2,r=w,b=h,l=0,t=0,ss=Math.min(w,h);maxAdj2=cnstVal1*h/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,maxAdj3=cnstVal2*w/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,q2=a3*ss/w,maxAdj4=cnstVal-q2,a4=0>adj4?0:adj4>maxAdj4?maxAdj4:adj4,dy1=ss*a2/cnstVal2,dy2=ss*a1/cnstVal3,y1=vc-dy1,y2=vc-dy2,y3=vc+dy2,y4=vc+dy1,dx3=ss*a3/cnstVal2,x3=r-dx3,x2=w*a4/cnstVal2,x1=x2/2;var d_val="M"+l+","+t+" L"+x2+","+t+" L"+x2+","+y2+" L"+x3+","+y2+" L"+x3+","+y1+" L"+r+","+vc+" L"+x3+","+y4+" L"+x3+","+y3+" L"+x2+","+y3+" L"+x2+","+b+" L"+l+","+b+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"downArrowCallout":var sAdj1,sAdj2,sAdj3,sAdj4,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,adj4=64977*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name&&(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor)}var maxAdj2,a2,maxAdj1,a1,maxAdj3,a3,q2,maxAdj4,a4,dx1,dx2,x1,x2,x3,x4,dy3,y3,y2,y1,hc=w/2,r=w,b=h,l=0,t=0,ss=Math.min(w,h);maxAdj2=cnstVal1*w/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,maxAdj3=cnstVal2*h/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,q2=a3*ss/h,maxAdj4=cnstVal2-q2,a4=0>adj4?0:adj4>maxAdj4?maxAdj4:adj4,dx1=ss*a2/cnstVal2,dx2=ss*a1/cnstVal3,x1=hc-dx1,x2=hc-dx2,x3=hc+dx2,x4=hc+dx1,dy3=ss*a3/cnstVal2,y3=b-dy3,y2=h*a4/cnstVal2,y1=y2/2;var d_val="M"+l+","+t+" L"+r+","+t+" L"+r+","+y2+" L"+x3+","+y2+" L"+x3+","+y3+" L"+x4+","+y3+" L"+hc+","+b+" L"+x1+","+y3+" L"+x2+","+y3+" L"+x2+","+y2+" L"+l+","+y2+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftArrowCallout":var sAdj1,sAdj2,sAdj3,sAdj4,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,adj4=64977*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name&&(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor)}var maxAdj2,a2,maxAdj1,a1,maxAdj3,a3,q2,maxAdj4,a4,dy1,dy2,y1,y2,y3,y4,x1,dx2,x2,x3,vc=h/2,r=w,b=h,l=0,t=0,ss=Math.min(w,h);maxAdj2=cnstVal1*h/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,maxAdj3=cnstVal2*w/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,q2=a3*ss/w,maxAdj4=cnstVal2-q2,a4=0>adj4?0:adj4>maxAdj4?maxAdj4:adj4,dy1=ss*a2/cnstVal2,dy2=ss*a1/cnstVal3,y1=vc-dy1,y2=vc-dy2,y3=vc+dy2,y4=vc+dy1,x1=ss*a3/cnstVal2,dx2=w*a4/cnstVal2,x2=r-dx2,x3=(x2+r)/2;var d_val="M"+l+","+vc+" L"+x1+","+y1+" L"+x1+","+y2+" L"+x2+","+y2+" L"+x2+","+t+" L"+r+","+t+" L"+r+","+b+" L"+x2+","+b+" L"+x2+","+y3+" L"+x1+","+y3+" L"+x1+","+y4+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"upArrowCallout":var sAdj1,sAdj2,sAdj3,sAdj4,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,adj4=64977*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name&&(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor)}var maxAdj2,a2,maxAdj1,a1,maxAdj3,a3,q2,maxAdj4,a4,dx1,dx2,x1,x2,x3,x4,y1,dy2,y2,y3,hc=w/2,r=w,b=h,l=0,t=0,ss=Math.min(w,h);maxAdj2=cnstVal1*w/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,maxAdj3=cnstVal2*h/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,q2=a3*ss/h,maxAdj4=cnstVal2-q2,a4=0>adj4?0:adj4>maxAdj4?maxAdj4:adj4,dx1=ss*a2/cnstVal2,dx2=ss*a1/cnstVal3,x1=hc-dx1,x2=hc-dx2,x3=hc+dx2,x4=hc+dx1,y1=ss*a3/cnstVal2,dy2=h*a4/cnstVal2,y2=b-dy2,y3=(y2+b)/2;var d_val="M"+l+","+y2+" L"+x2+","+y2+" L"+x2+","+y1+" L"+x1+","+y1+" L"+hc+","+t+" L"+x4+","+y1+" L"+x3+","+y1+" L"+x3+","+y2+" L"+r+","+y2+" L"+r+","+b+" L"+l+","+b+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftRightArrowCallout":var sAdj1,sAdj2,sAdj3,sAdj4,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=25e3*slideFactor,adj3=25e3*slideFactor,adj4=48123*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name&&(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor)}var maxAdj2,a2,maxAdj1,a1,maxAdj3,a3,q2,maxAdj4,a4,dy1,dy2,y1,y2,y3,y4,x1,x4,dx2,x2,x3,vc=h/2,hc=w/2,r=w,b=h,l=0,t=0,ss=Math.min(w,h);maxAdj2=cnstVal1*h/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,maxAdj3=cnstVal1*w/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,q2=a3*ss/wd2,maxAdj4=cnstVal2-q2,a4=0>adj4?0:adj4>maxAdj4?maxAdj4:adj4,dy1=ss*a2/cnstVal2,dy2=ss*a1/cnstVal3,y1=vc-dy1,y2=vc-dy2,y3=vc+dy2,y4=vc+dy1,x1=ss*a3/cnstVal2,x4=r-x1,dx2=w*a4/cnstVal3,x2=hc-dx2,x3=hc+dx2;var d_val="M"+l+","+vc+" L"+x1+","+y1+" L"+x1+","+y2+" L"+x2+","+y2+" L"+x2+","+t+" L"+x3+","+t+" L"+x3+","+y2+" L"+x4+","+y2+" L"+x4+","+y1+" L"+r+","+vc+" L"+x4+","+y4+" L"+x4+","+y3+" L"+x3+","+y3+" L"+x3+","+b+" L"+x2+","+b+" L"+x2+","+y3+" L"+x1+","+y3+" L"+x1+","+y4+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"quadArrowCallout":var sAdj1,sAdj2,sAdj3,sAdj4,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=18515*slideFactor,adj2=18515*slideFactor,adj3=18515*slideFactor,adj4=48123*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor):"adj4"==sAdj_name&&(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))*slideFactor)}var a2,maxAdj1,a1,maxAdj3,a3,q2,maxAdj4,a4,dx2,dx3,ah,dx1,dy1,x8,x2,x7,x3,x6,x4,x5,y8,y2,y7,y3,y6,y4,y5,vc=h/2,hc=w/2,r=w,b=h,l=0,t=0,ss=Math.min(w,h);a2=0>adj2?0:adj2>cnstVal1?cnstVal1:adj2,maxAdj1=2*a2,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,maxAdj3=cnstVal1-a2,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,q2=2*a3,maxAdj4=cnstVal2-q2,a4=a1>adj4?a1:adj4>maxAdj4?maxAdj4:adj4,dx2=ss*a2/cnstVal2,dx3=ss*a1/cnstVal3,ah=ss*a3/cnstVal2,dx1=w*a4/cnstVal3,dy1=h*a4/cnstVal3,x8=r-ah,x2=hc-dx1,x7=hc+dx1,x3=hc-dx2,x6=hc+dx2,x4=hc-dx3,x5=hc+dx3,y8=b-ah,y2=vc-dy1,y7=vc+dy1,y3=vc-dx2,y6=vc+dx2,y4=vc-dx3,y5=vc+dx3;var d_val="M"+l+","+vc+" L"+ah+","+y3+" L"+ah+","+y4+" L"+x2+","+y4+" L"+x2+","+y2+" L"+x4+","+y2+" L"+x4+","+ah+" L"+x3+","+ah+" L"+hc+","+t+" L"+x6+","+ah+" L"+x5+","+ah+" L"+x5+","+y2+" L"+x7+","+y2+" L"+x7+","+y4+" L"+x8+","+y4+" L"+x8+","+y3+" L"+r+","+vc+" L"+x8+","+y6+" L"+x8+","+y5+" L"+x7+","+y5+" L"+x7+","+y7+" L"+x5+","+y7+" L"+x5+","+y8+" L"+x6+","+y8+" L"+hc+","+b+" L"+x3+","+y8+" L"+x4+","+y8+" L"+x4+","+y7+" L"+x2+","+y7+" L"+x2+","+y5+" L"+ah+","+y5+" L"+ah+","+y6+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"curvedDownArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=5e4*slideFactor,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var maxAdj2,a2,a1,th,aw,q1,wR,q7,q8,q9,q10,q11,idy,maxAdj3,a3,ah,x3,q2,q3,q4,q5,dx,x5,x7,q6,dh,x4,x8,aw2,x6,y1,swAng,mswAng,iy,ix,q12,dang2,stAng,stAng2,swAng2,swAng3,vc=h/2,hc=w/2,wd2=w/2,r=w,b=h,l=0,t=0,c3d4=270,cd2=180,cd4=90,ss=Math.min(w,h);maxAdj2=cnstVal1*w/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,a1=0>adj1?0:adj1>cnstVal2?cnstVal2:adj1,th=ss*a1/cnstVal2,aw=ss*a2/cnstVal2,q1=(th+aw)/4,wR=wd2-q1,q7=2*wR,q8=q7*q7,q9=th*th,q10=q8-q9,q11=Math.sqrt(q10),idy=q11*h/q7,maxAdj3=cnstVal2*idy/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,ah=ss*adj3/cnstVal2,x3=wR+th,q2=h*h,q3=ah*ah,q4=q2-q3,q5=Math.sqrt(q4),dx=q5*wR/h,x5=wR+dx,x7=x3+dx,q6=aw-th,dh=q6/2,x4=x5-dh,x8=x7+dh,aw2=aw/2,x6=r-aw2,y1=b-ah,swAng=Math.atan(dx/ah);var swAngDeg=180*swAng/Math.PI;mswAng=-swAngDeg,iy=b-idy,ix=(wR+x3)/2,q12=th/2,dang2=Math.atan(q12/idy);var dang2Deg=180*dang2/Math.PI;stAng=c3d4+swAngDeg,stAng2=c3d4-dang2Deg,swAng2=dang2Deg-cd4,swAng3=cd4+dang2Deg;var d_val="M"+x6+","+b+" L"+x4+","+y1+" L"+x5+","+y1+shapeArc(wR,h,wR,h,stAng,stAng+mswAng,!1).replace("M","L")+" L"+x3+","+t+shapeArc(x3,h,wR,h,c3d4,c3d4+swAngDeg,!1).replace("M","L")+" L"+(x5+th)+","+y1+" L"+x8+","+y1+" zM"+x3+","+t+shapeArc(x3,h,wR,h,stAng2,stAng2+swAng2,!1).replace("M","L")+shapeArc(wR,h,wR,h,cd2,cd2+swAng3,!1).replace("M","L");result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"curvedLeftArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=5e4*slideFactor,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){
var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var maxAdj2,a2,a1,th,aw,q1,hR,q7,q8,q9,q10,q11,iDx,maxAdj3,a3,ah,y3,q2,q3,q4,q5,dy,y5,y7,q6,dh,y4,y8,aw2,y6,x1,swAng,mswAng,ix,iy,q12,dang2,swAng2,swAng3,stAng3,vc=h/2,hc=w/2,hd2=h/2,r=w,b=h,l=0,t=0,c3d4=270,cd2=180,cd4=90,ss=Math.min(w,h);maxAdj2=cnstVal1*h/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,a1=0>adj1?0:adj1>a2?a2:adj1,th=ss*a1/cnstVal2,aw=ss*a2/cnstVal2,q1=(th+aw)/4,hR=hd2-q1,q7=2*hR,q8=q7*q7,q9=th*th,q10=q8-q9,q11=Math.sqrt(q10),iDx=q11*w/q7,maxAdj3=cnstVal2*iDx/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,ah=ss*a3/cnstVal2,y3=hR+th,q2=w*w,q3=ah*ah,q4=q2-q3,q5=Math.sqrt(q4),dy=q5*hR/w,y5=hR+dy,y7=y3+dy,q6=aw-th,dh=q6/2,y4=y5-dh,y8=y7+dh,aw2=aw/2,y6=b-aw2,x1=l+ah,swAng=Math.atan(dy/ah),mswAng=-swAng,ix=l+iDx,iy=(hR+y3)/2,q12=th/2,dang2=Math.atan(q12/iDx),swAng2=dang2-swAng,swAng3=swAng+dang2,stAng3=-dang2;var swAngDg,swAng2Dg,swAng3Dg,stAng3dg;swAngDg=180*swAng/Math.PI,swAng2Dg=180*swAng2/Math.PI,swAng3Dg=180*swAng3/Math.PI,stAng3dg=180*stAng3/Math.PI;var d_val="M"+r+","+y3+shapeArc(l,hR,w,hR,0,-cd4,!1).replace("M","L")+" L"+l+","+t+shapeArc(l,y3,w,hR,c3d4,c3d4+cd4,!1).replace("M","L")+" L"+r+","+y3+shapeArc(l,y3,w,hR,0,swAngDg,!1).replace("M","L")+" L"+x1+","+y7+" L"+x1+","+y8+" L"+l+","+y6+" L"+x1+","+y4+" L"+x1+","+y5+shapeArc(l,hR,w,hR,swAngDg,swAngDg+swAng2Dg,!1).replace("M","L")+shapeArc(l,hR,w,hR,0,-cd4,!1).replace("M","L")+shapeArc(l,y3,w,hR,c3d4,c3d4+cd4,!1).replace("M","L");result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"curvedRightArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=5e4*slideFactor,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var maxAdj2,a2,a1,th,aw,q1,hR,q7,q8,q9,q10,q11,iDx,maxAdj3,a3,ah,y3,q2,q3,q4,q5,dy,y5,y7,q6,dh,y4,y8,aw2,y6,x1,swAng,stAng,mswAng,ix,iy,q12,dang2,swAng2,swAng3,stAng3,vc=h/2,hc=w/2,hd2=h/2,r=w,b=h,l=0,t=0,c3d4=270,cd2=180,cd4=90,ss=Math.min(w,h);maxAdj2=cnstVal1*h/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,a1=0>adj1?0:adj1>a2?a2:adj1,th=ss*a1/cnstVal2,aw=ss*a2/cnstVal2,q1=(th+aw)/4,hR=hd2-q1,q7=2*hR,q8=q7*q7,q9=th*th,q10=q8-q9,q11=Math.sqrt(q10),iDx=q11*w/q7,maxAdj3=cnstVal2*iDx/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,ah=ss*a3/cnstVal2,y3=hR+th,q2=w*w,q3=ah*ah,q4=q2-q3,q5=Math.sqrt(q4),dy=q5*hR/w,y5=hR+dy,y7=y3+dy,q6=aw-th,dh=q6/2,y4=y5-dh,y8=y7+dh,aw2=aw/2,y6=b-aw2,x1=r-ah,swAng=Math.atan(dy/ah),stAng=Math.PI+0-swAng,mswAng=-swAng,ix=r-iDx,iy=(hR+y3)/2,q12=th/2,dang2=Math.atan(q12/iDx),swAng2=dang2-Math.PI/2,swAng3=Math.PI/2+dang2,stAng3=Math.PI-dang2;var stAngDg,mswAngDg,swAngDg,swAng2dg;stAngDg=180*stAng/Math.PI,mswAngDg=180*mswAng/Math.PI,swAngDg=180*swAng/Math.PI,swAng2dg=180*swAng2/Math.PI;var d_val="M"+l+","+hR+shapeArc(w,hR,w,hR,cd2,cd2+mswAngDg,!1).replace("M","L")+" L"+x1+","+y5+" L"+x1+","+y4+" L"+r+","+y6+" L"+x1+","+y8+" L"+x1+","+y7+shapeArc(w,y3,w,hR,stAngDg,stAngDg+swAngDg,!1).replace("M","L")+" L"+l+","+hR+shapeArc(w,hR,w,hR,cd2,cd2+cd4,!1).replace("M","L")+" L"+r+","+th+shapeArc(w,y3,w,hR,c3d4,c3d4+swAng2dg,!1).replace("M","L");result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"curvedUpArrow":var sAdj1,sAdj2,sAdj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=25e3*slideFactor,adj2=5e4*slideFactor,adj3=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*slideFactor):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))*slideFactor)}var maxAdj2,a2,a1,th,aw,q1,wR,q7,q8,q9,q10,q11,idy,maxAdj3,a3,ah,x3,q2,q3,q4,q5,dx,x5,x7,q6,dh,x4,x8,aw2,x6,y1,swAng,mswAng,iy,ix,q12,dang2,swAng2,mswAng2,stAng3,swAng3,stAng2,vc=h/2,hc=w/2,wd2=w/2,r=w,b=h,l=0,t=0,c3d4=270,cd2=180,cd4=90,ss=Math.min(w,h);maxAdj2=cnstVal1*w/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,a1=0>adj1?0:adj1>cnstVal2?cnstVal2:adj1,th=ss*a1/cnstVal2,aw=ss*a2/cnstVal2,q1=(th+aw)/4,wR=wd2-q1,q7=2*wR,q8=q7*q7,q9=th*th,q10=q8-q9,q11=Math.sqrt(q10),idy=q11*h/q7,maxAdj3=cnstVal2*idy/ss,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,ah=ss*adj3/cnstVal2,x3=wR+th,q2=h*h,q3=ah*ah,q4=q2-q3,q5=Math.sqrt(q4),dx=q5*wR/h,x5=wR+dx,x7=x3+dx,q6=aw-th,dh=q6/2,x4=x5-dh,x8=x7+dh,aw2=aw/2,x6=r-aw2,y1=t+ah,swAng=Math.atan(dx/ah),mswAng=-swAng,iy=t+idy,ix=(wR+x3)/2,q12=th/2,dang2=Math.atan(q12/idy),swAng2=dang2-swAng,mswAng2=-swAng2,stAng3=Math.PI/2-swAng,swAng3=swAng+dang2,stAng2=Math.PI/2-dang2;var stAng2dg,swAng2dg,swAngDg,swAng2dg;stAng2dg=180*stAng2/Math.PI,swAng2dg=180*swAng2/Math.PI,stAng3dg=180*stAng3/Math.PI,swAngDg=180*swAng/Math.PI;var d_val=shapeArc(wR,0,wR,h,stAng2dg,stAng2dg+swAng2dg,!1)+" L"+x5+","+y1+" L"+x4+","+y1+" L"+x6+","+t+" L"+x8+","+y1+" L"+x7+","+y1+shapeArc(x3,0,wR,h,stAng3dg,stAng3dg+swAngDg,!1).replace("M","L")+" L"+wR+","+b+shapeArc(wR,0,wR,h,cd4,cd2,!1).replace("M","L")+" L"+th+","+t+shapeArc(x3,0,wR,h,cd2,cd4,!1).replace("M","L");result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"mathDivide":case"mathEqual":case"mathMinus":case"mathMultiply":case"mathNotEqual":case"mathPlus":var sAdj1,adj1,sAdj2,adj2,sAdj3,adj3,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]);if(void 0!==shapAdjst_ary)if(shapAdjst_ary.constructor===Array)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))):"adj3"==sAdj_name&&(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4)))}else sAdj1=getTextByPathList(shapAdjst_ary,["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4));var dVal,cnstVal1=5e4*slideFactor,cnstVal2=1e5*slideFactor,cnstVal3=2e5*slideFactor,hc=w/2,vc=h/2,hd2=h/2;if("mathNotEqual"==shapType){void 0===shapAdjst_ary?(adj1=23520*slideFactor,adj2=110*Math.PI/180,adj3=11760*slideFactor):(adj1*=slideFactor,adj2=adj2/6e4*Math.PI/180,adj3*=slideFactor);var a1,crAng,a2a1,maxAdj3,a3,dy1,dy2,dx1,x1,x8,y2,y3,y1,y4,cadj2,xadj2,len,bhw,bhw2,x7,dx67,x6,dx57,x5,dx47,x4,dx37,x3,dx27,x2,rx7,rx6,rx5,rx4,rx3,rx2,dx7,rxt,lxt,rx,lx,dy3,dy4,ry,ly,dlx,drx,dly,dry,xC1,xC2,yC1,yC2,yC3,yC4,angVal1=70*Math.PI/180,angVal2=110*Math.PI/180,cnstVal4=73490*slideFactor;a1=0>adj1?0:adj1>cnstVal1?cnstVal1:adj1,crAng=angVal1>adj2?angVal1:adj2>angVal2?angVal2:adj2,a2a1=2*a1,maxAdj3=cnstVal2-a2a1,a3=0>adj3?0:adj3>maxAdj3?maxAdj3:adj3,dy1=h*a1/cnstVal2,dy2=h*a3/cnstVal3,dx1=w*cnstVal4/cnstVal3,x1=hc-dx1,x8=hc+dx1,y2=vc-dy2,y3=vc+dy2,y1=y2-dy1,y4=y3+dy1,cadj2=crAng-Math.PI/2,xadj2=hd2*Math.tan(cadj2),len=Math.sqrt(xadj2*xadj2+hd2*hd2),bhw=len*dy1/hd2,bhw2=bhw/2,x7=hc+xadj2-bhw2,dx67=xadj2*y1/hd2,x6=x7-dx67,dx57=xadj2*y2/hd2,x5=x7-dx57,dx47=xadj2*y3/hd2,x4=x7-dx47,dx37=xadj2*y4/hd2,x3=x7-dx37,dx27=2*xadj2,x2=x7-dx27,rx7=x7+bhw,rx6=x6+bhw,rx5=x5+bhw,rx4=x4+bhw,rx3=x3+bhw,rx2=x2+bhw,dx7=dy1*hd2/len,rxt=x7+dx7,lxt=rx7-dx7,rx=cadj2>0?rxt:rx7,lx=cadj2>0?x7:lxt,dy3=dy1*xadj2/len,dy4=-dy3,ry=cadj2>0?dy3:0,ly=cadj2>0?0:dy4,dlx=w-rx,drx=w-lx,dly=h-ry,dry=h-ly,xC1=(rx+lx)/2,xC2=(drx+dlx)/2,yC1=(ry+ly)/2,yC2=(y1+y2)/2,yC3=(y3+y4)/2,yC4=(dry+dly)/2,dVal="M"+x1+","+y1+" L"+x6+","+y1+" L"+lx+","+ly+" L"+rx+","+ry+" L"+rx6+","+y1+" L"+x8+","+y1+" L"+x8+","+y2+" L"+rx5+","+y2+" L"+rx4+","+y3+" L"+x8+","+y3+" L"+x8+","+y4+" L"+rx3+","+y4+" L"+drx+","+dry+" L"+dlx+","+dly+" L"+x3+","+y4+" L"+x1+","+y4+" L"+x1+","+y3+" L"+x4+","+y3+" L"+x5+","+y2+" L"+x1+","+y2+" z"}else if("mathDivide"==shapType){void 0===shapAdjst_ary?(adj1=23520*slideFactor,adj2=5880*slideFactor,adj3=11760*slideFactor):(adj1*=slideFactor,adj2*=slideFactor,adj3*=slideFactor);var a1,ma1,ma3h,ma3w,maxAdj3,a3,m4a3,maxAdj2,a2,dy1,yg,rad,dx1,y3,y4,a,y2,y1,y5,x1,x3,x2,cnstVal4=1e3*slideFactor,cnstVal5=36745*slideFactor,cnstVal6=73490*slideFactor;a1=cnstVal4>adj1?cnstVal4:adj1>cnstVal5?cnstVal5:adj1,ma1=-a1,ma3h=(cnstVal6+ma1)/4,ma3w=cnstVal5*w/h,maxAdj3=ma3w>ma3h?ma3h:ma3w,a3=cnstVal4>adj3?cnstVal4:adj3>maxAdj3?maxAdj3:adj3,m4a3=-4*a3,maxAdj2=cnstVal6+m4a3-a1,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,dy1=h*a1/cnstVal3,yg=h*a2/cnstVal2,rad=h*a3/cnstVal2,dx1=w*cnstVal6/cnstVal3,y3=vc-dy1,y4=vc+dy1,a=yg+rad,y2=y3-a,y1=y2-rad,y5=h-y1,x1=hc-dx1,x3=hc+dx1,x2=hc-rad;var cd4=90,c3d4=270,cX1=hc-Math.cos(c3d4*Math.PI/180)*rad,cY1=y1-Math.sin(c3d4*Math.PI/180)*rad,cX2=hc-Math.cos(Math.PI/2)*rad,cY2=y5-Math.sin(Math.PI/2)*rad;dVal="M"+hc+","+y1+shapeArc(cX1,cY1,rad,rad,c3d4,c3d4+360,!1).replace("M","L")+" z M"+hc+","+y5+shapeArc(cX2,cY2,rad,rad,cd4,cd4+360,!1).replace("M","L")+" z M"+x1+","+y3+" L"+x3+","+y3+" L"+x3+","+y4+" L"+x1+","+y4+" z"}else if("mathEqual"==shapType){void 0===shapAdjst_ary?(adj1=23520*slideFactor,adj2=11760*slideFactor):(adj1*=slideFactor,adj2*=slideFactor);var a1,a2a1,mAdj2,a2,dy1,dy2,dx1,y2,y3,y1,y4,x1,x2,yC1,yC2,cnstVal5=36745*slideFactor,cnstVal6=73490*slideFactor;a1=0>adj1?0:adj1>cnstVal5?cnstVal5:adj1,a2a1=2*a1,mAdj2=cnstVal2-a2a1,a2=0>adj2?0:adj2>mAdj2?mAdj2:adj2,dy1=h*a1/cnstVal2,dy2=h*a2/cnstVal3,dx1=w*cnstVal6/cnstVal3,y2=vc-dy2,y3=vc+dy2,y1=y2-dy1,y4=y3+dy1,x1=hc-dx1,x2=hc+dx1,yC1=(y1+y2)/2,yC2=(y3+y4)/2,dVal="M"+x1+","+y1+" L"+x2+","+y1+" L"+x2+","+y2+" L"+x1+","+y2+" zM"+x1+","+y3+" L"+x2+","+y3+" L"+x2+","+y4+" L"+x1+","+y4+" z"}else if("mathMinus"==shapType){void 0===shapAdjst_ary?adj1=23520*slideFactor:adj1*=slideFactor;var a1,dy1,dx1,y1,y2,x1,x2,cnstVal6=73490*slideFactor;a1=0>adj1?0:adj1>cnstVal2?cnstVal2:adj1,dy1=h*a1/cnstVal3,dx1=w*cnstVal6/cnstVal3,y1=vc-dy1,y2=vc+dy1,x1=hc-dx1,x2=hc+dx1,dVal="M"+x1+","+y1+" L"+x2+","+y1+" L"+x2+","+y2+" L"+x1+","+y2+" z"}else if("mathMultiply"==shapType){void 0===shapAdjst_ary?adj1=23520*slideFactor:adj1*=slideFactor;var a1,th,a,sa,ca,ta,dl,rw,lM,xM,yM,dxAM,dyAM,xA,yA,xB,yB,xBC,yBC,yC,xD,xE,yFE,xFE,xF,xL,yG,yH,yI,xC2,yC3,cnstVal6=51965*slideFactor,ss=Math.min(w,h);a1=0>adj1?0:adj1>cnstVal6?cnstVal6:adj1,th=ss*a1/cnstVal2,a=Math.atan(h/w),sa=1*Math.sin(a),ca=1*Math.cos(a),ta=1*Math.tan(a),dl=Math.sqrt(w*w+h*h),rw=dl*cnstVal6/cnstVal2,lM=dl-rw,xM=ca*lM/2,yM=sa*lM/2,dxAM=sa*th/2,dyAM=ca*th/2,xA=xM-dxAM,yA=yM+dyAM,xB=xM+dxAM,yB=yM-dyAM,xBC=hc-xB,yBC=xBC*ta,yC=yBC+yB,xD=w-xB,xE=w-xA,yFE=vc-yA,xFE=yFE/ta,xF=xE-xFE,xL=xA+xFE,yG=h-yA,yH=h-yB,yI=h-yC,xC2=w-xM,yC3=h-yM,dVal="M"+xA+","+yA+" L"+xB+","+yB+" L"+hc+","+yC+" L"+xD+","+yB+" L"+xE+","+yA+" L"+xF+","+vc+" L"+xE+","+yG+" L"+xD+","+yH+" L"+hc+","+yI+" L"+xB+","+yH+" L"+xA+","+yG+" L"+xL+","+vc+" z"}else if("mathPlus"==shapType){void 0===shapAdjst_ary?adj1=23520*slideFactor:adj1*=slideFactor;var a1,dx1,dy1,dx2,x1,x2,x3,x4,y1,y2,y3,y4,cnstVal6=73490*slideFactor,ss=Math.min(w,h);a1=0>adj1?0:adj1>cnstVal6?cnstVal6:adj1,dx1=w*cnstVal6/cnstVal3,dy1=h*cnstVal6/cnstVal3,dx2=ss*a1/cnstVal3,x1=hc-dx1,x2=hc-dx2,x3=hc+dx2,x4=hc+dx1,y1=vc-dy1,y2=vc-dx2,y3=vc+dx2,y4=vc+dy1,dVal="M"+x1+","+y2+" L"+x2+","+y2+" L"+x2+","+y1+" L"+x3+","+y1+" L"+x3+","+y2+" L"+x4+","+y2+" L"+x4+","+y3+" L"+x3+","+y3+" L"+x3+","+y4+" L"+x2+","+y4+" L"+x2+","+y3+" L"+x1+","+y3+" z"}result+="<path d='"+dVal+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"can":case"flowChartMagneticDisk":case"flowChartMagneticDrum":var shapAdjst=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd","attrs","fmla"]),adj=25e3*slideFactor,cnstVal1=5e4*slideFactor,cnstVal2=2e5*slideFactor;void 0!==shapAdjst&&(adj=parseInt(shapAdjst.substr(4))*slideFactor);var maxAdj,a,y1,y2,y3,dVal,ss=Math.min(w,h);("flowChartMagneticDisk"==shapType||"flowChartMagneticDrum"==shapType)&&(adj=5e4*slideFactor),maxAdj=cnstVal1*h/ss,a=0>adj?0:adj>maxAdj?maxAdj:adj,y1=ss*a/cnstVal2,y2=y1+y1,y3=h-y1;var cd2=180,wd2=w/2,tranglRott="";"flowChartMagneticDrum"==shapType&&(tranglRott="transform='rotate(90 "+w/2+","+h/2+")'"),dVal=shapeArc(wd2,y1,wd2,y1,0,cd2,!1)+shapeArc(wd2,y1,wd2,y1,cd2,cd2+cd2,!1).replace("M","L")+" L"+w+","+y3+shapeArc(wd2,y3,wd2,y1,0,cd2,!1).replace("M","L")+" L0,"+y1,result+="<path "+tranglRott+" d='"+dVal+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"swooshArrow":var sAdj1,sAdj2,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),refr=slideFactor,adj1=25e3*refr,adj2=16667*refr;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*refr):"adj2"==sAdj_name&&(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))*refr)}var a1,maxAdj2,a2,ad1,ad2,xB,yB,alfa,dx0,xC,dx1,yF,xF,xE,yE,dy2,dy22,dy3,yD,dy4,yP1,xP1,dy5,yP2,xP2,cnstVal1=1*refr,cnstVal2=7e4*refr,cnstVal3=75e3*refr,cnstVal4=1e5*refr,ss=Math.min(w,h),ssd8=ss/8,hd6=h/6;a1=cnstVal1>adj1?cnstVal1:adj1>cnstVal3?cnstVal3:adj1,maxAdj2=cnstVal2*w/ss,a2=0>adj2?0:adj2>maxAdj2?maxAdj2:adj2,ad1=h*a1/cnstVal4,ad2=ss*a2/cnstVal4,xB=w-ad2,yB=ssd8,alfa=Math.PI/2/14,dx0=ssd8*Math.tan(alfa),xC=xB-dx0,dx1=ad1*Math.tan(alfa),yF=yB+ad1,xF=xB+dx1,xE=xF+dx0,yE=yF+ssd8,dy2=yE-0,dy22=dy2/2,dy3=h/20,yD=dy22-dy3,dy4=hd6,yP1=hd6+dy4,xP1=w/6,dy5=hd6/2,yP2=yF+dy5,xP2=w/4;var dVal="M0,"+h+" Q"+xP1+","+yP1+" "+xB+","+yB+" L"+xC+",0 L"+w+","+yD+" L"+xE+","+yE+" L"+xF+","+yF+" Q"+xP2+","+yP2+" 0,"+h+" z";result+="<path d='"+dVal+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"circularArrow":var sAdj1,sAdj2,sAdj3,sAdj4,sAdj5,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=12500*slideFactor,adj2=19.03865*Math.PI/180,adj3=340.96135*Math.PI/180,adj4=180*Math.PI/180,adj5=12500*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))/6e4*Math.PI/180):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))/6e4*Math.PI/180):"adj4"==sAdj_name?(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))/6e4*Math.PI/180):"adj5"==sAdj_name&&(sAdj5=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj5=parseInt(sAdj5.substr(4))*slideFactor)}var a5,maxAdj1,a1,enAng,stAng,th,thh,th2,rw1,rh1,rw2,rh2,rw3,rh3,wtH,htH,dxH,dyH,xH,yH,rI,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,u21,maxAng,aAng,ptAng,wtA,htA,dxA,dyA,xA,yA,wtE,htE,dxE,dyE,xE,yE,dxG,dyG,xG,yG,dxB,dyB,xB,yB,sx1,sy1,sx2,sy2,rO,x1O,y1O,x2O,y2O,dxO,dyO,dO,q1,q2,DO,q3,q4,q5,q6,q7,q8,sdelO,ndyO,sdyO,q9,q10,q11,dxF1,q12,dxF2,adyO,q13,q14,dyF1,q15,dyF2,q16,q17,q18,q19,q20,q21,q22,dxF,dyF,sdxF,sdyF,xF,yF,x1I,y1I,x2I,y2I,dxI,dyI,dI,v1,v2,DI,v3,v4,v5,v6,v7,v8,sdelI,v9,v10,v11,dxC1,v12,dxC2,adyI,v13,v14,dyC1,v15,dyC2,v16,v17,v18,v19,v20,v21,v22,dxC,dyC,sdxC,sdyC,xC,yC,ist0,ist1,istAng,isw1,isw2,iswAng,p1,p2,p3,p4,p5,xGp,yGp,xBp,yBp,en0,en1,en2,sw0,sw1,swAng,vc=h/2,hc=w/2,r=w,b=h,l=0,t=0,wd2=w/2,hd2=h/2,ss=Math.min(w,h),cnstVal1=25e3*slideFactor,cnstVal2=1e5*slideFactor,rdAngVal1=1/6e4*Math.PI/180,rdAngVal2=21599999/6e4*Math.PI/180,rdAngVal3=2*Math.PI;a5=0>adj5?0:adj5>cnstVal1?cnstVal1:adj5,maxAdj1=2*a5,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,enAng=rdAngVal1>adj3?rdAngVal1:adj3>rdAngVal2?rdAngVal2:adj3,stAng=0>adj4?0:adj4>rdAngVal2?rdAngVal2:adj4,th=ss*a1/cnstVal2,thh=ss*a5/cnstVal2,th2=th/2,rw1=wd2+th2-thh,rh1=hd2+th2-thh,rw2=rw1-th,rh2=rh1-th,rw3=rw2+th2,rh3=rh2+th2,wtH=rw3*Math.sin(enAng),htH=rh3*Math.cos(enAng),dxH=rw3*Math.cos(Math.atan2(wtH,htH)),dyH=rh3*Math.sin(Math.atan2(wtH,htH)),xH=hc+dxH,yH=vc+dyH,rI=rh2>rw2?rw2:rh2,u1=dxH*dxH,u2=dyH*dyH,u3=rI*rI,u4=u1-u3,u5=u2-u3,u6=u4*u5/u1,u7=u6/u2,u8=1-u7,u9=Math.sqrt(u8),u10=u4/dxH,u11=u10/dyH,u12=(1+u9)/u11,u13=Math.atan2(u12,1),u14=u13+rdAngVal3,u15=u13>0?u13:u14,u16=u15-enAng,u17=u16+rdAngVal3,u18=u16>0?u16:u17,u19=u18-cd2,u20=u18-rdAngVal3,u21=u19>0?u20:u18,maxAng=Math.abs(u21),aAng=0>adj2?0:adj2>maxAng?maxAng:adj2,ptAng=enAng+aAng,wtA=rw3*Math.sin(ptAng),htA=rh3*Math.cos(ptAng),dxA=rw3*Math.cos(Math.atan2(wtA,htA)),dyA=rh3*Math.sin(Math.atan2(wtA,htA)),xA=hc+dxA,yA=vc+dyA,wtE=rw1*Math.sin(stAng),htE=rh1*Math.cos(stAng),dxE=rw1*Math.cos(Math.atan2(wtE,htE)),dyE=rh1*Math.sin(Math.atan2(wtE,htE)),xE=hc+dxE,yE=vc+dyE,dxG=thh*Math.cos(ptAng),dyG=thh*Math.sin(ptAng),xG=xH+dxG,yG=yH+dyG,dxB=thh*Math.cos(ptAng),dyB=thh*Math.sin(ptAng),xB=xH-dxB,yB=yH-dyB,sx1=xB-hc,sy1=yB-vc,sx2=xG-hc,sy2=yG-vc,rO=rh1>rw1?rw1:rh1,x1O=sx1*rO/rw1,y1O=sy1*rO/rh1,x2O=sx2*rO/rw1,y2O=sy2*rO/rh1,dxO=x2O-x1O,dyO=y2O-y1O,dO=Math.sqrt(dxO*dxO+dyO*dyO),q1=x1O*y2O,q2=x2O*y1O,DO=q1-q2,q3=rO*rO,q4=dO*dO,q5=q3*q4,q6=DO*DO,q7=q5-q6,q8=q7>0?q7:0,sdelO=Math.sqrt(q8),ndyO=-1*dyO,sdyO=ndyO>0?-1:1,q9=sdyO*dxO,q10=q9*sdelO,q11=DO*dyO,dxF1=(q11+q10)/q4,q12=q11-q10,dxF2=q12/q4,adyO=Math.abs(dyO),q13=adyO*sdelO,q14=DO*dxO/-1,dyF1=(q14+q13)/q4,q15=q14-q13,dyF2=q15/q4,q16=x2O-dxF1,q17=x2O-dxF2,q18=y2O-dyF1,q19=y2O-dyF2,q20=Math.sqrt(q16*q16+q18*q18),q21=Math.sqrt(q17*q17+q19*q19),q22=q21-q20,dxF=q22>0?dxF1:dxF2,dyF=q22>0?dyF1:dyF2,sdxF=dxF*rw1/rO,sdyF=dyF*rh1/rO,xF=hc+sdxF,yF=vc+sdyF,x1I=sx1*rI/rw2,y1I=sy1*rI/rh2,x2I=sx2*rI/rw2,y2I=sy2*rI/rh2,dxI=x2I-x1I,dyI=y2I-y1I,dI=Math.sqrt(dxI*dxI+dyI*dyI),v1=x1I*y2I,v2=x2I*y1I,DI=v1-v2,v3=rI*rI,v4=dI*dI,v5=v3*v4,v6=DI*DI,v7=v5-v6,v8=v7>0?v7:0,sdelI=Math.sqrt(v8),v9=sdyO*dxI,v10=v9*sdelI,v11=DI*dyI,dxC1=(v11+v10)/v4,v12=v11-v10,dxC2=v12/v4,adyI=Math.abs(dyI),v13=adyI*sdelI,v14=DI*dxI/-1,dyC1=(v14+v13)/v4,v15=v14-v13,dyC2=v15/v4,v16=x1I-dxC1,v17=x1I-dxC2,v18=y1I-dyC1,v19=y1I-dyC2,v20=Math.sqrt(v16*v16+v18*v18),v21=Math.sqrt(v17*v17+v19*v19),v22=v21-v20,dxC=v22>0?dxC1:dxC2,dyC=v22>0?dyC1:dyC2,sdxC=dxC*rw2/rI,sdyC=dyC*rh2/rI,xC=hc+sdxC,yC=vc+sdyC,ist0=Math.atan2(sdyC,sdxC),ist1=ist0+rdAngVal3,istAng=ist0>0?ist0:ist1,isw1=stAng-istAng,isw2=isw1-rdAngVal3,iswAng=isw1>0?isw2:isw1,p1=xF-xC,p2=yF-yC,p3=Math.sqrt(p1*p1+p2*p2),p4=p3/2,p5=p4-thh,xGp=p5>0?xF:xG,yGp=p5>0?yF:yG,xBp=p5>0?xC:xB,yBp=p5>0?yC:yB,en0=Math.atan2(sdyF,sdxF),en1=en0+rdAngVal3,en2=en0>0?en0:en1,sw0=en2-stAng,sw1=sw0+rdAngVal3,swAng=sw0>0?sw0:sw1;var strtAng=180*stAng/Math.PI,endAng=strtAng+180*swAng/Math.PI,stiAng=180*istAng/Math.PI,swiAng=180*iswAng/Math.PI,ediAng=stiAng+swiAng,d_val=shapeArc(w/2,h/2,rw1,rh1,strtAng,endAng,!1)+" L"+xGp+","+yGp+" L"+xA+","+yA+" L"+xBp+","+yBp+" L"+xC+","+yC+shapeArc(w/2,h/2,rw2,rh2,stiAng,ediAng,!1).replace("M","L")+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftCircularArrow":var sAdj1,sAdj2,sAdj3,sAdj4,sAdj5,shapAdjst_ary=getTextByPathList(node,["p:spPr","a:prstGeom","a:avLst","a:gd"]),adj1=12500*slideFactor,adj2=-19.03865*Math.PI/180,adj3=19.03865*Math.PI/180,adj4=180*Math.PI/180,adj5=12500*slideFactor;if(void 0!==shapAdjst_ary)for(var i=0;i<shapAdjst_ary.length;i++){var sAdj_name=getTextByPathList(shapAdjst_ary[i],["attrs","name"]);"adj1"==sAdj_name?(sAdj1=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj1=parseInt(sAdj1.substr(4))*slideFactor):"adj2"==sAdj_name?(sAdj2=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj2=parseInt(sAdj2.substr(4))/6e4*Math.PI/180):"adj3"==sAdj_name?(sAdj3=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj3=parseInt(sAdj3.substr(4))/6e4*Math.PI/180):"adj4"==sAdj_name?(sAdj4=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj4=parseInt(sAdj4.substr(4))/6e4*Math.PI/180):"adj5"==sAdj_name&&(sAdj5=getTextByPathList(shapAdjst_ary[i],["attrs","fmla"]),adj5=parseInt(sAdj5.substr(4))*slideFactor)}var a5,maxAdj1,a1,enAng,stAng,th,thh,th2,rw1,rh1,rw2,rh2,rw3,rh3,wtH,htH,dxH,dyH,xH,yH,rI,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,u21,u22,minAng,u23,a2,aAng,ptAng,wtA,htA,dxA,dyA,xA,yA,wtE,htE,dxE,dyE,xE,yE,wtD,htD,dxD,dyD,xD,yD,dxG,dyG,xG,yG,dxB,dyB,xB,yB,sx1,sy1,sx2,sy2,rO,x1O,y1O,x2O,y2O,dxO,dyO,dO,q1,q2,DO,q3,q4,q5,q6,q7,q8,sdelO,ndyO,sdyO,q9,q10,q11,dxF1,q12,dxF2,adyO,q13,q14,dyF1,q15,dyF2,q16,q17,q18,q19,q20,q21,q22,dxF,dyF,sdxF,sdyF,xF,yF,x1I,y1I,x2I,y2I,dxI,dyI,dI,v1,v2,DI,v3,v4,v5,v6,v7,v8,sdelI,v9,v10,v11,dxC1,v12,dxC2,adyI,v13,v14,dyC1,v15,dyC2,v16,v17,v18,v19,v20,v21,v22,dxC,dyC,sdxC,sdyC,xC,yC,ist0,ist1,istAng0,isw1,isw2,iswAng0,istAng,iswAng,p1,p2,p3,p4,p5,xGp,yGp,xBp,yBp,en0,en1,en2,sw0,sw1,swAng,stAng0,vc=h/2,hc=w/2,r=w,b=h,l=0,t=0,wd2=w/2,hd2=h/2,ss=Math.min(w,h),cnstVal1=25e3*slideFactor,cnstVal2=1e5*slideFactor,rdAngVal1=1/6e4*Math.PI/180,rdAngVal2=21599999/6e4*Math.PI/180,rdAngVal3=2*Math.PI;a5=0>adj5?0:adj5>cnstVal1?cnstVal1:adj5,maxAdj1=2*a5,a1=0>adj1?0:adj1>maxAdj1?maxAdj1:adj1,enAng=rdAngVal1>adj3?rdAngVal1:adj3>rdAngVal2?rdAngVal2:adj3,stAng=0>adj4?0:adj4>rdAngVal2?rdAngVal2:adj4,th=ss*a1/cnstVal2,thh=ss*a5/cnstVal2,th2=th/2,rw1=wd2+th2-thh,rh1=hd2+th2-thh,rw2=rw1-th,rh2=rh1-th,rw3=rw2+th2,rh3=rh2+th2,wtH=rw3*Math.sin(enAng),htH=rh3*Math.cos(enAng),dxH=rw3*Math.cos(Math.atan2(wtH,htH)),dyH=rh3*Math.sin(Math.atan2(wtH,htH)),xH=hc+dxH,yH=vc+dyH,rI=rh2>rw2?rw2:rh2,u1=dxH*dxH,u2=dyH*dyH,u3=rI*rI,u4=u1-u3,u5=u2-u3,u6=u4*u5/u1,u7=u6/u2,u8=1-u7,u9=Math.sqrt(u8),u10=u4/dxH,u11=u10/dyH,u12=(1+u9)/u11,u13=Math.atan2(u12,1),u14=u13+rdAngVal3,u15=u13>0?u13:u14,u16=u15-enAng,u17=u16+rdAngVal3,u18=u16>0?u16:u17,u19=u18-cd2,u20=u18-rdAngVal3,u21=u19>0?u20:u18,u22=Math.abs(u21),minAng=-1*u22,u23=Math.abs(adj2),a2=-1*u23,aAng=minAng>a2?minAng:a2>0?0:a2,ptAng=enAng+aAng,wtA=rw3*Math.sin(ptAng),htA=rh3*Math.cos(ptAng),dxA=rw3*Math.cos(Math.atan2(wtA,htA)),dyA=rh3*Math.sin(Math.atan2(wtA,htA)),xA=hc+dxA,yA=vc+dyA,wtE=rw1*Math.sin(stAng),htE=rh1*Math.cos(stAng),dxE=rw1*Math.cos(Math.atan2(wtE,htE)),dyE=rh1*Math.sin(Math.atan2(wtE,htE)),xE=hc+dxE,yE=vc+dyE,wtD=rw2*Math.sin(stAng),htD=rh2*Math.cos(stAng),dxD=rw2*Math.cos(Math.atan2(wtD,htD)),dyD=rh2*Math.sin(Math.atan2(wtD,htD)),xD=hc+dxD,yD=vc+dyD,dxG=thh*Math.cos(ptAng),dyG=thh*Math.sin(ptAng),xG=xH+dxG,yG=yH+dyG,dxB=thh*Math.cos(ptAng),dyB=thh*Math.sin(ptAng),xB=xH-dxB,yB=yH-dyB,sx1=xB-hc,sy1=yB-vc,sx2=xG-hc,sy2=yG-vc,rO=rh1>rw1?rw1:rh1,x1O=sx1*rO/rw1,y1O=sy1*rO/rh1,x2O=sx2*rO/rw1,y2O=sy2*rO/rh1,dxO=x2O-x1O,dyO=y2O-y1O,dO=Math.sqrt(dxO*dxO+dyO*dyO),q1=x1O*y2O,q2=x2O*y1O,DO=q1-q2,q3=rO*rO,q4=dO*dO,q5=q3*q4,q6=DO*DO,q7=q5-q6,q8=q7>0?q7:0,sdelO=Math.sqrt(q8),ndyO=-1*dyO,sdyO=ndyO>0?-1:1,q9=sdyO*dxO,q10=q9*sdelO,q11=DO*dyO,dxF1=(q11+q10)/q4,q12=q11-q10,dxF2=q12/q4,adyO=Math.abs(dyO),q13=adyO*sdelO,q14=DO*dxO/-1,dyF1=(q14+q13)/q4,q15=q14-q13,dyF2=q15/q4,q16=x2O-dxF1,q17=x2O-dxF2,q18=y2O-dyF1,q19=y2O-dyF2,q20=Math.sqrt(q16*q16+q18*q18),q21=Math.sqrt(q17*q17+q19*q19),q22=q21-q20,dxF=q22>0?dxF1:dxF2,dyF=q22>0?dyF1:dyF2,sdxF=dxF*rw1/rO,sdyF=dyF*rh1/rO,xF=hc+sdxF,yF=vc+sdyF,x1I=sx1*rI/rw2,y1I=sy1*rI/rh2,x2I=sx2*rI/rw2,y2I=sy2*rI/rh2,dxI=x2I-x1I,dyI=y2I-y1I,dI=Math.sqrt(dxI*dxI+dyI*dyI),v1=x1I*y2I,v2=x2I*y1I,DI=v1-v2,v3=rI*rI,v4=dI*dI,v5=v3*v4,v6=DI*DI,v7=v5-v6,v8=v7>0?v7:0,sdelI=Math.sqrt(v8),v9=sdyO*dxI,v10=v9*sdelI,v11=DI*dyI,dxC1=(v11+v10)/v4,v12=v11-v10,dxC2=v12/v4,adyI=Math.abs(dyI),v13=adyI*sdelI,v14=DI*dxI/-1,dyC1=(v14+v13)/v4,v15=v14-v13,dyC2=v15/v4,v16=x1I-dxC1,v17=x1I-dxC2,v18=y1I-dyC1,v19=y1I-dyC2,v20=Math.sqrt(v16*v16+v18*v18),v21=Math.sqrt(v17*v17+v19*v19),v22=v21-v20,dxC=v22>0?dxC1:dxC2,dyC=v22>0?dyC1:dyC2,sdxC=dxC*rw2/rI,sdyC=dyC*rh2/rI,xC=hc+sdxC,yC=vc+sdyC,ist0=Math.atan2(sdyC,sdxC),ist1=ist0+rdAngVal3,istAng0=ist0>0?ist0:ist1,isw1=stAng-istAng0,isw2=isw1+rdAngVal3,iswAng0=isw1>0?isw1:isw2,istAng=istAng0+iswAng0,iswAng=-iswAng0,p1=xF-xC,p2=yF-yC,p3=Math.sqrt(p1*p1+p2*p2),p4=p3/2,p5=p4-thh,xGp=p5>0?xF:xG,yGp=p5>0?yF:yG,xBp=p5>0?xC:xB,yBp=p5>0?yC:yB,en0=Math.atan2(sdyF,sdxF),en1=en0+rdAngVal3,en2=en0>0?en0:en1,sw0=en2-stAng,sw1=sw0-rdAngVal3,swAng=sw0>0?sw1:sw0,stAng0=stAng+swAng;var strtAng=180*stAng0/Math.PI,endAng=180*stAng/Math.PI,stiAng=180*istAng/Math.PI,swiAng=180*iswAng/Math.PI,ediAng=stiAng+swiAng,d_val="M"+xE+","+yE+" L"+xD+","+yD+shapeArc(w/2,h/2,rw2,rh2,stiAng,ediAng,!1).replace("M","L")+" L"+xBp+","+yBp+" L"+xA+","+yA+" L"+xGp+","+yGp+" L"+xF+","+yF+shapeArc(w/2,h/2,rw1,rh1,strtAng,endAng,!1).replace("M","L")+" z";result+="<path d='"+d_val+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+border.color+"' stroke-width='"+border.width+"' stroke-dasharray='"+border.strokeDasharray+"' />";break;case"leftRightCircularArrow":case"chartPlus":case"chartStar":case"chartX":case"cornerTabs":case"flowChartOfflineStorage":case"folderCorner":case"funnel":case"lineInv":case"nonIsoscelesTrapezoid":case"plaqueTabs":case"squareTabs":case"upDownArrowCallout":console.log(shapType," -unsupported shape type.");break;case void 0:default:console.warn("Undefine shape type.("+shapType+")")}result+="</svg>",result+="<div class='block "+getVerticalAlign(node,slideLayoutSpNode,slideMasterSpNode,type)+" "+getContentDir(node,type,warpObj)+"' _id='"+id+"' _idx='"+idx+"' _type='"+type+"' _name='"+name+"' style='"+getPosition(slideXfrmNode,pNode,slideLayoutXfrmNode,slideMasterXfrmNode,sType)+getSize(slideXfrmNode,slideLayoutXfrmNode,slideMasterXfrmNode)+" z-index: "+order+";transform: rotate("+(void 0!==txtRotate?txtRotate:0)+"deg);'>",void 0===node["p:txBody"]||void 0!==isUserDrawnBg&&isUserDrawnBg!==!0||("diagram"!=type&&"textBox"!=type&&(type="shape"),result+=genTextBody(node["p:txBody"],node,slideLayoutSpNode,slideMasterSpNode,type,idx,warpObj)),result+="</div>"}else if(void 0!==custShapType){var pathLstNode=getTextByPathList(custShapType,["a:pathLst"]),pathNodes=getTextByPathList(pathLstNode,["a:path"]),maxX=parseInt(pathNodes.attrs.w),maxY=parseInt(pathNodes.attrs.h),cX=1/maxX*w,cY=1/maxY*h,moveToNode=getTextByPathList(pathNodes,["a:moveTo"]),lnToNodes=(moveToNode.length,pathNodes["a:lnTo"]),cubicBezToNodes=pathNodes["a:cubicBezTo"],arcToNodes=pathNodes["a:arcTo"],closeNode=getTextByPathList(pathNodes,["a:close"]);Array.isArray(moveToNode)||(moveToNode=[moveToNode]);var multiSapeAry=[];if(moveToNode.length>0){if(Object.keys(moveToNode).forEach(function(key){var moveToPtNode=moveToNode[key]["a:pt"];void 0!==moveToPtNode&&Object.keys(moveToPtNode).forEach(function(key2){var ptObj={},moveToNoPt=moveToPtNode[key2],spX=moveToNoPt.x,spY=moveToNoPt.y,ptOrdr=moveToNoPt.order;ptObj.type="movto",ptObj.order=ptOrdr,ptObj.x=spX,ptObj.y=spY,multiSapeAry.push(ptObj)})}),void 0!==lnToNodes&&Object.keys(lnToNodes).forEach(function(key){var lnToPtNode=lnToNodes[key]["a:pt"];void 0!==lnToPtNode&&Object.keys(lnToPtNode).forEach(function(key2){var ptObj={},lnToNoPt=lnToPtNode[key2],ptX=lnToNoPt.x,ptY=lnToNoPt.y,ptOrdr=lnToNoPt.order;ptObj.type="lnto",ptObj.order=ptOrdr,ptObj.x=ptX,ptObj.y=ptY,multiSapeAry.push(ptObj)})}),void 0!==cubicBezToNodes){var cubicBezToPtNodesAry=[];Array.isArray(cubicBezToNodes)||(cubicBezToNodes=[cubicBezToNodes]),Object.keys(cubicBezToNodes).forEach(function(key){cubicBezToPtNodesAry.push(cubicBezToNodes[key]["a:pt"])}),cubicBezToPtNodesAry.forEach(function(key2){var nodeObj={};nodeObj.type="cubicBezTo",nodeObj.order=key2[0].attrs.order;var pts_ary=[];key2.forEach(function(pt){var pt_obj={x:pt.attrs.x,y:pt.attrs.y};pts_ary.push(pt_obj)}),nodeObj.cubBzPt=pts_ary,multiSapeAry.push(nodeObj)})}if(void 0!==arcToNodes){var arcToNodesAttrs=arcToNodes.attrs,arcOrder=arcToNodesAttrs.order,hR=arcToNodesAttrs.hR,wR=arcToNodesAttrs.wR,stAng=arcToNodesAttrs.stAng,swAng=arcToNodesAttrs.swAng,shftX=0,shftY=0,arcToPtNode=getTextByPathList(arcToNodes,["a:pt","attrs"]);void 0!==arcToPtNode&&(shftX=arcToPtNode.x,shftY=arcToPtNode.y);var ptObj={};ptObj.type="arcTo",ptObj.order=arcOrder,ptObj.hR=hR,ptObj.wR=wR,ptObj.stAng=stAng,ptObj.swAng=swAng,ptObj.shftX=shftX,ptObj.shftY=shftY,multiSapeAry.push(ptObj)}void 0!==closeNode&&(Array.isArray(closeNode)||(closeNode=[closeNode]),Object.keys(closeNode).forEach(function(key){var clsAttrs=closeNode[key].attrs,clsOrder=clsAttrs.order,ptObj={};ptObj.type="close",ptObj.order=clsOrder,multiSapeAry.push(ptObj)})),multiSapeAry.sort(function(a,b){return a.order-b.order});for(var k=0,isClose=!1,d="";k<multiSapeAry.length;){if("movto"==multiSapeAry[k].type){var spX=parseInt(multiSapeAry[k].x)*cX,spY=parseInt(multiSapeAry[k].y)*cY;d+=" M"+spX+","+spY}else if("lnto"==multiSapeAry[k].type){var Lx=parseInt(multiSapeAry[k].x)*cX,Ly=parseInt(multiSapeAry[k].y)*cY;d+=" L"+Lx+","+Ly}else if("cubicBezTo"==multiSapeAry[k].type){var Cx1=parseInt(multiSapeAry[k].cubBzPt[0].x)*cX,Cy1=parseInt(multiSapeAry[k].cubBzPt[0].y)*cY,Cx2=parseInt(multiSapeAry[k].cubBzPt[1].x)*cX,Cy2=parseInt(multiSapeAry[k].cubBzPt[1].y)*cY,Cx3=parseInt(multiSapeAry[k].cubBzPt[2].x)*cX,Cy3=parseInt(multiSapeAry[k].cubBzPt[2].y)*cY;d+=" C"+Cx1+","+Cy1+" "+Cx2+","+Cy2+" "+Cx3+","+Cy3}else if("arcTo"==multiSapeAry[k].type){var hR=parseInt(multiSapeAry[k].hR)*cX,wR=parseInt(multiSapeAry[k].wR)*cY,stAng=parseInt(multiSapeAry[k].stAng)/6e4,swAng=parseInt(multiSapeAry[k].swAng)/6e4,endAng=stAng+swAng;d+=shapeArc(wR,hR,wR,hR,stAng,endAng,!1)}else"quadBezTo"==multiSapeAry[k].type?console.log("custShapType: quadBezTo - TODO"):"close"==multiSapeAry[k].type&&(d+="z");k++}result+="<path d='"+d+"' fill='"+(imgFillFlg?"url(#imgPtrn_"+shpId+")":grndFillFlg?"url(#linGrd_"+shpId+")":fillColor)+"' stroke='"+(void 0===border?"":border.color)+"' stroke-width='"+(void 0===border?"":border.width)+"' stroke-dasharray='"+(void 0===border?"":border.strokeDasharray)+"' ",result+="/>"}result+="</svg>",result+="<div class='block "+getVerticalAlign(node,slideLayoutSpNode,slideMasterSpNode,type)+" "+getContentDir(node,type,warpObj)+"' _id='"+id+"' _idx='"+idx+"' _type='"+type+"' _name='"+name+"' style='"+getPosition(slideXfrmNode,pNode,slideLayoutXfrmNode,slideMasterXfrmNode,sType)+getSize(slideXfrmNode,slideLayoutXfrmNode,slideMasterXfrmNode)+" z-index: "+order+";transform: rotate("+(void 0!==txtRotate?txtRotate:0)+"deg);'>",
void 0===node["p:txBody"]||void 0!==isUserDrawnBg&&isUserDrawnBg!==!0||("diagram"!=type&&"textBox"!=type&&(type="shape"),result+=genTextBody(node["p:txBody"],node,slideLayoutSpNode,slideMasterSpNode,type,idx,warpObj)),result+="</div>"}else result+="<div class='block "+getVerticalAlign(node,slideLayoutSpNode,slideMasterSpNode,type)+" "+getContentDir(node,type,warpObj)+"' _id='"+id+"' _idx='"+idx+"' _type='"+type+"' _name='"+name+"' style='"+getPosition(slideXfrmNode,pNode,slideLayoutXfrmNode,slideMasterXfrmNode,sType)+getSize(slideXfrmNode,slideLayoutXfrmNode,slideMasterXfrmNode)+getBorder(node,pNode,!1,"shape",warpObj)+getShapeFill(node,pNode,!1,warpObj,source)+" z-index: "+order+";transform: rotate("+(void 0!==txtRotate?txtRotate:0)+"deg);'>",void 0===node["p:txBody"]||void 0!==isUserDrawnBg&&isUserDrawnBg!==!0||(result+=genTextBody(node["p:txBody"],node,slideLayoutSpNode,slideMasterSpNode,type,idx,warpObj)),result+="</div>";return result}function shapePie(H,w,adj1,adj2,isClose){var pieVal=parseInt(adj2),piAngle=parseInt(adj1),size=parseInt(H),radius=size/2,value=pieVal-piAngle;0>value&&(value=360+value),value=Math.min(Math.max(value,0),360);var longArc,d,rot,x=Math.cos(2*Math.PI/(360/value)),y=Math.sin(2*Math.PI/(360/value));if(isClose)longArc=180>=value?0:1,d="M"+radius+","+radius+" L"+radius+",0 A"+radius+","+radius+" 0 "+longArc+",1 "+(radius+y*radius)+","+(radius-x*radius)+" z",rot="rotate("+(piAngle-270)+", "+radius+", "+radius+")";else{longArc=180>=value?0:1;var radius1=radius,radius2=w/2;d="M"+radius1+",0 A"+radius2+","+radius1+" 0 "+longArc+",1 "+(radius2+y*radius2)+","+(radius1-x*radius1),rot="rotate("+(piAngle+90)+", "+radius+", "+radius+")"}return[d,rot]}function shapeGear(w,h,points){var innerRadius=h,outerRadius=1.5*innerRadius,cx=outerRadius;cy=outerRadius,notches=points,radiusO=outerRadius,radiusI=innerRadius,taperO=50,taperI=35,pi2=2*Math.PI,angle=pi2/(2*notches),taperAI=angle*taperI*.005,taperAO=angle*taperO*.005,a=angle,toggle=!1;for(var d=" M"+(cx+radiusO*Math.cos(taperAO))+" "+(cy+radiusO*Math.sin(taperAO));a<=pi2+angle;a+=angle)toggle?(d+=" L"+(cx+radiusI*Math.cos(a-taperAI))+","+(cy+radiusI*Math.sin(a-taperAI)),d+=" L"+(cx+radiusO*Math.cos(a+taperAO))+","+(cy+radiusO*Math.sin(a+taperAO))):(d+=" L"+(cx+radiusO*Math.cos(a-taperAO))+","+(cy+radiusO*Math.sin(a-taperAO)),d+=" L"+(cx+radiusI*Math.cos(a+taperAI))+","+(cy+radiusI*Math.sin(a+taperAI))),toggle=!toggle;return d+=" "}function shapeArc(cX,cY,rX,rY,stAng,endAng,isClose){var dData,angle=stAng;if(endAng>=stAng)for(;endAng>=angle;){var radians=angle*(Math.PI/180),x=cX+Math.cos(radians)*rX,y=cY+Math.sin(radians)*rY;angle==stAng&&(dData=" M"+x+" "+y),dData+=" L"+x+" "+y,angle++}else for(;angle>endAng;){var radians=angle*(Math.PI/180),x=cX+Math.cos(radians)*rX,y=cY+Math.sin(radians)*rY;angle==stAng&&(dData=" M "+x+" "+y),dData+=" L "+x+" "+y,angle--}return dData+=isClose?" z":""}function shapeSnipRoundRect(w,h,adj1,adj2,shapeType,adjType){var adjA,adjB,adjC,adjD;"cornr1"==adjType?(adjA=0,adjB=0,adjC=0,adjD=adj1):"cornr2"==adjType?(adjA=adj1,adjB=adj2,adjC=adj2,adjD=adj1):"cornrAll"==adjType?(adjA=adj1,adjB=adj1,adjC=adj1,adjD=adj1):"diag"==adjType&&(adjA=adj1,adjB=adj2,adjC=adj1,adjD=adj2);var d;return"round"==shapeType?d="M0,"+(h/2+(1-adjB)*(h/2))+" Q0,"+h+" "+adjB*(w/2)+","+h+" L"+(w/2+(1-adjC)*(w/2))+","+h+" Q"+w+","+h+" "+w+","+(h/2+h/2*(1-adjC))+"L"+w+","+h/2*adjD+" Q"+w+",0 "+(w/2+w/2*(1-adjD))+",0 L"+w/2*adjA+",0 Q0,0 0,"+h/2*adjA+" z":"snip"==shapeType&&(d="M0,"+adjA*(h/2)+" L0,"+(h/2+h/2*(1-adjB))+"L"+adjB*(w/2)+","+h+" L"+(w/2+w/2*(1-adjC))+","+h+"L"+w+","+(h/2+h/2*(1-adjC))+" L"+w+","+adjD*(h/2)+"L"+(w/2+w/2*(1-adjD))+",0 L"+w/2*adjA+",0 z"),d}function processPicNode(node,warpObj,source,sType){var resObj,rtrnData="",mediaPicFlag=!1,order=node.attrs.order,rid=node["p:blipFill"]["a:blip"].attrs["r:embed"];resObj="slideMasterBg"==source?warpObj.masterResObj:"slideLayoutBg"==source?warpObj.layoutResObj:warpObj.slideResObj;var imgName=resObj[rid].target,imgFileExt=extractFileExtension(imgName).toLowerCase(),zip=warpObj.zip,imgArrayBuffer=zip.file(imgName).asArrayBuffer(),mimeType="",xfrmNode=node["p:spPr"]["a:xfrm"];if(void 0===xfrmNode){var idx=getTextByPathList(node,["p:nvPicPr","p:nvPr","p:ph","attrs","idx"]);getTextByPathList(node,["p:nvPicPr","p:nvPr","p:ph","attrs","type"]);void 0!==idx&&(xfrmNode=getTextByPathList(warpObj.slideLayoutTables,["idxTable",idx,"p:spPr","a:xfrm"]))}var rotate=0,rotateNode=getTextByPathList(node,["p:spPr","a:xfrm","attrs","rot"]);void 0!==rotateNode&&(rotate=angleToDegrees(rotateNode));var vdoRid,vdoFile,vdoFileExt,vdoMimeType,uInt8Array,blob,vdoBlob,vdoNode=getTextByPathList(node,["p:nvPicPr","p:nvPr","a:videoFile"]),mediaSupportFlag=!1,isVdeoLink=!1,mediaProcess=settings.mediaProcess;if(void 0!==vdoNode&mediaProcess){vdoRid=vdoNode.attrs["r:link"],vdoFile=resObj[vdoRid].target;var checkIfLink=IsVideoLink(vdoFile);checkIfLink?(vdoFile=escapeHtml(vdoFile),isVdeoLink=!0,mediaSupportFlag=!0,mediaPicFlag=!0):(vdoFileExt=extractFileExtension(vdoFile).toLowerCase(),("mp4"==vdoFileExt||"webm"==vdoFileExt||"ogg"==vdoFileExt)&&(uInt8Array=zip.file(vdoFile).asArrayBuffer(),vdoMimeType=getMimeType(vdoFileExt),blob=new Blob([uInt8Array],{type:vdoMimeType}),vdoBlob=URL.createObjectURL(blob),mediaSupportFlag=!0,mediaPicFlag=!0))}var audioRid,audioFile,audioFileExt,uInt8ArrayAudio,blobAudio,audioBlob,audioObjc,audioNode=getTextByPathList(node,["p:nvPicPr","p:nvPr","a:audioFile"]),audioPlayerFlag=!1;if(void 0!==audioNode&mediaProcess&&(audioRid=audioNode.attrs["r:link"],audioFile=resObj[audioRid].target,audioFileExt=extractFileExtension(audioFile).toLowerCase(),"mp3"==audioFileExt||"wav"==audioFileExt||"ogg"==audioFileExt)){uInt8ArrayAudio=zip.file(audioFile).asArrayBuffer(),blobAudio=new Blob([uInt8ArrayAudio]),audioBlob=URL.createObjectURL(blobAudio);var cx=20*parseInt(xfrmNode["a:ext"].attrs.cx),cy=xfrmNode["a:ext"].attrs.cy,x=parseInt(xfrmNode["a:off"].attrs.x)/2.5,y=xfrmNode["a:off"].attrs.y;audioObjc={"a:ext":{attrs:{cx:cx,cy:cy}},"a:off":{attrs:{x:x,y:y}}},audioPlayerFlag=!0,mediaSupportFlag=!0,mediaPicFlag=!0}return mimeType=getMimeType(imgFileExt),rtrnData="<div class='block content' style='"+(mediaProcess&&audioPlayerFlag?getPosition(audioObjc,node,void 0,void 0):getPosition(xfrmNode,node,void 0,void 0))+(mediaProcess&&audioPlayerFlag?getSize(audioObjc,void 0,void 0):getSize(xfrmNode,void 0,void 0))+" z-index: "+order+";transform: rotate("+rotate+"deg);'>",void 0===vdoNode&&void 0===audioNode||!mediaProcess||!mediaSupportFlag?rtrnData+="<img src='data:"+mimeType+";base64,"+base64ArrayBuffer(imgArrayBuffer)+"' style='width: 100%; height: 100%'/>":(void 0!==vdoNode||void 0!==audioNode)&&mediaProcess&&mediaSupportFlag&&(void 0===vdoNode||isVdeoLink?void 0!==vdoNode&&isVdeoLink&&(rtrnData+="<iframe   src='"+vdoFile+"' controls style='width: 100%; height: 100%'></iframe >"):rtrnData+="<video  src='"+vdoBlob+"' controls style='width: 100%; height: 100%'>Your browser does not support the video tag.</video>",void 0!==audioNode&&(rtrnData+='<audio id="audio_player" controls ><source src="'+audioBlob+'"></audio>')),!mediaSupportFlag&&mediaPicFlag&&(rtrnData+="<span style='color:red;font-size:40px;position: absolute;'>This media file Not supported by HTML5</span>"),void 0===vdoNode&&void 0===audioNode||mediaProcess||!mediaSupportFlag||console.log("Founded supported media file but media process disabled (mediaProcess=false)"),rtrnData+="</div>"}function processGraphicFrameNode(node,warpObj,source,sType){var result="",graphicTypeUri=getTextByPathList(node,["a:graphic","a:graphicData","attrs","uri"]);switch(graphicTypeUri){case"http://schemas.openxmlformats.org/drawingml/2006/table":result=genTable(node,warpObj);break;case"http://schemas.openxmlformats.org/drawingml/2006/chart":result=genChart(node,warpObj);break;case"http://schemas.openxmlformats.org/drawingml/2006/diagram":result=genDiagram(node,warpObj,source,sType);break;case"http://schemas.openxmlformats.org/presentationml/2006/ole":var oleObjNode=getTextByPathList(node,["a:graphic","a:graphicData","mc:AlternateContent","mc:Fallback","p:oleObj"]);result=processGroupSpNode(oleObjNode,warpObj,source)}return result}function genTextBody(textBodyNode,spNode,slideLayoutSpNode,slideMasterSpNode,type,idx,warpObj,tbl_col_width){var text="";warpObj.slideMasterTextStyles;if(void 0===textBodyNode)return text;var pFontStyle=getTextByPathList(spNode,["p:style","a:fontRef"]),apNode=textBodyNode["a:p"];apNode.constructor!==Array&&(apNode=[apNode]);for(var i=0;i<apNode.length;i++){var pNode=apNode[i],rNode=pNode["a:r"],fldNode=pNode["a:fld"],brNode=pNode["a:br"];void 0!==rNode&&(rNode=rNode.constructor===Array?rNode:[rNode]),void 0!==rNode&&void 0!==fldNode&&(fldNode=fldNode.constructor===Array?fldNode:[fldNode],rNode=rNode.concat(fldNode)),void 0!==rNode&&void 0!==brNode&&(is_first_br=!0,brNode=brNode.constructor===Array?brNode:[brNode],brNode.forEach(function(item,indx){item.type="br"}),brNode.length>1&&brNode.shift(),rNode=rNode.concat(brNode),rNode.sort(function(a,b){return a.attrs.order-b.attrs.order}));var styleText="",marginsVer=getVerticalMargins(pNode,textBodyNode,type,idx,warpObj);""!=marginsVer&&(styleText=marginsVer),("body"==type||"obj"==type||"shape"==type)&&(styleText+="font-size: 0px;",styleText+="font-weight: normal;",styleText+="font-style: normal;");var cssName="";styleText in styleTable?cssName=styleTable[styleText].name:(cssName="_css_"+(Object.keys(styleTable).length+1),styleTable[styleText]={name:cssName,text:styleText});var prg_height_node,prg_width_node=getTextByPathList(spNode,["p:spPr","a:xfrm","a:ext","attrs","cx"]),sld_prg_width=void 0!==prg_width_node?"width:"+parseInt(prg_width_node)*slideFactor+"px;":"width:inherit;",sld_prg_height=void 0!==prg_height_node?"height:"+parseInt(prg_height_node)*slideFactor+"px;":"",prg_dir=getPregraphDir(pNode,textBodyNode,idx,type,warpObj);text+="<div style='display: flex;"+sld_prg_width+sld_prg_height+"' class='slide-prgrph "+getHorizontalAlign(pNode,textBodyNode,idx,type,prg_dir,warpObj)+" "+prg_dir+" "+cssName+"' >";var buText_ary=genBuChar(pNode,i,spNode,textBodyNode,pFontStyle,idx,type,warpObj),isBullate=void 0!==buText_ary[0]&&null!==buText_ary[0]&&""!=buText_ary[0]?!0:!1,bu_width=void 0!==buText_ary[1]&&null!==buText_ary[1]&&isBullate?buText_ary[1]+buText_ary[2]:0;text+=void 0!==buText_ary[0]?buText_ary[0]:"";var margin_ary=getPregraphMargn(pNode,idx,type,isBullate,warpObj),margin=margin_ary[0],mrgin_val=margin_ary[1];void 0===prg_width_node&&void 0!==tbl_col_width&&0!=prg_width_node&&(prg_width_node=tbl_col_width);var prgrph_text="",total_text_len=0;if(void 0===rNode&&void 0!==pNode){var prgr_text=genSpanElement(pNode,void 0,spNode,textBodyNode,pFontStyle,slideLayoutSpNode,idx,type,1,warpObj,isBullate);if(isBullate){var txt_obj=$(prgr_text).css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden"}).appendTo($("body"));total_text_len+=txt_obj.outerWidth(),txt_obj.remove()}prgrph_text+=prgr_text}else if(void 0!==rNode)for(var j=0;j<rNode.length;j++){var prgr_text=genSpanElement(rNode[j],j,pNode,textBodyNode,pFontStyle,slideLayoutSpNode,idx,type,rNode.length,warpObj,isBullate);if(isBullate){var txt_obj=$(prgr_text).css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden"}).appendTo($("body"));total_text_len+=txt_obj.outerWidth(),txt_obj.remove()}prgrph_text+=prgr_text}prg_width_node=parseInt(prg_width_node)*slideFactor-bu_width-mrgin_val,isBullate&&prg_width_node>total_text_len&&(prg_width_node=total_text_len+bu_width);var prg_width=void 0!==prg_width_node?"width:"+prg_width_node+"px;":"width:inherit;";text+="<div style='height: 100%;direction: initial;overflow-wrap:break-word;word-wrap: break-word;"+prg_width+margin+"' >",text+=prgrph_text,text+="</div>",text+="</div>"}return text}function genBuChar(node,i,spNode,textBodyNode,pFontStyle,idx,type,warpObj){var lstStyle=(warpObj.slideMasterTextStyles,textBodyNode["a:lstStyle"]),rNode=getTextByPathList(node,["a:r"]);void 0!==rNode&&rNode.constructor===Array&&(rNode=rNode[0]);var lvl=parseInt(getTextByPathList(node["a:pPr"],["attrs","lvl"]))+1;isNaN(lvl)&&(lvl=1);var dfltBultColor,dfltBultSize,bultColor,bultSize,color_tye,lvlStr="a:lvl"+lvl+"pPr";if(void 0===rNode)return"";dfltBultColor=getFontColorPr(rNode,spNode,lstStyle,pFontStyle,lvl,idx,type,warpObj),color_tye=dfltBultColor[2],dfltBultSize=getFontSize(rNode,textBodyNode,pFontStyle,lvl,type,warpObj);var bullet="",marRStr="",marLStr="",margin_val=0,font_val=0,pPrNode=node["a:pPr"],BullNONE=getTextByPathList(pPrNode,["a:buNone"]);if(void 0!==BullNONE)return"";var buType="TYPE_NONE",layoutMasterNode=getLayoutAndMasterNode(node,idx,type,warpObj),pPrNodeLaout=layoutMasterNode.nodeLaout,pPrNodeMaster=layoutMasterNode.nodeMaster,buChar=getTextByPathList(pPrNode,["a:buChar","attrs","char"]),buNum=getTextByPathList(pPrNode,["a:buAutoNum","attrs","type"]),buPic=getTextByPathList(pPrNode,["a:buBlip"]);void 0!==buChar&&(buType="TYPE_BULLET"),void 0!==buNum&&(buType="TYPE_NUMERIC"),void 0!==buPic&&(buType="TYPE_BULPIC");var buFontSize=getTextByPathList(pPrNode,["a:buSzPts","attrs","val"]);if(void 0===buFontSize){if(buFontSize=getTextByPathList(pPrNode,["a:buSzPct","attrs","val"]),void 0!==buFontSize){var prcnt=parseInt(buFontSize)/1e5,dfltBultSizeNoPt=parseInt(dfltBultSize,"px");bultSize=prcnt*parseInt(dfltBultSizeNoPt)+"px"}}else bultSize=parseInt(buFontSize)/100*fontSizeFactor+"px";var buClrNode=getTextByPathList(pPrNode,["a:buClr"]);if(void 0===buChar&&void 0===buNum&&void 0===buPic&&void 0!==lstStyle){if(BullNONE=getTextByPathList(lstStyle,[lvlStr,"a:buNone"]),void 0!==BullNONE)return"";buType="TYPE_NONE",buChar=getTextByPathList(lstStyle,[lvlStr,"a:buChar","attrs","char"]),buNum=getTextByPathList(lstStyle,[lvlStr,"a:buAutoNum","attrs","type"]),buPic=getTextByPathList(lstStyle,[lvlStr,"a:buBlip"]),void 0!==buChar&&(buType="TYPE_BULLET"),void 0!==buNum&&(buType="TYPE_NUMERIC"),void 0!==buPic&&(buType="TYPE_BULPIC"),(void 0!==buChar||void 0!==buNum||void 0!==buPic)&&(pPrNode=lstStyle[lvlStr])}if(void 0===buChar&&void 0===buNum&&void 0===buPic){if(void 0!==pPrNodeLaout){if(BullNONE=getTextByPathList(pPrNodeLaout,["a:buNone"]),void 0!==BullNONE)return"";buType="TYPE_NONE",buChar=getTextByPathList(pPrNodeLaout,["a:buChar","attrs","char"]),buNum=getTextByPathList(pPrNodeLaout,["a:buAutoNum","attrs","type"]),buPic=getTextByPathList(pPrNodeLaout,["a:buBlip"]),void 0!==buChar&&(buType="TYPE_BULLET"),void 0!==buNum&&(buType="TYPE_NUMERIC"),void 0!==buPic&&(buType="TYPE_BULPIC")}if(void 0===buChar&&void 0===buNum&&void 0===buPic&&void 0!==pPrNodeMaster){if(BullNONE=getTextByPathList(pPrNodeMaster,["a:buNone"]),void 0!==BullNONE)return"";buType="TYPE_NONE",buChar=getTextByPathList(pPrNodeMaster,["a:buChar","attrs","char"]),buNum=getTextByPathList(pPrNodeMaster,["a:buAutoNum","attrs","type"]),buPic=getTextByPathList(pPrNodeMaster,["a:buBlip"]),void 0!==buChar&&(buType="TYPE_BULLET"),void 0!==buNum&&(buType="TYPE_NUMERIC"),void 0!==buPic&&(buType="TYPE_BULPIC")}}var getRtlVal=getTextByPathList(pPrNode,["attrs","rtl"]);void 0===getRtlVal&&(getRtlVal=getTextByPathList(pPrNodeLaout,["attrs","rtl"]),void 0===getRtlVal&&"shape"!=type&&(getRtlVal=getTextByPathList(pPrNodeMaster,["attrs","rtl"])));var isRTL=!1;void 0!==getRtlVal&&"1"==getRtlVal&&(isRTL=!0);var alignNode=getTextByPathList(pPrNode,["attrs","algn"]);void 0===alignNode&&(alignNode=getTextByPathList(pPrNodeLaout,["attrs","algn"]),void 0===alignNode&&(alignNode=getTextByPathList(pPrNodeMaster,["attrs","algn"])));var indentNode=getTextByPathList(pPrNode,["attrs","indent"]);void 0===indentNode&&(indentNode=getTextByPathList(pPrNodeLaout,["attrs","indent"]),void 0===indentNode&&(indentNode=getTextByPathList(pPrNodeMaster,["attrs","indent"])));var indent=0;void 0!==indentNode&&(indent=parseInt(indentNode)*slideFactor);var marLNode=getTextByPathList(pPrNode,["attrs","marL"]);if(void 0===marLNode&&(marLNode=getTextByPathList(pPrNodeLaout,["attrs","marL"]),void 0===marLNode&&(marLNode=getTextByPathList(pPrNodeMaster,["attrs","marL"]))),void 0!==marLNode){var marginLeft=parseInt(marLNode)*slideFactor;marLStr=isRTL?"padding-right:":"padding-left:",margin_val=0>marginLeft+indent?0:marginLeft+indent,marLStr+=margin_val+"px;"}var marRNode=getTextByPathList(pPrNode,["attrs","marR"]);if(void 0===marRNode&&void 0===marLNode&&(marRNode=getTextByPathList(pPrNodeLaout,["attrs","marR"]),void 0===marRNode&&(marRNode=getTextByPathList(pPrNodeMaster,["attrs","marR"]))),void 0!==marRNode){var marginRight=parseInt(marRNode)*slideFactor;marLStr=isRTL?"padding-right:":"padding-left:",marRStr+=(0>marginRight+indent?0:marginRight+indent)+"px;"}void 0===buClrNode&&(buClrNode=getTextByPathList(lstStyle,[lvlStr,"a:buClr"])),void 0===buClrNode&&(buClrNode=getTextByPathList(pPrNodeLaout,["a:buClr"]),void 0===buClrNode&&(buClrNode=getTextByPathList(pPrNodeMaster,["a:buClr"])));var defBultColor;if(void 0!==buClrNode?defBultColor=getSolidFill(buClrNode,void 0,void 0,warpObj):void 0!==pFontStyle&&(defBultColor=getSolidFill(pFontStyle,void 0,void 0,warpObj)),void 0===defBultColor||"NONE"==defBultColor?bultColor=dfltBultColor:(bultColor=[defBultColor,"","solid"],color_tye="solid"),void 0===buFontSize)if(buFontSize=getTextByPathList(pPrNodeLaout,["a:buSzPts","attrs","val"]),void 0===buFontSize){if(buFontSize=getTextByPathList(pPrNodeLaout,["a:buSzPct","attrs","val"]),void 0!==buFontSize){var prcnt=parseInt(buFontSize)/1e5,dfltBultSizeNoPt=parseInt(dfltBultSize,"px");bultSize=prcnt*parseInt(dfltBultSizeNoPt)+"px"}}else bultSize=parseInt(buFontSize)/100*fontSizeFactor+"px";if(void 0===buFontSize)if(buFontSize=getTextByPathList(pPrNodeMaster,["a:buSzPts","attrs","val"]),void 0===buFontSize){if(buFontSize=getTextByPathList(pPrNodeMaster,["a:buSzPct","attrs","val"]),void 0!==buFontSize){var prcnt=parseInt(buFontSize)/1e5,dfltBultSizeNoPt=parseInt(dfltBultSize,"px");bultSize=prcnt*parseInt(dfltBultSizeNoPt)+"px"}}else bultSize=parseInt(buFontSize)/100*fontSizeFactor+"px";if(void 0===buFontSize&&(bultSize=dfltBultSize),font_val=parseInt(bultSize,"px"),"TYPE_BULLET"==buType){var typefaceNode=getTextByPathList(pPrNode,["a:buFont","attrs","typeface"]),typeface="";if(void 0!==typefaceNode&&(typeface="font-family: "+typefaceNode),bullet="<div style='height: 100%;"+typeface+";"+marLStr+marRStr+"font-size:"+bultSize+";","solid"==color_tye)void 0!==bultColor[0]&&""!=bultColor[0]&&(bullet+="color:#"+bultColor[0]+"; "),void 0!==bultColor[1]&&""!=bultColor[1]&&";"!=bultColor[1]&&(bullet+="text-shadow:"+bultColor[1]+";");else if("pattern"==color_tye||"pic"==color_tye||"gradient"==color_tye){if("pattern"==color_tye)bullet+="background:"+bultColor[0][0]+";",null!==bultColor[0][1]&&void 0!==bultColor[0][1]&&""!=bultColor[0][1]&&(bullet+="background-size:"+bultColor[0][1]+";"),null!==bultColor[0][2]&&void 0!==bultColor[0][2]&&""!=bultColor[0][2]&&(bullet+="background-position:"+bultColor[0][2]+";");else if("pic"==color_tye)bullet+=bultColor[0]+";";else if("gradient"==color_tye){var colorAry=bultColor[0].color,rot=bultColor[0].rot;bullet+="background: linear-gradient("+rot+"deg,";for(var i=0;i<colorAry.length;i++)bullet+=i==colorAry.length-1?"#"+colorAry[i]+");":"#"+colorAry[i]+", "}bullet+="-webkit-background-clip: text;background-clip: text;color: transparent;",void 0!==bultColor[1].border&&""!==bultColor[1].border&&(bullet+="-webkit-text-stroke: "+bultColor[1].border+";"),void 0!==bultColor[1].effcts&&""!==bultColor[1].effcts&&(bullet+="filter: "+bultColor[1].effcts+";")}isRTL&&(bullet+="white-space: nowrap ;direction:rtl");var isIE11=!!window.MSInputMethodContext&&!!document.documentMode,htmlBu=buChar;isIE11||(htmlBu=getHtmlBullet(typefaceNode,buChar)),bullet+="'><div style='line-height: "+font_val/2+"px;'>"+htmlBu+"</div></div>"}else if("TYPE_NUMERIC"==buType)bullet="<div style='height: 100%;"+marLStr+marRStr+"color:#"+bultColor[0]+";font-size:"+bultSize+";",bullet+=isRTL?"display: inline-block;white-space: nowrap ;direction:rtl;":"display: inline-block;white-space: nowrap ;direction:ltr;",bullet+="' data-bulltname = '"+buNum+"' data-bulltlvl = '"+lvl+"' class='numeric-bullet-style'></div>";else if("TYPE_BULPIC"==buType){var buImg,buPicId=getTextByPathList(buPic,["a:blip","attrs","r:embed"]);if(void 0!==buPicId){var imgPath=warpObj.slideResObj[buPicId].target,imgArrayBuffer=warpObj.zip.file(imgPath).asArrayBuffer(),imgExt=imgPath.split(".").pop(),imgMimeType=getMimeType(imgExt);buImg="<img src='data:"+imgMimeType+";base64,"+base64ArrayBuffer(imgArrayBuffer)+"' style='width: 100%;'/>"}void 0===buPicId&&(buImg="&#8227;"),bullet="<div style='height: 100%;"+marLStr+marRStr+"width:"+bultSize+";display: inline-block; ",isRTL&&(bullet+="display: inline-block;white-space: nowrap ;direction:rtl;"),bullet+="'>"+buImg+"  </div>"}return[bullet,margin_val,font_val]}function getHtmlBullet(typefaceNode,buChar){switch(buChar){case"§":return"&#9632;";case"q":return"&#10065;";case"v":return"&#10070;";case"Ø":return"&#11162;";case"ü":return"&#10004;";default:if("Wingdings 2"==typefaceNode||"Wingdings 3"==typefaceNode){var wingCharCode=getDingbatToUnicode(typefaceNode,buChar);if(null!==wingCharCode)return"&#"+wingCharCode+";"}return"&#"+buChar.charCodeAt(0)+";"}}function getDingbatToUnicode(typefaceNode,buChar){if(dingbat_unicode){for(var dingbat_code=4095&buChar.codePointAt(0),char_unicode=null,len=dingbat_unicode.length,i=0;len--;){var item=dingbat_unicode[i];if(item.f==typefaceNode&&item.code==dingbat_code){char_unicode=item.unicode;break}i++}return char_unicode}}function getLayoutAndMasterNode(node,idx,type,warpObj){var pPrNodeLaout,pPrNodeMaster,pPrNode=node["a:pPr"],lvl=1,lvlNode=getTextByPathList(pPrNode,["attrs","lvl"]);if(void 0!==lvlNode&&(lvl=parseInt(lvlNode)+1),void 0!==idx&&(pPrNodeLaout=getTextByPathList(warpObj.slideLayoutTables.idxTable[idx],["p:txBody","a:lstStyle","a:lvl"+lvl+"pPr"]),void 0===pPrNodeLaout&&(pPrNodeLaout=getTextByPathList(warpObj.slideLayoutTables.idxTable[idx],["p:txBody","a:p","a:pPr"]),void 0===pPrNodeLaout&&(pPrNodeLaout=getTextByPathList(warpObj.slideLayoutTables.idxTable[idx],["p:txBody","a:p",lvl-1,"a:pPr"])))),void 0!==type){var lvlStr="a:lvl"+lvl+"pPr";void 0===pPrNodeLaout&&(pPrNodeLaout=getTextByPathList(warpObj,["slideLayoutTables","typeTable",type,"p:txBody","a:lstStyle",lvlStr])),pPrNodeMaster="title"==type||"ctrTitle"==type?getTextByPathList(warpObj,["slideMasterTextStyles","p:titleStyle",lvlStr]):"body"==type||"obj"==type||"subTitle"==type?getTextByPathList(warpObj,["slideMasterTextStyles","p:bodyStyle",lvlStr]):"shape"==type||"diagram"==type?getTextByPathList(warpObj,["slideMasterTextStyles","p:otherStyle",lvlStr]):"textBox"==type?getTextByPathList(warpObj,["defaultTextStyle",lvlStr]):getTextByPathList(warpObj,["slideMasterTables","typeTable",type,"p:txBody","a:lstStyle",lvlStr])}return{nodeLaout:pPrNodeLaout,nodeMaster:pPrNodeMaster}}function genSpanElement(node,rIndex,pNode,textBodyNode,pFontStyle,slideLayoutSpNode,idx,type,rNodeLength,warpObj,isBullate){var text_style="",lstStyle=textBodyNode["a:lstStyle"],slideMasterTextStyles=warpObj.slideMasterTextStyles,text=node["a:t"],openElemnt="<sapn",closeElemnt="</sapn>",styleText="";if(void 0===text&&void 0!==node.type){if(is_first_br)return is_first_br=!1,"<sapn class='line-break-br' ></sapn>";styleText+="display: block;"}else is_first_br=!0;"string"!=typeof text&&(text=getTextByPathList(node,["a:fld","a:t"]),"string"!=typeof text&&(text="&nbsp;"));var pPrNode=pNode["a:pPr"],lvl=1,lvlNode=getTextByPathList(pPrNode,["attrs","lvl"]);void 0!==lvlNode&&(lvl=parseInt(lvlNode)+1);var layoutMasterNode=getLayoutAndMasterNode(pNode,idx,type,warpObj),pPrNodeLaout=layoutMasterNode.nodeLaout,pPrNodeMaster=layoutMasterNode.nodeMaster,lang=getTextByPathList(node,["a:rPr","attrs","lang"]),isRtlLan=void 0!==lang&&-1!==rtl_langs_array.indexOf(lang)?!0:!1,getRtlVal=getTextByPathList(pPrNode,["attrs","rtl"]);void 0===getRtlVal&&(getRtlVal=getTextByPathList(pPrNodeLaout,["attrs","rtl"]),void 0===getRtlVal&&"shape"!=type&&(getRtlVal=getTextByPathList(pPrNodeMaster,["attrs","rtl"])));var isRTL=!1,dirStr="ltr";void 0!==getRtlVal&&"1"==getRtlVal&&(isRTL=!0,dirStr="rtl");var defLinkClr,linkID=getTextByPathList(node,["a:rPr","a:hlinkClick","attrs","r:id"]),linkTooltip="";if(void 0!==linkID){linkTooltip=getTextByPathList(node,["a:rPr","a:hlinkClick","attrs","tooltip"]),void 0!==linkTooltip&&(linkTooltip="title='"+linkTooltip+"'"),defLinkClr=getSchemeColorFromTheme("a:hlink",void 0,void 0,warpObj);var linkClrNode=getTextByPathList(node,["a:rPr","a:solidFill"]),rPrlinkClr=getSolidFill(linkClrNode,void 0,void 0,warpObj);void 0!==rPrlinkClr&&""!=rPrlinkClr&&(defLinkClr=rPrlinkClr)}var fontClrPr=getFontColorPr(node,pNode,lstStyle,pFontStyle,lvl,idx,type,warpObj),fontClrType=fontClrPr[2];if("solid"==fontClrType)void 0===linkID&&void 0!==fontClrPr[0]&&""!=fontClrPr[0]?styleText+="color: #"+fontClrPr[0]+";":void 0!==linkID&&void 0!==defLinkClr&&(styleText+="color: #"+defLinkClr+";"),void 0!==fontClrPr[1]&&""!=fontClrPr[1]&&";"!=fontClrPr[1]&&(styleText+="text-shadow:"+fontClrPr[1]+";"),void 0!==fontClrPr[3]&&""!=fontClrPr[3]&&(styleText+="background-color: #"+fontClrPr[3]+";");else if("pattern"==fontClrType||"pic"==fontClrType||"gradient"==fontClrType){if("pattern"==fontClrType)styleText+="background:"+fontClrPr[0][0]+";",null!==fontClrPr[0][1]&&void 0!==fontClrPr[0][1]&&""!=fontClrPr[0][1]&&(styleText+="background-size:"+fontClrPr[0][1]+";"),null!==fontClrPr[0][2]&&void 0!==fontClrPr[0][2]&&""!=fontClrPr[0][2]&&(styleText+="background-position:"+fontClrPr[0][2]+";");else if("pic"==fontClrType)styleText+=fontClrPr[0]+";";else if("gradient"==fontClrType){var colorAry=fontClrPr[0].color,rot=fontClrPr[0].rot;styleText+="background: linear-gradient("+rot+"deg,";for(var i=0;i<colorAry.length;i++)styleText+=i==colorAry.length-1?"#"+colorAry[i]+");":"#"+colorAry[i]+", "}styleText+="-webkit-background-clip: text;background-clip: text;color: transparent;",void 0!==fontClrPr[1].border&&""!==fontClrPr[1].border&&(styleText+="-webkit-text-stroke: "+fontClrPr[1].border+";"),void 0!==fontClrPr[1].effcts&&""!==fontClrPr[1].effcts&&(styleText+="filter: "+fontClrPr[1].effcts+";")}var font_size=getFontSize(node,textBodyNode,pFontStyle,lvl,type,warpObj);text_style+="font-size:"+font_size+";font-family:"+getFontType(node,type,warpObj,pFontStyle)+";font-weight:"+getFontBold(node,type,slideMasterTextStyles)+";font-style:"+getFontItalic(node,type,slideMasterTextStyles)+";text-decoration:"+getFontDecoration(node,type,slideMasterTextStyles)+";text-align:"+getTextHorizontalAlign(node,pNode,type,warpObj)+";vertical-align:"+getTextVerticalAlign(node,type,slideMasterTextStyles)+";",styleText+=isRtlLan?"direction:rtl;":"direction:ltr;";var highlight=getTextByPathList(node,["a:rPr","a:highlight"]);void 0!==highlight&&(styleText+="background-color:#"+getSolidFill(highlight,void 0,void 0,warpObj)+";");var spcNode=getTextByPathList(node,["a:rPr","attrs","spc"]);if(void 0===spcNode&&(spcNode=getTextByPathList(pPrNodeLaout,["a:defRPr","attrs","spc"]),void 0===spcNode&&(spcNode=getTextByPathList(pPrNodeMaster,["a:defRPr","attrs","spc"]))),void 0!==spcNode){var ltrSpc=parseInt(spcNode)/100;styleText+="letter-spacing: "+ltrSpc+"px;"}var capNode=getTextByPathList(node,["a:rPr","attrs","cap"]);void 0===capNode&&(capNode=getTextByPathList(pPrNodeLaout,["a:defRPr","attrs","cap"]),void 0===capNode&&(capNode=getTextByPathList(pPrNodeMaster,["a:defRPr","attrs","cap"]))),("small"==capNode||"all"==capNode)&&(styleText+="text-transform: uppercase");var cssName="";styleText in styleTable?cssName=styleTable[styleText].name:(cssName="_css_"+(Object.keys(styleTable).length+1),styleTable[styleText]={name:cssName,text:styleText});var linkColorSyle="";if("solid"==fontClrType&&void 0!==linkID&&(linkColorSyle="style='color: inherit;'"),void 0!==linkID&&""!=linkID){var linkURL=warpObj.slideResObj[linkID].target;return linkURL=escapeHtml(linkURL),openElemnt+" class='text-block "+cssName+"' style='"+text_style+"'><a href='"+linkURL+"' "+linkColorSyle+"  "+linkTooltip+" target='_blank'>"+text.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\s/g,"&nbsp;")+"</a>"+closeElemnt}return openElemnt+" class='text-block "+cssName+"' style='"+text_style+"'>"+text.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\s/g,"&nbsp;")+closeElemnt}function getPregraphMargn(pNode,idx,type,isBullate,warpObj){if(!isBullate)return["",0];var marLStr="",marRStr="",maginVal=0,pPrNode=pNode["a:pPr"],layoutMasterNode=getLayoutAndMasterNode(pNode,idx,type,warpObj),pPrNodeLaout=layoutMasterNode.nodeLaout,pPrNodeMaster=layoutMasterNode.nodeMaster,getRtlVal=getTextByPathList(pPrNode,["attrs","rtl"]);void 0===getRtlVal&&(getRtlVal=getTextByPathList(pPrNodeLaout,["attrs","rtl"]),void 0===getRtlVal&&"shape"!=type&&(getRtlVal=getTextByPathList(pPrNodeMaster,["attrs","rtl"])));var isRTL=!1,dirStr="ltr";void 0!==getRtlVal&&"1"==getRtlVal&&(isRTL=!0,dirStr="rtl");var alignNode=getTextByPathList(pPrNode,["attrs","algn"]);void 0===alignNode&&(alignNode=getTextByPathList(pPrNodeLaout,["attrs","algn"]),void 0===alignNode&&(alignNode=getTextByPathList(pPrNodeMaster,["attrs","algn"])));var indentNode=getTextByPathList(pPrNode,["attrs","indent"]);void 0===indentNode&&(indentNode=getTextByPathList(pPrNodeLaout,["attrs","indent"]),void 0===indentNode&&(indentNode=getTextByPathList(pPrNodeMaster,["attrs","indent"])));var indent=0;void 0!==indentNode&&(indent=parseInt(indentNode)*slideFactor);var marLNode=getTextByPathList(pPrNode,["attrs","marL"]);void 0===marLNode&&(marLNode=getTextByPathList(pPrNodeLaout,["attrs","marL"]),void 0===marLNode&&(marLNode=getTextByPathList(pPrNodeMaster,["attrs","marL"])));var marginLeft=0;void 0!==marLNode&&(marginLeft=parseInt(marLNode)*slideFactor),(void 0!==indentNode||void 0!==marLNode)&&(marLStr=isRTL?"padding-right: ":"padding-left: ",isBullate?(maginVal=Math.abs(0-indent),marLStr+=maginVal+"px;"):(maginVal=Math.abs(marginLeft+indent),marLStr+=maginVal+"px;"));var marRNode=getTextByPathList(pPrNode,["attrs","marR"]);if(void 0===marRNode&&void 0===marLNode&&(marRNode=getTextByPathList(pPrNodeLaout,["attrs","marR"]),void 0===marRNode&&(marRNode=getTextByPathList(pPrNodeMaster,["attrs","marR"]))),void 0!==marRNode&&isBullate){parseInt(marRNode)*slideFactor;marRStr=isRTL?"padding-right: ":"padding-left: ",marRStr+=Math.abs(0-indent)+"px;"}return[marLStr,maginVal]}function genGlobalCSS(){var cssText="";for(var key in styleTable){var tagname="";cssText+=tagname+" ."+styleTable[key].name+(styleTable[key].suffix?styleTable[key].suffix:"")+"{"+styleTable[key].text+"}\n"}return settings.slideMode&&"divs2slidesjs"==settings.slideType&&(cssText+="#all_slides_warpper{margin-right: auto;margin-left: auto;padding-top:10px;width: "+slideWidth+"px;}\n"),cssText}function genTable(node,warpObj){var order=node.attrs.order,tableNode=getTextByPathList(node,["a:graphic","a:graphicData","a:tbl"]),xfrmNode=getTextByPathList(node,["p:xfrm"]),getTblPr=getTextByPathList(node,["a:graphic","a:graphicData","a:tbl","a:tblPr"]),getColsGrid=getTextByPathList(node,["a:graphic","a:graphicData","a:tbl","a:tblGrid","a:gridCol"]),tblDir="";if(void 0!==getTblPr){var isRTL=getTblPr.attrs.rtl;tblDir=1==isRTL?"dir=rtl":"dir=ltr"}var thisTblStyle,firstRowAttr=getTblPr.attrs.firstRow,firstColAttr=getTblPr.attrs.firstCol,lastRowAttr=getTblPr.attrs.lastRow,lastColAttr=getTblPr.attrs.lastCol,bandRowAttr=getTblPr.attrs.bandRow,bandColAttr=getTblPr.attrs.bandCol,tblStylAttrObj={isFrstRowAttr:void 0!==firstRowAttr&&"1"==firstRowAttr?1:0,isFrstColAttr:void 0!==firstColAttr&&"1"==firstColAttr?1:0,isLstRowAttr:void 0!==lastRowAttr&&"1"==lastRowAttr?1:0,isLstColAttr:void 0!==lastColAttr&&"1"==lastColAttr?1:0,isBandRowAttr:void 0!==bandRowAttr&&"1"==bandRowAttr?1:0,isBandColAttr:void 0!==bandColAttr&&"1"==bandColAttr?1:0},tbleStyleId=getTblPr["a:tableStyleId"];if(void 0!==tbleStyleId){var tbleStylList=tableStyles["a:tblStyleLst"]["a:tblStyle"];
if(void 0!==tbleStylList)if(tbleStylList.constructor===Array)for(var k=0;k<tbleStylList.length;k++)tbleStylList[k].attrs.styleId==tbleStyleId&&(thisTblStyle=tbleStylList[k]);else tbleStylList.attrs.styleId==tbleStyleId&&(thisTblStyle=tbleStylList)}void 0!==thisTblStyle&&(thisTblStyle.tblStylAttrObj=tblStylAttrObj,warpObj.thisTbiStyle=thisTblStyle);var tblStyl=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcStyle"]),tblBorderStyl=getTextByPathList(tblStyl,["a:tcBdr"]),tbl_borders="";void 0!==tblBorderStyl&&(tbl_borders=getTableBorders(tblBorderStyl,warpObj));var tbl_bgcolor="",tbl_bgFillschemeClr=getTextByPathList(thisTblStyle,["a:tblBg","a:fillRef"]);void 0!==tbl_bgFillschemeClr&&(tbl_bgcolor=getSolidFill(tbl_bgFillschemeClr,void 0,void 0,warpObj)),void 0===tbl_bgFillschemeClr&&(tbl_bgFillschemeClr=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcStyle","a:fill","a:solidFill"]),tbl_bgcolor=getSolidFill(tbl_bgFillschemeClr,void 0,void 0,warpObj)),""!==tbl_bgcolor&&(tbl_bgcolor="background-color: #"+tbl_bgcolor+";");var tableHtml="<table "+tblDir+" style='border-collapse: collapse;"+getPosition(xfrmNode,node,void 0,void 0)+getSize(xfrmNode,void 0,void 0)+" z-index: "+order+";"+tbl_borders+";"+tbl_bgcolor+"'>",trNodes=tableNode["a:tr"];trNodes.constructor!==Array&&(trNodes=[trNodes]);for(var totalrowSpan=0,rowSpanAry=[],i=0;i<trNodes.length;i++){var rowHeightParam=trNodes[i].attrs.h,rowHeight=0,rowsStyl="";void 0!==rowHeightParam&&(rowHeight=parseInt(rowHeightParam)*slideFactor,rowsStyl+="height:"+rowHeight+"px;");var band_1H_fillColor,band_2H_fillColor,fillColor="",row_borders="",fontClrPr="",fontWeight="";if(void 0!==thisTblStyle&&void 0!==thisTblStyle["a:wholeTbl"]){var bgFillschemeClr=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcStyle","a:fill","a:solidFill"]);if(void 0!==bgFillschemeClr){var local_fillColor=getSolidFill(bgFillschemeClr,void 0,void 0,warpObj);void 0!==local_fillColor&&(fillColor=local_fillColor)}var rowTxtStyl=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcTxStyle"]);if(void 0!==rowTxtStyl){var local_fontColor=getSolidFill(rowTxtStyl,void 0,void 0,warpObj);void 0!==local_fontColor&&(fontClrPr=local_fontColor);var local_fontWeight="on"==getTextByPathList(rowTxtStyl,["attrs","b"])?"bold":"";""!=local_fontWeight&&(fontWeight=local_fontWeight)}}if(0==i&&1==tblStylAttrObj.isFrstRowAttr&&void 0!==thisTblStyle){var bgFillschemeClr=getTextByPathList(thisTblStyle,["a:firstRow","a:tcStyle","a:fill","a:solidFill"]);if(void 0!==bgFillschemeClr){var local_fillColor=getSolidFill(bgFillschemeClr,void 0,void 0,warpObj);void 0!==local_fillColor&&(fillColor=local_fillColor)}var borderStyl=getTextByPathList(thisTblStyle,["a:firstRow","a:tcStyle","a:tcBdr"]);if(void 0!==borderStyl){var local_row_borders=getTableBorders(borderStyl,warpObj);""!=local_row_borders&&(row_borders=local_row_borders)}var rowTxtStyl=getTextByPathList(thisTblStyle,["a:firstRow","a:tcTxStyle"]);if(void 0!==rowTxtStyl){var local_fontClrPr=getSolidFill(rowTxtStyl,void 0,void 0,warpObj);void 0!==local_fontClrPr&&(fontClrPr=local_fontClrPr);var local_fontWeight="on"==getTextByPathList(rowTxtStyl,["attrs","b"])?"bold":"";""!==local_fontWeight&&(fontWeight=local_fontWeight)}}else if(i>0&&1==tblStylAttrObj.isBandRowAttr&&void 0!==thisTblStyle){if(fillColor="",row_borders=void 0,i%2==0&&void 0!==thisTblStyle["a:band2H"]){var bgFillschemeClr=getTextByPathList(thisTblStyle,["a:band2H","a:tcStyle","a:fill","a:solidFill"]);if(void 0!==bgFillschemeClr){var local_fillColor=getSolidFill(bgFillschemeClr,void 0,void 0,warpObj);""!==local_fillColor&&(fillColor=local_fillColor,band_2H_fillColor=local_fillColor)}var borderStyl=getTextByPathList(thisTblStyle,["a:band2H","a:tcStyle","a:tcBdr"]);if(void 0!==borderStyl){var local_row_borders=getTableBorders(borderStyl,warpObj);""!=local_row_borders&&(row_borders=local_row_borders)}var rowTxtStyl=getTextByPathList(thisTblStyle,["a:band2H","a:tcTxStyle"]);if(void 0!==rowTxtStyl){var local_fontClrPr=getSolidFill(rowTxtStyl,void 0,void 0,warpObj);void 0!==local_fontClrPr&&(fontClrPr=local_fontClrPr)}var local_fontWeight="on"==getTextByPathList(rowTxtStyl,["attrs","b"])?"bold":"";""!==local_fontWeight&&(fontWeight=local_fontWeight)}if(i%2!=0&&void 0!==thisTblStyle["a:band1H"]){var bgFillschemeClr=getTextByPathList(thisTblStyle,["a:band1H","a:tcStyle","a:fill","a:solidFill"]);if(void 0!==bgFillschemeClr){var local_fillColor=getSolidFill(bgFillschemeClr,void 0,void 0,warpObj);void 0!==local_fillColor&&(fillColor=local_fillColor,band_1H_fillColor=local_fillColor)}var borderStyl=getTextByPathList(thisTblStyle,["a:band1H","a:tcStyle","a:tcBdr"]);if(void 0!==borderStyl){var local_row_borders=getTableBorders(borderStyl,warpObj);""!=local_row_borders&&(row_borders=local_row_borders)}var rowTxtStyl=getTextByPathList(thisTblStyle,["a:band1H","a:tcTxStyle"]);if(void 0!==rowTxtStyl){var local_fontClrPr=getSolidFill(rowTxtStyl,void 0,void 0,warpObj);void 0!==local_fontClrPr&&(fontClrPr=local_fontClrPr);var local_fontWeight="on"==getTextByPathList(rowTxtStyl,["attrs","b"])?"bold":"";""!=local_fontWeight&&(fontWeight=local_fontWeight)}}}if(i==trNodes.length-1&&1==tblStylAttrObj.isLstRowAttr&&void 0!==thisTblStyle){var bgFillschemeClr=getTextByPathList(thisTblStyle,["a:lastRow","a:tcStyle","a:fill","a:solidFill"]);if(void 0!==bgFillschemeClr){var local_fillColor=getSolidFill(bgFillschemeClr,void 0,void 0,warpObj);void 0!==local_fillColor&&(fillColor=local_fillColor)}var borderStyl=getTextByPathList(thisTblStyle,["a:lastRow","a:tcStyle","a:tcBdr"]);if(void 0!==borderStyl){var local_row_borders=getTableBorders(borderStyl,warpObj);""!=local_row_borders&&(row_borders=local_row_borders)}var rowTxtStyl=getTextByPathList(thisTblStyle,["a:lastRow","a:tcTxStyle"]);if(void 0!==rowTxtStyl){var local_fontClrPr=getSolidFill(rowTxtStyl,void 0,void 0,warpObj);void 0!==local_fontClrPr&&(fontClrPr=local_fontClrPr);var local_fontWeight="on"==getTextByPathList(rowTxtStyl,["attrs","b"])?"bold":"";""!==local_fontWeight&&(fontWeight=local_fontWeight)}}rowsStyl+=void 0!==row_borders?row_borders:"",rowsStyl+=void 0!==fontClrPr?" color: #"+fontClrPr+";":"",rowsStyl+=""!=fontWeight?" font-weight:"+fontWeight+";":"",void 0!==fillColor&&""!=fillColor&&(rowsStyl+="background-color: #"+fillColor+";"),tableHtml+="<tr style='"+rowsStyl+"'>";var tcNodes=trNodes[i]["a:tc"];if(void 0!==tcNodes)if(tcNodes.constructor===Array){var j=0;0==rowSpanAry.length&&(rowSpanAry=Array.apply(null,Array(tcNodes.length)).map(function(){return 0}));for(var totalColSpan=0;j<tcNodes.length;){if(0==rowSpanAry[j]&&0==totalColSpan){var a_sorce;if(0==j&&1==tblStylAttrObj.isFrstColAttr)a_sorce="a:firstCol",1==tblStylAttrObj.isLstRowAttr&&i==trNodes.length-1&&void 0!==getTextByPathList(thisTblStyle,["a:seCell"])?a_sorce="a:seCell":1==tblStylAttrObj.isFrstRowAttr&&0==i&&void 0!==getTextByPathList(thisTblStyle,["a:neCell"])&&(a_sorce="a:neCell");else if(j>0&&1==tblStylAttrObj.isBandColAttr&&(1!=tblStylAttrObj.isFrstColAttr||0!=i)&&(1!=tblStylAttrObj.isLstRowAttr||i!=trNodes.length-1)&&j!=tcNodes.length-1&&j%2!=0){var aBandNode=getTextByPathList(thisTblStyle,["a:band2V"]);void 0===aBandNode?(aBandNode=getTextByPathList(thisTblStyle,["a:band1V"]),void 0!==aBandNode&&(a_sorce="a:band2V")):a_sorce="a:band2V"}j==tcNodes.length-1&&1==tblStylAttrObj.isLstColAttr&&(a_sorce="a:lastCol",1==tblStylAttrObj.isLstRowAttr&&i==trNodes.length-1&&void 0!==getTextByPathList(thisTblStyle,["a:swCell"])?a_sorce="a:swCell":1==tblStylAttrObj.isFrstRowAttr&&0==i&&void 0!==getTextByPathList(thisTblStyle,["a:nwCell"])&&(a_sorce="a:nwCell"));var cellParmAry=getTableCellParams(tcNodes[j],getColsGrid,i,j,thisTblStyle,a_sorce,warpObj),text=cellParmAry[0],colStyl=cellParmAry[1],cssName=cellParmAry[2],rowSpan=cellParmAry[3],colSpan=cellParmAry[4];void 0!==rowSpan?(totalrowSpan++,rowSpanAry[j]=parseInt(rowSpan)-1,tableHtml+="<td class='"+cssName+"' data-row='"+i+","+j+"' rowspan ='"+parseInt(rowSpan)+"' style='"+colStyl+"'>"+text+"</td>"):void 0!==colSpan?(tableHtml+="<td class='"+cssName+"' data-row='"+i+","+j+"' colspan = '"+parseInt(colSpan)+"' style='"+colStyl+"'>"+text+"</td>",totalColSpan=parseInt(colSpan)-1):tableHtml+="<td class='"+cssName+"' data-row='"+i+","+j+"' style = '"+colStyl+"'>"+text+"</td>"}else 0!=rowSpanAry[j]&&(rowSpanAry[j]-=1),0!=totalColSpan&&totalColSpan--;j++}}else{var a_sorce;if(1==tblStylAttrObj.isFrstColAttr&&1!=tblStylAttrObj.isLstRowAttr)a_sorce="a:firstCol";else if(1==tblStylAttrObj.isBandColAttr&&1!=tblStylAttrObj.isLstRowAttr){var aBandNode=getTextByPathList(thisTblStyle,["a:band2V"]);void 0===aBandNode?(aBandNode=getTextByPathList(thisTblStyle,["a:band1V"]),void 0!==aBandNode&&(a_sorce="a:band2V")):a_sorce="a:band2V"}1==tblStylAttrObj.isLstColAttr&&1!=tblStylAttrObj.isLstRowAttr&&(a_sorce="a:lastCol");var cellParmAry=getTableCellParams(tcNodes,getColsGrid,i,void 0,thisTblStyle,a_sorce,warpObj),text=cellParmAry[0],colStyl=cellParmAry[1],cssName=cellParmAry[2],rowSpan=cellParmAry[3];tableHtml+=void 0!==rowSpan?"<td  class='"+cssName+"' rowspan='"+parseInt(rowSpan)+"' style = '"+colStyl+"'>"+text+"</td>":"<td class='"+cssName+"' style='"+colStyl+"'>"+text+"</td>"}tableHtml+="</tr>"}return tableHtml}function getTableCellParams(tcNodes,getColsGrid,row_idx,col_idx,thisTblStyle,cellSource,warpObj){var colWidth,rowSpan=getTextByPathList(tcNodes,["attrs","rowSpan"]),colSpan=getTextByPathList(tcNodes,["attrs","gridSpan"]),colStyl=(getTextByPathList(tcNodes,["attrs","vMerge"]),getTextByPathList(tcNodes,["attrs","hMerge"]),"word-wrap: break-word;"),celFillColor="",colFontClrPr="",colFontWeight="",lin_bottm="",lin_top="",lin_left="",lin_right="",lin_bottom_left_to_top_right="",lin_top_left_to_bottom_right="",colSapnInt=parseInt(colSpan),total_col_width=0;if(!isNaN(colSapnInt)&&colSapnInt>1)for(var k=0;colSapnInt>k;k++)total_col_width+=parseInt(getTextByPathList(getColsGrid[col_idx+k],["attrs","w"]));else total_col_width=getTextByPathList(void 0===col_idx?getColsGrid:getColsGrid[col_idx],["attrs","w"]);var text=genTextBody(tcNodes["a:txBody"],tcNodes,void 0,void 0,void 0,void 0,warpObj,total_col_width);if(0!=total_col_width&&(colWidth=parseInt(total_col_width)*slideFactor,colStyl+="width:"+colWidth+"px;"),lin_bottm=getTextByPathList(tcNodes,["a:tcPr","a:lnB"]),void 0===lin_bottm&&void 0!==cellSource&&(void 0!==cellSource&&(lin_bottm=getTextByPathList(thisTblStyle[cellSource],["a:tcStyle","a:tcBdr","a:bottom","a:ln"])),void 0===lin_bottm&&(lin_bottm=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcStyle","a:tcBdr","a:bottom","a:ln"]))),lin_top=getTextByPathList(tcNodes,["a:tcPr","a:lnT"]),void 0===lin_top&&(void 0!==cellSource&&(lin_top=getTextByPathList(thisTblStyle[cellSource],["a:tcStyle","a:tcBdr","a:top","a:ln"])),void 0===lin_top&&(lin_top=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcStyle","a:tcBdr","a:top","a:ln"]))),lin_left=getTextByPathList(tcNodes,["a:tcPr","a:lnL"]),void 0===lin_left&&(void 0!==cellSource&&(lin_left=getTextByPathList(thisTblStyle[cellSource],["a:tcStyle","a:tcBdr","a:left","a:ln"])),void 0===lin_left&&(lin_left=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcStyle","a:tcBdr","a:left","a:ln"]))),lin_right=getTextByPathList(tcNodes,["a:tcPr","a:lnR"]),void 0===lin_right&&(void 0!==cellSource&&(lin_right=getTextByPathList(thisTblStyle[cellSource],["a:tcStyle","a:tcBdr","a:right","a:ln"])),void 0===lin_right&&(lin_right=getTextByPathList(thisTblStyle,["a:wholeTbl","a:tcStyle","a:tcBdr","a:right","a:ln"]))),lin_bottom_left_to_top_right=getTextByPathList(tcNodes,["a:tcPr","a:lnBlToTr"]),lin_top_left_to_bottom_right=getTextByPathList(tcNodes,["a:tcPr","a:InTlToBr"]),void 0!==lin_bottm&&""!=lin_bottm){var bottom_line_border=getBorder(lin_bottm,void 0,!1,"",warpObj);""!=bottom_line_border&&(colStyl+="border-bottom:"+bottom_line_border+";")}if(void 0!==lin_top&&""!=lin_top){var top_line_border=getBorder(lin_top,void 0,!1,"",warpObj);""!=top_line_border&&(colStyl+="border-top: "+top_line_border+";")}if(void 0!==lin_left&&""!=lin_left){var left_line_border=getBorder(lin_left,void 0,!1,"",warpObj);""!=left_line_border&&(colStyl+="border-left: "+left_line_border+";")}if(void 0!==lin_right&&""!=lin_right){var right_line_border=getBorder(lin_right,void 0,!1,"",warpObj);""!=right_line_border&&(colStyl+="border-right:"+right_line_border+";")}var getCelFill=getTextByPathList(tcNodes,["a:tcPr"]);if(void 0!==getCelFill&&""!=getCelFill){var cellObj={"p:spPr":getCelFill};celFillColor=getShapeFill(cellObj,void 0,!1,warpObj,"slide")}if(""==celFillColor||"background-color: inherit;"==celFillColor){var bgFillschemeClr;if(void 0!==cellSource&&(bgFillschemeClr=getTextByPathList(thisTblStyle,[cellSource,"a:tcStyle","a:fill","a:solidFill"])),void 0!==bgFillschemeClr){var local_fillColor=getSolidFill(bgFillschemeClr,void 0,void 0,warpObj);void 0!==local_fillColor&&(celFillColor=" background-color: #"+local_fillColor+";")}}var cssName="";void 0!==celFillColor&&""!=celFillColor&&(celFillColor in styleTable?cssName=styleTable[celFillColor].name:(cssName="_tbl_cell_css_"+(Object.keys(styleTable).length+1),styleTable[celFillColor]={name:cssName,text:celFillColor}));var rowTxtStyl;if(void 0!==cellSource&&(rowTxtStyl=getTextByPathList(thisTblStyle,[cellSource,"a:tcTxStyle"])),void 0!==rowTxtStyl){var local_fontClrPr=getSolidFill(rowTxtStyl,void 0,void 0,warpObj);void 0!==local_fontClrPr&&(colFontClrPr=local_fontClrPr);var local_fontWeight="on"==getTextByPathList(rowTxtStyl,["attrs","b"])?"bold":"";""!==local_fontWeight&&(colFontWeight=local_fontWeight)}return colStyl+=""!==colFontClrPr?"color: #"+colFontClrPr+";":"",colStyl+=""!=colFontWeight?" font-weight:"+colFontWeight+";":"",[text,colStyl,cssName,rowSpan,colSpan]}function genChart(node,warpObj){var order=node.attrs.order,xfrmNode=getTextByPathList(node,["p:xfrm"]),result="<div id='chart"+chartID+"' class='block content' style='"+getPosition(xfrmNode,node,void 0,void 0)+getSize(xfrmNode,void 0,void 0)+" z-index: "+order+";'></div>",rid=node["a:graphic"]["a:graphicData"]["c:chart"].attrs["r:id"],refName=warpObj.slideResObj[rid].target,content=readXmlFile(warpObj.zip,refName),plotArea=getTextByPathList(content,["c:chartSpace","c:chart","c:plotArea"]),chartData=null;for(var key in plotArea)switch(key){case"c:lineChart":chartData={type:"createChart",data:{chartID:"chart"+chartID,chartType:"lineChart",chartData:extractChartData(plotArea[key]["c:ser"])}};break;case"c:barChart":chartData={type:"createChart",data:{chartID:"chart"+chartID,chartType:"barChart",chartData:extractChartData(plotArea[key]["c:ser"])}};break;case"c:pieChart":chartData={type:"createChart",data:{chartID:"chart"+chartID,chartType:"pieChart",chartData:extractChartData(plotArea[key]["c:ser"])}};break;case"c:pie3DChart":chartData={type:"createChart",data:{chartID:"chart"+chartID,chartType:"pie3DChart",chartData:extractChartData(plotArea[key]["c:ser"])}};break;case"c:areaChart":chartData={type:"createChart",data:{chartID:"chart"+chartID,chartType:"areaChart",chartData:extractChartData(plotArea[key]["c:ser"])}};break;case"c:scatterChart":chartData={type:"createChart",data:{chartID:"chart"+chartID,chartType:"scatterChart",chartData:extractChartData(plotArea[key]["c:ser"])}};break;case"c:catAx":break;case"c:valAx":}return null!==chartData&&MsgQueue.push(chartData),chartID++,result}function genDiagram(node,warpObj,source,sType){var zip=(node.attrs.order,warpObj.zip),xfrmNode=getTextByPathList(node,["p:xfrm"]),dgmRelIds=getTextByPathList(node,["a:graphic","a:graphicData","dgm:relIds","attrs"]),dgmClrFileId=dgmRelIds["r:cs"],dgmDataFileId=dgmRelIds["r:dm"],dgmLayoutFileId=dgmRelIds["r:lo"],dgmQuickStyleFileId=dgmRelIds["r:qs"],dgmClrFileName=warpObj.slideResObj[dgmClrFileId].target,dgmDataFileName=warpObj.slideResObj[dgmDataFileId].target,dgmLayoutFileName=warpObj.slideResObj[dgmLayoutFileId].target;dgmQuickStyleFileName=warpObj.slideResObj[dgmQuickStyleFileId].target;var dgmDrwSpArray=(readXmlFile(zip,dgmClrFileName),readXmlFile(zip,dgmDataFileName),readXmlFile(zip,dgmLayoutFileName),readXmlFile(zip,dgmQuickStyleFileName),getTextByPathList(warpObj.digramFileContent,["p:drawing","p:spTree","p:sp"])),rslt="";if(void 0!==dgmDrwSpArray)for(var dgmDrwSpArrayLen=dgmDrwSpArray.length,i=0;dgmDrwSpArrayLen>i;i++){var dspSp=dgmDrwSpArray[i];rslt+=processSpNode(dspSp,node,warpObj,"diagramBg",sType)}return"<div class='block diagram-content' style='"+getPosition(xfrmNode,node,void 0,void 0,sType)+getSize(xfrmNode,void 0,void 0)+"'>"+rslt+"</div>"}function getPosition(slideSpNode,pNode,slideLayoutSpNode,slideMasterSpNode,sType){var off,x=-1,y=-1;void 0!==slideSpNode&&(off=slideSpNode["a:off"].attrs),void 0===off&&void 0!==slideLayoutSpNode?off=slideLayoutSpNode["a:off"].attrs:void 0===off&&void 0!==slideMasterSpNode&&(off=slideMasterSpNode["a:off"].attrs);var offX=0,offY=0,grpX=0,grpY=0;if("group"==sType){var grpXfrmNode=getTextByPathList(pNode,["p:grpSpPr","a:xfrm"]);void 0!==xfrmNode&&(grpX=parseInt(grpXfrmNode["a:off"].attrs.x)*slideFactor,grpY=parseInt(grpXfrmNode["a:off"].attrs.y)*slideFactor)}if("group-rotate"==sType&&void 0!==pNode["p:grpSpPr"]){var xfrmNode=pNode["p:grpSpPr"]["a:xfrm"],chx=parseInt(xfrmNode["a:chOff"].attrs.x)*slideFactor,chy=parseInt(xfrmNode["a:chOff"].attrs.y)*slideFactor;offX=chx,offY=chy}return void 0===off?"":(x=parseInt(off.x)*slideFactor,y=parseInt(off.y)*slideFactor,isNaN(x)||isNaN(y)?"":"top:"+(y-offY+grpY)+"px; left:"+(x-offX+grpX)+"px;")}function getSize(slideSpNode,slideLayoutSpNode,slideMasterSpNode){var ext=void 0,w=-1,h=-1;return void 0!==slideSpNode?ext=slideSpNode["a:ext"].attrs:void 0!==slideLayoutSpNode?ext=slideLayoutSpNode["a:ext"].attrs:void 0!==slideMasterSpNode&&(ext=slideMasterSpNode["a:ext"].attrs),void 0===ext?"":(w=parseInt(ext.cx)*slideFactor,h=parseInt(ext.cy)*slideFactor,isNaN(w)||isNaN(h)?"":"width:"+w+"px; height:"+h+"px;")}function getVerticalMargins(pNode,textBodyNode,type,idx,warpObj){var lvl=1,spcBefNode=getTextByPathList(pNode,["a:pPr","a:spcBef","a:spcPts","attrs","val"]),spcAftNode=getTextByPathList(pNode,["a:pPr","a:spcAft","a:spcPts","attrs","val"]),lnSpcNode=getTextByPathList(pNode,["a:pPr","a:lnSpc","a:spcPct","attrs","val"]),lnSpcNodeType="Pct";void 0===lnSpcNode&&(lnSpcNode=getTextByPathList(pNode,["a:pPr","a:lnSpc","a:spcPts","attrs","val"]),void 0!==lnSpcNode&&(lnSpcNodeType="Pts"));var lvlNode=getTextByPathList(pNode,["a:pPr","attrs","lvl"]);void 0!==lvlNode&&(lvl=parseInt(lvlNode)+1);var fontSize;if(void 0!==getTextByPathList(pNode,["a:r"])){var fontSizeStr=getFontSize(pNode["a:r"],textBodyNode,void 0,lvl,type,warpObj);"inherit"!=fontSizeStr&&(fontSize=parseInt(fontSizeStr,"px"))}var isInLayoutOrMaster=!0;if(("shape"==type||"textBox"==type)&&(isInLayoutOrMaster=!1),isInLayoutOrMaster&&(void 0===spcBefNode||void 0===spcAftNode||void 0===lnSpcNode)&&void 0!==idx){var laypPrNode=getTextByPathList(warpObj,["slideLayoutTables","idxTable",idx,"p:txBody","a:p",lvl-1,"a:pPr"]);void 0===spcBefNode&&(spcBefNode=getTextByPathList(laypPrNode,["a:spcBef","a:spcPts","attrs","val"])),void 0===spcAftNode&&(spcAftNode=getTextByPathList(laypPrNode,["a:spcAft","a:spcPts","attrs","val"])),void 0===lnSpcNode&&(lnSpcNode=getTextByPathList(laypPrNode,["a:lnSpc","a:spcPct","attrs","val"]),void 0===lnSpcNode&&(lnSpcNode=getTextByPathList(laypPrNode,["a:pPr","a:lnSpc","a:spcPts","attrs","val"]),void 0!==lnSpcNode&&(lnSpcNodeType="Pts")))}if(isInLayoutOrMaster&&(void 0===spcBefNode||void 0===spcAftNode||void 0===lnSpcNode)){var slideMasterTextStyles=warpObj.slideMasterTextStyles,dirLoc="",lvl="a:lvl"+lvl+"pPr";switch(type){case"title":case"ctrTitle":dirLoc="p:titleStyle";break;case"body":case"obj":case"dt":case"ftr":case"sldNum":case"textBox":dirLoc="p:bodyStyle";break;case"shape":default:dirLoc="p:otherStyle"}var inLvlNode=getTextByPathList(slideMasterTextStyles,[dirLoc,lvl]);void 0!==inLvlNode&&(void 0===spcBefNode&&(spcBefNode=getTextByPathList(inLvlNode,["a:spcBef","a:spcPts","attrs","val"])),void 0===spcAftNode&&(spcAftNode=getTextByPathList(inLvlNode,["a:spcAft","a:spcPts","attrs","val"])),void 0===lnSpcNode&&(lnSpcNode=getTextByPathList(inLvlNode,["a:lnSpc","a:spcPct","attrs","val"]),void 0===lnSpcNode&&(lnSpcNode=getTextByPathList(inLvlNode,["a:pPr","a:lnSpc","a:spcPts","attrs","val"]),void 0!==lnSpcNode&&(lnSpcNodeType="Pts"))))}var spcBefor=0,spcAfter=0,spcLines=0,marginTopBottomStr="";if(void 0!==spcBefNode&&(spcBefor=parseInt(spcBefNode)/100),void 0!==spcAftNode&&(spcAfter=parseInt(spcAftNode)/100),void 0!==lnSpcNode&&void 0!==fontSize)if("Pts"==lnSpcNodeType)marginTopBottomStr+="padding-top: "+(parseInt(lnSpcNode)/100-fontSize)+"px;";else{var fct=parseInt(lnSpcNode)/1e5;spcLines=fontSize*(fct-1)-fontSize;var pBottom=fct>1?fontSize:0;marginTopBottomStr+="padding-top: "+pBottom+"px;",marginTopBottomStr+="padding-bottom: "+spcLines+"px;"}return marginTopBottomStr+="margin-top: "+(spcBefor-1)+"px;",(void 0!==spcAftNode||void 0!==lnSpcNode)&&(marginTopBottomStr+="margin-bottom: "+spcAfter+"px;"),marginTopBottomStr}function getHorizontalAlign(node,textBodyNode,idx,type,prg_dir,warpObj){var algn=getTextByPathList(node,["a:pPr","attrs","algn"]);if(void 0===algn){var lvlIdx=1,lvlNode=getTextByPathList(node,["a:pPr","attrs","lvl"]);void 0!==lvlNode&&(lvlIdx=parseInt(lvlNode)+1);var lvlStr="a:lvl"+lvlIdx+"pPr",lstStyle=textBodyNode["a:lstStyle"];algn=getTextByPathList(lstStyle,[lvlStr,"attrs","algn"]),void 0===algn&&void 0!==idx&&(algn=getTextByPathList(warpObj.slideLayoutTables.idxTable[idx],["p:txBody","a:lstStyle",lvlStr,"attrs","algn"]),void 0===algn&&(algn=getTextByPathList(warpObj.slideLayoutTables.idxTable[idx],["p:txBody","a:p","a:pPr","attrs","algn"]),void 0===algn&&(algn=getTextByPathList(warpObj.slideLayoutTables.idxTable[idx],["p:txBody","a:p",lvlIdx-1,"a:pPr","attrs","algn"])))),void 0===algn&&(void 0!==type?(algn=getTextByPathList(warpObj,["slideLayoutTables","typeTable",type,"p:txBody","a:lstStyle",lvlStr,"attrs","algn"]),void 0===algn&&(algn="title"==type||"ctrTitle"==type?getTextByPathList(warpObj,["slideMasterTextStyles","p:titleStyle",lvlStr,"attrs","algn"]):"body"==type||"obj"==type||"subTitle"==type?getTextByPathList(warpObj,["slideMasterTextStyles","p:bodyStyle",lvlStr,"attrs","algn"]):"shape"==type||"diagram"==type?getTextByPathList(warpObj,["slideMasterTextStyles","p:otherStyle",lvlStr,"attrs","algn"]):"textBox"==type?getTextByPathList(warpObj,["defaultTextStyle",lvlStr,"attrs","algn"]):getTextByPathList(warpObj,["slideMasterTables","typeTable",type,"p:txBody","a:lstStyle",lvlStr,"attrs","algn"]))):algn=getTextByPathList(warpObj,["slideMasterTextStyles","p:bodyStyle",lvlStr,"attrs","algn"]))}if(void 0===algn){if("title"==type||"subTitle"==type||"ctrTitle"==type)return"h-mid";if("sldNum"==type)return"h-right"}if(void 0!==algn)switch(algn){case"l":return"pregraph-rtl"==prg_dir?"h-left-rtl":"h-left";case"r":return"pregraph-rtl"==prg_dir?"h-right-rtl":"h-right";case"ctr":return"h-mid";case"just":case"dist":default:return"h-"+algn}}function getPregraphDir(node,textBodyNode,idx,type,warpObj){var rtl=getTextByPathList(node,["a:pPr","attrs","rtl"]);if(void 0===rtl){var layoutMasterNode=getLayoutAndMasterNode(node,idx,type,warpObj),pPrNodeLaout=layoutMasterNode.nodeLaout,pPrNodeMaster=layoutMasterNode.nodeMaster;rtl=getTextByPathList(pPrNodeLaout,["attrs","rtl"]),void 0===rtl&&"shape"!=type&&(rtl=getTextByPathList(pPrNodeMaster,["attrs","rtl"]))}return"1"==rtl?"pregraph-rtl":"0"==rtl?"pregraph-ltr":"pregraph-inherit"}function getVerticalAlign(node,slideLayoutSpNode,slideMasterSpNode,type){var anchor=getTextByPathList(node,["p:txBody","a:bodyPr","attrs","anchor"]);return void 0===anchor&&(anchor=getTextByPathList(slideLayoutSpNode,["p:txBody","a:bodyPr","attrs","anchor"]),void 0===anchor&&(anchor=getTextByPathList(slideMasterSpNode,["p:txBody","a:bodyPr","attrs","anchor"]),void 0===anchor&&(anchor="t"))),"ctr"===anchor?"v-mid":"b"===anchor?"v-down":"v-up"}function getContentDir(node,type,warpObj){return"content"}function getFontType(node,type,warpObj,pFontStyle){var typeface=getTextByPathList(node,["a:rPr","a:latin","attrs","typeface"]);if(void 0===typeface){var fontIdx="",fontGrup="";void 0!==pFontStyle&&(fontIdx=getTextByPathList(pFontStyle,["attrs","idx"]));var fontSchemeNode=getTextByPathList(warpObj.themeContent,["a:theme","a:themeElements","a:fontScheme"]);""==fontIdx&&(fontIdx="title"==type||"subTitle"==type||"ctrTitle"==type?"major":"minor"),fontGrup="a:"+fontIdx+"Font",typeface=getTextByPathList(fontSchemeNode,[fontGrup,"a:latin","attrs","typeface"])}return void 0===typeface?"inherit":typeface}function getFontColorPr(node,pNode,lstStyle,pFontStyle,lvl,idx,type,warpObj){var filTyp,color,textBordr,rPrNode=getTextByPathList(node,["a:rPr"]),colorType="",highlightColor="";if(void 0!==rPrNode)if(filTyp=getFillType(rPrNode),"SOLID_FILL"==filTyp){var solidFillNode=rPrNode["a:solidFill"];color=getSolidFill(solidFillNode,void 0,void 0,warpObj);var highlightNode=rPrNode["a:highlight"];void 0!==highlightNode&&(highlightColor=getSolidFill(highlightNode,void 0,void 0,warpObj)),colorType="solid"}else if("PATTERN_FILL"==filTyp){var pattFill=rPrNode["a:pattFill"];color=getPatternFill(pattFill,warpObj),colorType="pattern"}else if("PIC_FILL"==filTyp)color=getBgPicFill(rPrNode,"slideBg",warpObj,void 0,void 0),colorType="pic";else if("GRADIENT_FILL"==filTyp){var shpFill=rPrNode["a:gradFill"];color=getGradientFill(shpFill,warpObj),colorType="gradient"}if(void 0===color&&void 0!==getTextByPathList(lstStyle,["a:lvl"+lvl+"pPr","a:defRPr"])){var lstStyledefRPr=getTextByPathList(lstStyle,["a:lvl"+lvl+"pPr","a:defRPr"]);if(filTyp=getFillType(lstStyledefRPr),"SOLID_FILL"==filTyp){var solidFillNode=lstStyledefRPr["a:solidFill"];color=getSolidFill(solidFillNode,void 0,void 0,warpObj);var highlightNode=lstStyledefRPr["a:highlight"];void 0!==highlightNode&&(highlightColor=getSolidFill(highlightNode,void 0,void 0,warpObj)),colorType="solid"}else if("PATTERN_FILL"==filTyp){var pattFill=lstStyledefRPr["a:pattFill"];color=getPatternFill(pattFill,warpObj),colorType="pattern"}else if("PIC_FILL"==filTyp)color=getBgPicFill(lstStyledefRPr,"slideBg",warpObj,void 0,void 0),colorType="pic";else if("GRADIENT_FILL"==filTyp){var shpFill=lstStyledefRPr["a:gradFill"];color=getGradientFill(shpFill,warpObj),colorType="gradient"}}if(void 0===color){var sPstyle=getTextByPathList(pNode,["p:style","a:fontRef"]);if(void 0!==sPstyle){color=getSolidFill(sPstyle,void 0,void 0,warpObj),void 0!==color&&(colorType="solid");var highlightNode=sPstyle["a:highlight"];void 0!==highlightNode&&(highlightColor=getSolidFill(highlightNode,void 0,void 0,warpObj))}void 0===color&&void 0!==pFontStyle&&(color=getSolidFill(pFontStyle,void 0,void 0,warpObj),void 0!==color&&(colorType="solid"))}if(void 0===color){var layoutMasterNode=getLayoutAndMasterNode(pNode,idx,type,warpObj),pPrNodeLaout=layoutMasterNode.nodeLaout,pPrNodeMaster=layoutMasterNode.nodeMaster;if(void 0!==pPrNodeLaout){var defRpRLaout=getTextByPathList(pPrNodeLaout,["a:defRPr","a:solidFill"]);if(void 0!==defRpRLaout){color=getSolidFill(defRpRLaout,void 0,void 0,warpObj);var highlightNode=getTextByPathList(pPrNodeLaout,["a:defRPr","a:highlight"]);void 0!==highlightNode&&(highlightColor=getSolidFill(highlightNode,void 0,void 0,warpObj)),colorType="solid"}}if(void 0===color&&void 0!==pPrNodeMaster){var defRprMaster=getTextByPathList(pPrNodeMaster,["a:defRPr","a:solidFill"]);if(void 0!==defRprMaster){color=getSolidFill(defRprMaster,void 0,void 0,warpObj);var highlightNode=getTextByPathList(pPrNodeMaster,["a:defRPr","a:highlight"]);void 0!==highlightNode&&(highlightColor=getSolidFill(highlightNode,void 0,void 0,warpObj)),colorType="solid"}}}var txtEffects=[],txtEffObj={},txtBrdrNode=getTextByPathList(node,["a:rPr","a:ln"]),textBordr="";if(void 0!==txtBrdrNode&&void 0===txtBrdrNode["a:noFill"]){var txBrd=getBorder(node,pNode,!1,"text",warpObj),txBrdAry=txBrd.split(" "),brdSize=parseInt(txBrdAry[0].substring(0,txBrdAry[0].indexOf("px")))+"px",brdClr=txBrdAry[2];"solid"==colorType?(textBordr="-"+brdSize+" 0 "+brdClr+", 0 "+brdSize+" "+brdClr+", "+brdSize+" 0 "+brdClr+", 0 -"+brdSize+" "+brdClr,txtEffects.push(textBordr)):txtEffObj.border=brdSize+" "+brdClr}var txtGlowNode=getTextByPathList(node,["a:rPr","a:effectLst","a:glow"]),oGlowStr="";if(void 0!==txtGlowNode){var glowClr=getSolidFill(txtGlowNode,void 0,void 0,warpObj),rad=txtGlowNode.attrs.rad?txtGlowNode.attrs.rad*slideFactor:0;oGlowStr="0 0 "+rad+"px #"+glowClr+", 0 0 "+rad+"px #"+glowClr+", 0 0 "+rad+"px #"+glowClr+", 0 0 "+rad+"px #"+glowClr+", 0 0 "+rad+"px #"+glowClr+", 0 0 "+rad+"px #"+glowClr+", 0 0 "+rad+"px #"+glowClr,"solid"==colorType?txtEffects.push(oGlowStr):txtEffects.push("drop-shadow(0 0 "+rad/3+"px #"+glowClr+") drop-shadow(0 0 "+2*rad/3+"px #"+glowClr+") drop-shadow(0 0 "+rad+"px #"+glowClr+")")}var txtShadow=getTextByPathList(node,["a:rPr","a:effectLst","a:outerShdw"]),oShadowStr="";if(void 0!==txtShadow){var shadowClr=getSolidFill(txtShadow,void 0,void 0,warpObj),outerShdwAttrs=txtShadow.attrs,dir=(outerShdwAttrs.algn,outerShdwAttrs.dir?parseInt(outerShdwAttrs.dir)/6e4:0),dist=parseInt(outerShdwAttrs.dist)*slideFactor,blurRad=(outerShdwAttrs.rotWithShape,outerShdwAttrs.blurRad?parseInt(outerShdwAttrs.blurRad)*slideFactor+"px":""),vx=(outerShdwAttrs.sx?parseInt(outerShdwAttrs.sx)/1e5:1,outerShdwAttrs.sy?parseInt(outerShdwAttrs.sy)/1e5:1,dist*Math.sin(dir*Math.PI/180)),hx=dist*Math.cos(dir*Math.PI/180);isNaN(vx)||isNaN(hx)||(oShadowStr=hx+"px "+vx+"px "+blurRad+" #"+shadowClr,"solid"==colorType?txtEffects.push(oShadowStr):txtEffects.push("drop-shadow("+hx+"px "+vx+"px "+blurRad+" #"+shadowClr+")"))}var txt_effects,text_effcts="";return"solid"==colorType?(txtEffects.length>0&&(text_effcts=txtEffects.join(",")),txt_effects=text_effcts+";"):(txtEffects.length>0&&(text_effcts=txtEffects.join(" ")),txtEffObj.effcts=text_effcts,txt_effects=txtEffObj),[color,txt_effects,colorType,highlightColor]}function getFontSize(node,textBodyNode,pFontStyle,lvl,type,warpObj){var sz,kern,lstStyle=void 0!==textBodyNode?textBodyNode["a:lstStyle"]:void 0,lvlpPr="a:lvl"+lvl+"pPr",fontSize=void 0;void 0!==node["a:rPr"]&&(fontSize=parseInt(node["a:rPr"].attrs.sz)/100),(isNaN(fontSize)||void 0===fontSize&&void 0!==node["a:fld"])&&(sz=getTextByPathList(node["a:fld"],["a:rPr","attrs","sz"]),fontSize=parseInt(sz)/100),!isNaN(fontSize)&&void 0!==fontSize||void 0!==node["a:t"]||(sz=getTextByPathList(node["a:endParaRPr"],["attrs","sz"]),fontSize=parseInt(sz)/100),!isNaN(fontSize)&&void 0!==fontSize||void 0===lstStyle||(sz=getTextByPathList(lstStyle,[lvlpPr,"a:defRPr","attrs","sz"]),fontSize=parseInt(sz)/100);var isAutoFit=!1,isKerning=!1;if(void 0!==textBodyNode){var spAutoFitNode=getTextByPathList(textBodyNode,["a:bodyPr","a:spAutoFit"]);void 0!==spAutoFitNode&&(isAutoFit=!0,isKerning=!0)}(isNaN(fontSize)||void 0===fontSize)&&(sz=getTextByPathList(warpObj.slideLayoutTables,["typeTable",type,"p:txBody","a:lstStyle",lvlpPr,"a:defRPr","attrs","sz"]),fontSize=parseInt(sz)/100,kern=getTextByPathList(warpObj.slideLayoutTables,["typeTable",type,"p:txBody","a:lstStyle",lvlpPr,"a:defRPr","attrs","kern"]),isKerning&&void 0!==kern&&!isNaN(fontSize)&&fontSize-parseInt(kern)/100>0&&(fontSize-=parseInt(kern)/100)),(isNaN(fontSize)||void 0===fontSize)&&(sz=getTextByPathList(warpObj.slideMasterTables,["typeTable",type,"p:txBody","a:lstStyle",lvlpPr,"a:defRPr","attrs","sz"]),kern=getTextByPathList(warpObj.slideMasterTables,["typeTable",type,"p:txBody","a:lstStyle",lvlpPr,"a:defRPr","attrs","kern"]),void 0===sz&&("title"==type||"subTitle"==type||"ctrTitle"==type?(sz=getTextByPathList(warpObj.slideMasterTextStyles,["p:titleStyle",lvlpPr,"a:defRPr","attrs","sz"]),kern=getTextByPathList(warpObj.slideMasterTextStyles,["p:titleStyle",lvlpPr,"a:defRPr","attrs","kern"])):"body"==type||"obj"==type||"dt"==type||"sldNum"==type||"textBox"===type?(sz=getTextByPathList(warpObj.slideMasterTextStyles,["p:bodyStyle",lvlpPr,"a:defRPr","attrs","sz"]),kern=getTextByPathList(warpObj.slideMasterTextStyles,["p:bodyStyle",lvlpPr,"a:defRPr","attrs","kern"])):"shape"==type&&(sz=getTextByPathList(warpObj.slideMasterTextStyles,["p:otherStyle",lvlpPr,"a:defRPr","attrs","sz"]),
kern=getTextByPathList(warpObj.slideMasterTextStyles,["p:otherStyle",lvlpPr,"a:defRPr","attrs","kern"]),isKerning=!1),void 0===sz&&(sz=getTextByPathList(warpObj.defaultTextStyle,[lvlpPr,"a:defRPr","attrs","sz"]),kern=void 0===kern?getTextByPathList(warpObj.defaultTextStyle,[lvlpPr,"a:defRPr","attrs","kern"]):void 0,isKerning=!1)),fontSize=parseInt(sz)/100,isKerning&&void 0!==kern&&!isNaN(fontSize)&&fontSize-parseInt(kern)/100>parseInt(kern)/100&&(fontSize-=parseInt(kern)/100));var baseline=getTextByPathList(node,["a:rPr","attrs","baseline"]);if(void 0!==baseline&&!isNaN(fontSize)){var baselineVl=parseInt(baseline)/1e5;fontSize-=baselineVl}if(!isNaN(fontSize)){var normAutofit=getTextByPathList(textBodyNode,["a:bodyPr","a:normAutofit","attrs","fontScale"]);void 0!==normAutofit&&0!=normAutofit&&(fontSize=Math.round(fontSize*(normAutofit/1e5)))}return isNaN(fontSize)?"br"==type?"initial":"inherit":fontSize*fontSizeFactor+"px"}function getFontBold(node,type,slideMasterTextStyles){return void 0!==node["a:rPr"]&&"1"===node["a:rPr"].attrs.b?"bold":"inherit"}function getFontItalic(node,type,slideMasterTextStyles){return void 0!==node["a:rPr"]&&"1"===node["a:rPr"].attrs.i?"italic":"inherit"}function getFontDecoration(node,type,slideMasterTextStyles){if(void 0!==node["a:rPr"]){var underLine=void 0!==node["a:rPr"].attrs.u?node["a:rPr"].attrs.u:"none",strikethrough=void 0!==node["a:rPr"].attrs.strike?node["a:rPr"].attrs.strike:"noStrike";return"none"!=underLine&&"noStrike"==strikethrough?"underline":"none"==underLine&&"noStrike"!=strikethrough?"line-through":"none"!=underLine&&"noStrike"!=strikethrough?"underline line-through":"inherit"}return"inherit"}function getTextHorizontalAlign(node,pNode,type,warpObj){var getAlgn=getTextByPathList(node,["a:pPr","attrs","algn"]);if(void 0===getAlgn&&(getAlgn=getTextByPathList(pNode,["a:pPr","attrs","algn"])),void 0===getAlgn)if("title"==type||"ctrTitle"==type||"subTitle"==type){var lvlIdx=1,lvlNode=getTextByPathList(pNode,["a:pPr","attrs","lvl"]);void 0!==lvlNode&&(lvlIdx=parseInt(lvlNode)+1);var lvlStr="a:lvl"+lvlIdx+"pPr";getAlgn=getTextByPathList(warpObj,["slideLayoutTables","typeTable",type,"p:txBody","a:lstStyle",lvlStr,"attrs","algn"]),void 0===getAlgn&&(getAlgn=getTextByPathList(warpObj,["slideMasterTables","typeTable",type,"p:txBody","a:lstStyle",lvlStr,"attrs","algn"]),void 0===getAlgn&&(getAlgn=getTextByPathList(warpObj,["slideMasterTextStyles","p:titleStyle",lvlStr,"attrs","algn"]),void 0===getAlgn&&"subTitle"===type&&(getAlgn=getTextByPathList(warpObj,["slideMasterTextStyles","p:bodyStyle",lvlStr,"attrs","algn"]))))}else getAlgn="body"==type?getTextByPathList(warpObj,["slideMasterTextStyles","p:bodyStyle","a:lvl1pPr","attrs","algn"]):getTextByPathList(warpObj,["slideMasterTables","typeTable",type,"p:txBody","a:lstStyle","a:lvl1pPr","attrs","algn"]);var align="inherit";if(void 0!==getAlgn)switch(getAlgn){case"l":align="left";break;case"r":align="right";break;case"ctr":align="center";break;case"just":align="justify";break;case"dist":align="justify";break;default:align="inherit"}return align}function getTextVerticalAlign(node,type,slideMasterTextStyles){var baseline=getTextByPathList(node,["a:rPr","attrs","baseline"]);return void 0===baseline?"baseline":parseInt(baseline)/1e3+"%"}function getTableBorders(node,warpObj){var borderStyle="";if(void 0!==node["a:bottom"]){var obj={"p:spPr":{"a:ln":node["a:bottom"]["a:ln"]}},borders=getBorder(obj,void 0,!1,"shape",warpObj);borderStyle+=borders.replace("border","border-bottom")}if(void 0!==node["a:top"]){var obj={"p:spPr":{"a:ln":node["a:top"]["a:ln"]}},borders=getBorder(obj,void 0,!1,"shape",warpObj);borderStyle+=borders.replace("border","border-top")}if(void 0!==node["a:right"]){var obj={"p:spPr":{"a:ln":node["a:right"]["a:ln"]}},borders=getBorder(obj,void 0,!1,"shape",warpObj);borderStyle+=borders.replace("border","border-right")}if(void 0!==node["a:left"]){var obj={"p:spPr":{"a:ln":node["a:left"]["a:ln"]}},borders=getBorder(obj,void 0,!1,"shape",warpObj);borderStyle+=borders.replace("border","border-left")}return borderStyle}function getBorder(node,pNode,isSvgMode,bType,warpObj){var cssText,lineNode;"shape"==bType?(cssText="border: ",lineNode=node["p:spPr"]["a:ln"]):"text"==bType&&(cssText="",lineNode=node["a:rPr"]["a:ln"]);var is_noFill=getTextByPathList(lineNode,["a:noFill"]);if(void 0!==is_noFill)return"hidden";if(void 0==lineNode){var lnRefNode=getTextByPathList(node,["p:style","a:lnRef"]);if(void 0!==lnRefNode){var lnIdx=getTextByPathList(lnRefNode,["attrs","idx"]);lineNode=warpObj.themeContent["a:theme"]["a:themeElements"]["a:fmtScheme"]["a:lnStyleLst"]["a:ln"][Number(lnIdx)-1]}}void 0==lineNode&&(cssText="",lineNode=node);var borderColor;if(void 0!==lineNode){var borderWidth=parseInt(getTextByPathList(lineNode,["attrs","w"]))/12700;cssText+=isNaN(borderWidth)||1>borderWidth?4/3+"px ":borderWidth+"px ";var borderType=getTextByPathList(lineNode,["a:prstDash","attrs","val"]);void 0===borderType&&(borderType=getTextByPathList(lineNode,["attrs","cmpd"]));var strokeDasharray="0";switch(borderType){case"solid":cssText+="solid",strokeDasharray="0";break;case"dash":cssText+="dashed",strokeDasharray="5";break;case"dashDot":cssText+="dashed",strokeDasharray="5, 5, 1, 5";break;case"dot":cssText+="dotted",strokeDasharray="1, 5";break;case"lgDash":cssText+="dashed",strokeDasharray="10, 5";break;case"dbl":cssText+="double",strokeDasharray="0";break;case"lgDashDotDot":cssText+="dashed",strokeDasharray="10, 5, 1, 5, 1, 5";break;case"sysDash":cssText+="dashed",strokeDasharray="5, 2";break;case"sysDashDot":cssText+="dashed",strokeDasharray="5, 2, 1, 5";break;case"sysDashDotDot":cssText+="dashed",strokeDasharray="5, 2, 1, 5, 1, 5";break;case"sysDot":cssText+="dotted",strokeDasharray="2, 5";break;case void 0:default:cssText+="solid",strokeDasharray="0"}var fillTyp=getFillType(lineNode);"NO_FILL"==fillTyp?borderColor=isSvgMode?"none":"":"SOLID_FILL"==fillTyp?borderColor=getSolidFill(lineNode["a:solidFill"],void 0,void 0,warpObj):"GRADIENT_FILL"==fillTyp?borderColor=getGradientFill(lineNode["a:gradFill"],warpObj):"PATTERN_FILL"==fillTyp&&(borderColor=getPatternFill(lineNode["a:pattFill"],warpObj))}if(void 0===borderColor){var lnRefNode=getTextByPathList(node,["p:style","a:lnRef"]);void 0!==lnRefNode&&(borderColor=getSolidFill(lnRefNode,void 0,void 0,warpObj))}return borderColor=void 0===borderColor?isSvgMode?"none":"hidden":"#"+borderColor,cssText+=" "+borderColor+" ",isSvgMode?{color:borderColor,width:borderWidth,type:borderType,strokeDasharray:strokeDasharray}:cssText+";"}function getBackground(warpObj,slideSize,index){var slideLayoutContent=(warpObj.slideContent,warpObj.slideLayoutContent),slideMasterContent=warpObj.slideMasterContent,nodesSldLayout=getTextByPathList(slideLayoutContent,["p:sldLayout","p:cSld","p:spTree"]),nodesSldMaster=getTextByPathList(slideMasterContent,["p:sldMaster","p:cSld","p:spTree"]),showMasterSp=getTextByPathList(slideLayoutContent,["p:sldLayout","attrs","showMasterSp"]),bgColor=getSlideBackgroundFill(warpObj,index),result="<div class='slide-background-"+index+"' style='width:"+slideSize.width+"px; height:"+slideSize.height+"px;"+bgColor+"'>";if(void 0!==nodesSldLayout)for(var nodeKey in nodesSldLayout)if(nodesSldLayout[nodeKey].constructor===Array)for(var i=0;i<nodesSldLayout[nodeKey].length;i++){var ph_type=getTextByPathList(nodesSldLayout[nodeKey][i],["p:nvSpPr","p:nvPr","p:ph","attrs","type"]);"pic"!=ph_type&&(result+=processNodesInSlide(nodeKey,nodesSldLayout[nodeKey][i],nodesSldLayout,warpObj,"slideLayoutBg"))}else{var ph_type=getTextByPathList(nodesSldLayout[nodeKey],["p:nvSpPr","p:nvPr","p:ph","attrs","type"]);"pic"!=ph_type&&(result+=processNodesInSlide(nodeKey,nodesSldLayout[nodeKey],nodesSldLayout,warpObj,"slideLayoutBg"))}if(void 0!==nodesSldMaster&&("1"==showMasterSp||void 0===showMasterSp))for(var nodeKey in nodesSldMaster)if(nodesSldMaster[nodeKey].constructor===Array)for(var i=0;i<nodesSldMaster[nodeKey].length;i++){var ph_type=getTextByPathList(nodesSldMaster[nodeKey][i],["p:nvSpPr","p:nvPr","p:ph","attrs","type"]);result+=processNodesInSlide(nodeKey,nodesSldMaster[nodeKey][i],nodesSldMaster,warpObj,"slideMasterBg")}else{var ph_type=getTextByPathList(nodesSldMaster[nodeKey],["p:nvSpPr","p:nvPr","p:ph","attrs","type"]);result+=processNodesInSlide(nodeKey,nodesSldMaster[nodeKey],nodesSldMaster,warpObj,"slideMasterBg")}return result}function getSlideBackgroundFill(warpObj,index){var bgcolor,slideContent=warpObj.slideContent,slideLayoutContent=warpObj.slideLayoutContent,slideMasterContent=warpObj.slideMasterContent,bgPr=getTextByPathList(slideContent,["p:sld","p:cSld","p:bg","p:bgPr"]),bgRef=getTextByPathList(slideContent,["p:sld","p:cSld","p:bg","p:bgRef"]);if(void 0!==bgPr){var bgFillTyp=getFillType(bgPr);if("SOLID_FILL"==bgFillTyp){var clrMapOvr,sldFill=bgPr["a:solidFill"],sldClrMapOvr=getTextByPathList(slideContent,["p:sld","p:clrMapOvr","a:overrideClrMapping","attrs"]);if(void 0!==sldClrMapOvr)clrMapOvr=sldClrMapOvr;else{var sldClrMapOvr=getTextByPathList(slideLayoutContent,["p:sldLayout","p:clrMapOvr","a:overrideClrMapping","attrs"]);clrMapOvr=void 0!==sldClrMapOvr?sldClrMapOvr:getTextByPathList(slideMasterContent,["p:sldMaster","p:clrMap","attrs"])}var sldBgClr=getSolidFill(sldFill,clrMapOvr,void 0,warpObj);bgcolor="background: #"+sldBgClr+";"}else"GRADIENT_FILL"==bgFillTyp?bgcolor=getBgGradientFill(bgPr,void 0,slideMasterContent,warpObj):"PIC_FILL"==bgFillTyp&&(bgcolor=getBgPicFill(bgPr,"slideBg",warpObj,void 0,index))}else if(void 0!==bgRef){var clrMapOvr,sldClrMapOvr=getTextByPathList(slideContent,["p:sld","p:clrMapOvr","a:overrideClrMapping","attrs"]);if(void 0!==sldClrMapOvr)clrMapOvr=sldClrMapOvr;else{var sldClrMapOvr=getTextByPathList(slideLayoutContent,["p:sldLayout","p:clrMapOvr","a:overrideClrMapping","attrs"]);clrMapOvr=void 0!==sldClrMapOvr?sldClrMapOvr:getTextByPathList(slideMasterContent,["p:sldMaster","p:clrMap","attrs"])}var phClr=getSolidFill(bgRef,clrMapOvr,void 0,warpObj),idx=Number(bgRef.attrs.idx);if(0==idx||1e3==idx);else if(idx>0&&1e3>idx);else if(idx>1e3){var trueIdx=idx-1e3,bgFillLst=warpObj.themeContent["a:theme"]["a:themeElements"]["a:fmtScheme"]["a:bgFillStyleLst"],sortblAry=[];Object.keys(bgFillLst).forEach(function(key){var bgFillLstTyp=bgFillLst[key];if("attrs"!=key)if(bgFillLstTyp.constructor===Array)for(var i=0;i<bgFillLstTyp.length;i++){var obj={};obj[key]=bgFillLstTyp[i],obj.idex=bgFillLstTyp[i].attrs.order,obj.attrs={order:bgFillLstTyp[i].attrs.order},sortblAry.push(obj)}else{var obj={};obj[key]=bgFillLstTyp,obj.idex=bgFillLstTyp.attrs.order,obj.attrs={order:bgFillLstTyp.attrs.order},sortblAry.push(obj)}});var sortByOrder=sortblAry.slice(0);sortByOrder.sort(function(a,b){return a.idex-b.idex});var bgFillLstIdx=sortByOrder[trueIdx-1],bgFillTyp=getFillType(bgFillLstIdx);if("SOLID_FILL"==bgFillTyp){var sldFill=bgFillLstIdx["a:solidFill"],sldBgClr=getSolidFill(sldFill,clrMapOvr,void 0,warpObj);bgcolor="background: #"+sldBgClr+";"}else"GRADIENT_FILL"==bgFillTyp?bgcolor=getBgGradientFill(bgFillLstIdx,phClr,slideMasterContent,warpObj):console.log(bgFillTyp)}}else{bgPr=getTextByPathList(slideLayoutContent,["p:sldLayout","p:cSld","p:bg","p:bgPr"]),bgRef=getTextByPathList(slideLayoutContent,["p:sldLayout","p:cSld","p:bg","p:bgRef"]);var clrMapOvr,sldClrMapOvr=getTextByPathList(slideLayoutContent,["p:sldLayout","p:clrMapOvr","a:overrideClrMapping","attrs"]);if(clrMapOvr=void 0!==sldClrMapOvr?sldClrMapOvr:getTextByPathList(slideMasterContent,["p:sldMaster","p:clrMap","attrs"]),void 0!==bgPr){var bgFillTyp=getFillType(bgPr);if("SOLID_FILL"==bgFillTyp){var sldFill=bgPr["a:solidFill"],sldBgClr=getSolidFill(sldFill,clrMapOvr,void 0,warpObj);bgcolor="background: #"+sldBgClr+";"}else"GRADIENT_FILL"==bgFillTyp?bgcolor=getBgGradientFill(bgPr,void 0,slideMasterContent,warpObj):"PIC_FILL"==bgFillTyp&&(bgcolor=getBgPicFill(bgPr,"slideLayoutBg",warpObj,void 0,index))}else if(void 0!==bgRef){console.log("slideLayoutContent: bgRef",bgRef);var phClr=getSolidFill(bgRef,clrMapOvr,void 0,warpObj),idx=Number(bgRef.attrs.idx);if(0==idx||1e3==idx);else if(idx>0&&1e3>idx);else if(idx>1e3){var trueIdx=idx-1e3,bgFillLst=warpObj.themeContent["a:theme"]["a:themeElements"]["a:fmtScheme"]["a:bgFillStyleLst"],sortblAry=[];Object.keys(bgFillLst).forEach(function(key){var bgFillLstTyp=bgFillLst[key];if("attrs"!=key)if(bgFillLstTyp.constructor===Array)for(var i=0;i<bgFillLstTyp.length;i++){var obj={};obj[key]=bgFillLstTyp[i],obj.idex=bgFillLstTyp[i].attrs.order,obj.attrs={order:bgFillLstTyp[i].attrs.order},sortblAry.push(obj)}else{var obj={};obj[key]=bgFillLstTyp,obj.idex=bgFillLstTyp.attrs.order,obj.attrs={order:bgFillLstTyp.attrs.order},sortblAry.push(obj)}});var sortByOrder=sortblAry.slice(0);sortByOrder.sort(function(a,b){return a.idex-b.idex});var bgFillLstIdx=sortByOrder[trueIdx-1],bgFillTyp=getFillType(bgFillLstIdx);if("SOLID_FILL"==bgFillTyp){var sldFill=bgFillLstIdx["a:solidFill"],sldBgClr=getSolidFill(sldFill,clrMapOvr,phClr,warpObj);bgcolor="background: #"+sldBgClr+";"}else"GRADIENT_FILL"==bgFillTyp?bgcolor=getBgGradientFill(bgFillLstIdx,phClr,slideMasterContent,warpObj):"PIC_FILL"==bgFillTyp?bgcolor=getBgPicFill(bgFillLstIdx,"themeBg",warpObj,phClr,index):console.log(bgFillTyp)}}else{bgPr=getTextByPathList(slideMasterContent,["p:sldMaster","p:cSld","p:bg","p:bgPr"]),bgRef=getTextByPathList(slideMasterContent,["p:sldMaster","p:cSld","p:bg","p:bgRef"]);var clrMap=getTextByPathList(slideMasterContent,["p:sldMaster","p:clrMap","attrs"]);if(void 0!==bgPr){var bgFillTyp=getFillType(bgPr);if("SOLID_FILL"==bgFillTyp){var sldFill=bgPr["a:solidFill"],sldBgClr=getSolidFill(sldFill,clrMap,void 0,warpObj);bgcolor="background: #"+sldBgClr+";"}else"GRADIENT_FILL"==bgFillTyp?bgcolor=getBgGradientFill(bgPr,void 0,slideMasterContent,warpObj):"PIC_FILL"==bgFillTyp&&(bgcolor=getBgPicFill(bgPr,"slideMasterBg",warpObj,void 0,index))}else if(void 0!==bgRef){var phClr=getSolidFill(bgRef,clrMap,void 0,warpObj),idx=Number(bgRef.attrs.idx);if(0==idx||1e3==idx);else if(idx>0&&1e3>idx);else if(idx>1e3){var trueIdx=idx-1e3,bgFillLst=warpObj.themeContent["a:theme"]["a:themeElements"]["a:fmtScheme"]["a:bgFillStyleLst"],sortblAry=[];Object.keys(bgFillLst).forEach(function(key){var bgFillLstTyp=bgFillLst[key];if("attrs"!=key)if(bgFillLstTyp.constructor===Array)for(var i=0;i<bgFillLstTyp.length;i++){var obj={};obj[key]=bgFillLstTyp[i],obj.idex=bgFillLstTyp[i].attrs.order,obj.attrs={order:bgFillLstTyp[i].attrs.order},sortblAry.push(obj)}else{var obj={};obj[key]=bgFillLstTyp,obj.idex=bgFillLstTyp.attrs.order,obj.attrs={order:bgFillLstTyp.attrs.order},sortblAry.push(obj)}});var sortByOrder=sortblAry.slice(0);sortByOrder.sort(function(a,b){return a.idex-b.idex});var bgFillLstIdx=sortByOrder[trueIdx-1],bgFillTyp=getFillType(bgFillLstIdx);if("SOLID_FILL"==bgFillTyp){var sldFill=bgFillLstIdx["a:solidFill"],sldBgClr=getSolidFill(sldFill,clrMap,phClr,warpObj);bgcolor="background: #"+sldBgClr+";"}else"GRADIENT_FILL"==bgFillTyp?bgcolor=getBgGradientFill(bgFillLstIdx,phClr,slideMasterContent,warpObj):"PIC_FILL"==bgFillTyp?bgcolor=getBgPicFill(bgFillLstIdx,"themeBg",warpObj,phClr,index):console.log(bgFillTyp)}}}}return bgcolor}function getBgGradientFill(bgPr,phClr,slideMasterContent,warpObj){var bgcolor="";if(void 0!==bgPr){for(var grdFill=bgPr["a:gradFill"],gsLst=grdFill["a:gsLst"]["a:gs"],color_ary=[],pos_ary=[],i=0;i<gsLst.length;i++){var lo_color="",lo_color=getSolidFill(gsLst[i],slideMasterContent["p:sldMaster"]["p:clrMap"].attrs,phClr,warpObj),pos=getTextByPathList(gsLst[i],["attrs","pos"]);void 0!==pos?pos_ary[i]=pos/1e3+"%":pos_ary[i]="",color_ary[i]="#"+lo_color}var lin=grdFill["a:lin"],rot=90;void 0!==lin&&(rot=angleToDegrees(lin.attrs.ang),rot+=90),bgcolor="background: linear-gradient("+rot+"deg,";for(var i=0;i<gsLst.length;i++)bgcolor+=i==gsLst.length-1?color_ary[i]+" "+pos_ary[i]+");":color_ary[i]+" "+pos_ary[i]+", "}else void 0!==phClr&&(bgcolor="background: #"+phClr+";");return bgcolor}function getBgPicFill(bgPr,sorce,warpObj,phClr,index){var bgcolor,picFillBase64=getPicFill(sorce,bgPr["a:blipFill"],warpObj),ordr=bgPr.attrs.order,aBlipNode=bgPr["a:blipFill"]["a:blip"],duotone=getTextByPathList(aBlipNode,["a:duotone"]);if(void 0!==duotone){var clr_ary=[];Object.keys(duotone).forEach(function(clr_type){if("attrs"!=clr_type){var obj={};obj[clr_type]=duotone[clr_type],clr_ary.push(getSolidFill(obj,void 0,phClr,warpObj))}})}var aphaModFixNode=getTextByPathList(aBlipNode,["a:alphaModFix","attrs"]),imgOpacity="";if(void 0!==aphaModFixNode&&void 0!==aphaModFixNode.amt&&""!=aphaModFixNode.amt){var amt=parseInt(aphaModFixNode.amt)/1e5;imgOpacity="opacity:"+amt+";"}var tileNode=getTextByPathList(bgPr,["a:blipFill","a:tile","attrs"]),prop_style="";if(void 0!==tileNode&&void 0!==tileNode.sx){parseInt(tileNode.sx)/1e5,parseInt(tileNode.sy)/1e5,parseInt(tileNode.tx)/1e5,parseInt(tileNode.ty)/1e5,tileNode.algn,tileNode.flip;prop_style+="background-repeat: round;"}var stretch=getTextByPathList(bgPr,["a:blipFill","a:stretch"]);if(void 0!==stretch){var fillRect=getTextByPathList(stretch,["a:fillRect","attrs"]);prop_style+="background-repeat: no-repeat;",prop_style+="background-position: center;",void 0!==fillRect&&(prop_style+="background-size:  100% 100%;;")}return bgcolor="background: url("+picFillBase64+");  z-index: "+ordr+";"+prop_style+imgOpacity}function getShapeFill(node,pNode,isSvgMode,warpObj,source){var fillColor,fillType=getFillType(getTextByPathList(node,["p:spPr"]));if("NO_FILL"==fillType)return isSvgMode?"none":"";if("SOLID_FILL"==fillType){var shpFill=node["p:spPr"]["a:solidFill"];fillColor=getSolidFill(shpFill,void 0,void 0,warpObj)}else if("GRADIENT_FILL"==fillType){var shpFill=node["p:spPr"]["a:gradFill"];fillColor=getGradientFill(shpFill,warpObj)}else if("PATTERN_FILL"==fillType){var shpFill=node["p:spPr"]["a:pattFill"];fillColor=getPatternFill(shpFill,warpObj)}else if("PIC_FILL"==fillType){var shpFill=node["p:spPr"]["a:blipFill"];fillColor=getPicFill(source,shpFill,warpObj)}if(void 0===fillColor){var clrName=getTextByPathList(node,["p:style","a:fillRef"]),idx=parseInt(getTextByPathList(node,["p:style","a:fillRef","attrs","idx"]));if(0==idx||1e3==idx)return isSvgMode?"none":"";fillColor=getSolidFill(clrName,void 0,void 0,warpObj)}if(void 0===fillColor){var grpFill=getTextByPathList(node,["p:spPr","a:grpFill"]);if(void 0!==grpFill){var grpShpFill=pNode["p:grpSpPr"],spShpNode={"p:spPr":grpShpFill};return getShapeFill(spShpNode,node,isSvgMode,warpObj,source)}if("NO_FILL"==fillType)return isSvgMode?"none":""}if(void 0!==fillColor){if("GRADIENT_FILL"==fillType){if(isSvgMode)return fillColor;for(var colorAry=fillColor.color,rot=fillColor.rot,bgcolor="background: linear-gradient("+rot+"deg,",i=0;i<colorAry.length;i++)bgcolor+=i==colorAry.length-1?"#"+colorAry[i]+");":"#"+colorAry[i]+", ";return bgcolor}if("PIC_FILL"==fillType)return isSvgMode?fillColor:"background-image:url("+fillColor+");";if("PATTERN_FILL"==fillType){var bgPtrn="",bgSize="",bgPos="";return bgPtrn=fillColor[0],null!==fillColor[1]&&void 0!==fillColor[1]&&""!=fillColor[1]&&(bgSize=" background-size:"+fillColor[1]+";"),null!==fillColor[2]&&void 0!==fillColor[2]&&""!=fillColor[2]&&(bgPos=" background-position:"+fillColor[2]+";"),"background: "+bgPtrn+";"+bgSize+bgPos}if(isSvgMode){var color=tinycolor(fillColor);return fillColor=color.toRgbString()}return"background-color: #"+fillColor+";"}return isSvgMode?"none":""}function getFillType(node){var fillType="";return void 0!==node["a:noFill"]&&(fillType="NO_FILL"),void 0!==node["a:solidFill"]&&(fillType="SOLID_FILL"),void 0!==node["a:gradFill"]&&(fillType="GRADIENT_FILL"),void 0!==node["a:pattFill"]&&(fillType="PATTERN_FILL"),void 0!==node["a:blipFill"]&&(fillType="PIC_FILL"),void 0!==node["a:grpFill"]&&(fillType="GROUP_FILL"),fillType}function getGradientFill(node,warpObj){for(var gsLst=node["a:gsLst"]["a:gs"],color_ary=[],i=0;i<gsLst.length;i++){var lo_color=getSolidFill(gsLst[i],void 0,void 0,warpObj);color_ary[i]=lo_color}var lin=node["a:lin"],rot=0;return void 0!==lin&&(rot=angleToDegrees(lin.attrs.ang)+90),{color:color_ary,rot:rot}}function getPicFill(type,node,warpObj){var img,imgPath,rId=node["a:blip"].attrs["r:embed"];if("slideBg"==type||"slide"==type?imgPath=getTextByPathList(warpObj,["slideResObj",rId,"target"]):"slideLayoutBg"==type?imgPath=getTextByPathList(warpObj,["layoutResObj",rId,"target"]):"slideMasterBg"==type?imgPath=getTextByPathList(warpObj,["masterResObj",rId,"target"]):"themeBg"==type?imgPath=getTextByPathList(warpObj,["themeResObj",rId,"target"]):"diagramBg"==type&&(imgPath=getTextByPathList(warpObj,["diagramResObj",rId,"target"])),void 0===imgPath)return void 0;if(img=getTextByPathList(warpObj,["loaded-images",imgPath]),void 0===img){imgPath=escapeHtml(imgPath);var imgExt=imgPath.split(".").pop();if("xml"==imgExt)return void 0;var imgArrayBuffer=warpObj.zip.file(imgPath).asArrayBuffer(),imgMimeType=getMimeType(imgExt);img="data:"+imgMimeType+";base64,"+base64ArrayBuffer(imgArrayBuffer),setTextByPathList(warpObj,["loaded-images",imgPath],img)}return img}function getPatternFill(node,warpObj){var fgColor="",bgColor="",prst="",bgClr=node["a:bgClr"],fgClr=node["a:fgClr"];prst=node.attrs.prst,fgColor=getSolidFill(fgClr,void 0,void 0,warpObj),bgColor=getSolidFill(bgClr,void 0,void 0,warpObj);var linear_gradient=getLinerGrandient(prst,bgColor,fgColor);return linear_gradient}function getLinerGrandient(prst,bgColor,fgColor){switch(prst){case"smGrid":return["linear-gradient(to right,  #"+fgColor+" -1px, transparent 1px ), linear-gradient(to bottom,  #"+fgColor+" -1px, transparent 1px)  #"+bgColor+";","4px 4px"];case"dotGrid":return["linear-gradient(to right,  #"+fgColor+" -1px, transparent 1px ), linear-gradient(to bottom,  #"+fgColor+" -1px, transparent 1px)  #"+bgColor+";","8px 8px"];case"lgGrid":return["linear-gradient(to right,  #"+fgColor+" -1px, transparent 1.5px ), linear-gradient(to bottom,  #"+fgColor+" -1px, transparent 1.5px)  #"+bgColor+";","8px 8px"];case"wdUpDiag":return["repeating-linear-gradient(-45deg, transparent 1px , transparent 4px, #"+fgColor+" 7px)#"+bgColor+";"];case"dkUpDiag":return["repeating-linear-gradient(-45deg, transparent 1px , #"+bgColor+" 5px)#"+fgColor+";"];case"ltUpDiag":return["repeating-linear-gradient(-45deg, transparent 1px , transparent 2px, #"+fgColor+" 4px)#"+bgColor+";"];case"wdDnDiag":return["repeating-linear-gradient(45deg, transparent 1px , transparent 4px, #"+fgColor+" 7px)#"+bgColor+";"];case"dkDnDiag":return["repeating-linear-gradient(45deg, transparent 1px , #"+bgColor+" 5px)#"+fgColor+";"];case"ltDnDiag":return["repeating-linear-gradient(45deg, transparent 1px , transparent 2px, #"+fgColor+" 4px)#"+bgColor+";"];case"dkHorz":return["repeating-linear-gradient(0deg, transparent 1px , transparent 2px, #"+bgColor+" 7px)#"+fgColor+";"];case"ltHorz":return["repeating-linear-gradient(0deg, transparent 1px , transparent 5px, #"+fgColor+" 7px)#"+bgColor+";"];case"narHorz":return["repeating-linear-gradient(0deg, transparent 1px , transparent 2px, #"+fgColor+" 4px)#"+bgColor+";"];case"dkVert":return["repeating-linear-gradient(90deg, transparent 1px , transparent 2px, #"+bgColor+" 7px)#"+fgColor+";"];case"ltVert":return["repeating-linear-gradient(90deg, transparent 1px , transparent 5px, #"+fgColor+" 7px)#"+bgColor+";"];case"narVert":return["repeating-linear-gradient(90deg, transparent 1px , transparent 2px, #"+fgColor+" 4px)#"+bgColor+";"];case"lgCheck":case"smCheck":var size="",pos="";return"lgCheck"==prst?(size="8px 8px",pos="0 0, 4px 4px, 4px 4px, 8px 8px"):(size="4px 4px",pos="0 0, 2px 2px, 2px 2px, 4px 4px"),["linear-gradient(45deg,  #"+fgColor+" 25%, transparent 0, transparent 75%,  #"+fgColor+" 0), linear-gradient(45deg,  #"+fgColor+" 25%, transparent 0, transparent 75%,  #"+fgColor+" 0) #"+bgColor+";",size,pos];case"dashUpDiag":return["repeating-linear-gradient(152deg, #"+fgColor+", #"+fgColor+" 5% , transparent 0, transparent 70%)#"+bgColor+";","4px 4px"];case"dashDnDiag":return["repeating-linear-gradient(45deg, #"+fgColor+", #"+fgColor+" 5% , transparent 0, transparent 70%)#"+bgColor+";","4px 4px"];case"diagBrick":return["linear-gradient(45deg, transparent 15%,  #"+fgColor+" 30%, transparent 30%), linear-gradient(-45deg, transparent 15%,  #"+fgColor+" 30%, transparent 30%), linear-gradient(-45deg, transparent 65%,  #"+fgColor+" 80%, transparent 0) #"+bgColor+";","4px 4px"];case"horzBrick":return["linear-gradient(335deg, #"+bgColor+" 1.6px, transparent 1.6px), linear-gradient(155deg, #"+bgColor+" 1.6px, transparent 1.6px), linear-gradient(335deg, #"+bgColor+" 1.6px, transparent 1.6px), linear-gradient(155deg, #"+bgColor+" 1.6px, transparent 1.6px) #"+fgColor+";","4px 4px","0 0.15px, 0.3px 2.5px, 2px 2.15px, 2.35px 0.4px"];case"dashVert":return["linear-gradient(0deg,  #"+bgColor+" 30%, transparent 30%),linear-gradient(90deg,transparent, transparent 40%, #"+fgColor+" 40%, #"+fgColor+" 60% , transparent 60%)#"+bgColor+";","4px 4px"];case"dashHorz":return["linear-gradient(90deg,  #"+bgColor+" 30%, transparent 30%),linear-gradient(0deg,transparent, transparent 40%, #"+fgColor+" 40%, #"+fgColor+" 60% , transparent 60%)#"+bgColor+";","4px 4px"];case"solidDmnd":return["linear-gradient(135deg,  #"+fgColor+" 25%, transparent 25%), linear-gradient(225deg,  #"+fgColor+" 25%, transparent 25%), linear-gradient(315deg,  #"+fgColor+" 25%, transparent 25%), linear-gradient(45deg,  #"+fgColor+" 25%, transparent 25%) #"+bgColor+";","8px 8px"];case"openDmnd":return["linear-gradient(45deg, transparent 0%, transparent calc(50% - 0.5px),  #"+fgColor+" 50%, transparent calc(50% + 0.5px),  transparent 100%), linear-gradient(-45deg, transparent 0%, transparent calc(50% - 0.5px) , #"+fgColor+" 50%, transparent calc(50% + 0.5px),  transparent 100%) #"+bgColor+";","8px 8px"];case"dotDmnd":return["radial-gradient(#"+fgColor+" 15%, transparent 0), radial-gradient(#"+fgColor+" 15%, transparent 0) #"+bgColor+";","4px 4px","0 0, 2px 2px"];case"zigZag":case"wave":var size="";return size="zigZag"==prst?"0":"1px",["linear-gradient(135deg,  #"+fgColor+" 25%, transparent 25%) 50px "+size+", linear-gradient(225deg,  #"+fgColor+" 25%, transparent 25%) 50px "+size+", linear-gradient(315deg,  #"+fgColor+" 25%, transparent 25%), linear-gradient(45deg,  #"+fgColor+" 25%, transparent 25%) #"+bgColor+";","4px 4px"];case"lgConfetti":case"smConfetti":var size="";return size="lgConfetti"==prst?"4px 4px":"2px 2px",["linear-gradient(135deg,  #"+fgColor+" 25%, transparent 25%) 50px 1px, linear-gradient(225deg,  #"+fgColor+" 25%, transparent 25%), linear-gradient(315deg,  #"+fgColor+" 25%, transparent 25%) 50px 1px , linear-gradient(45deg,  #"+fgColor+" 25%, transparent 25%) #"+bgColor+";",size];case"plaid":return["linear-gradient(0deg, transparent, transparent 25%, #"+fgColor+"33 25%, #"+fgColor+"33 50%),linear-gradient(90deg, transparent, transparent 25%, #"+fgColor+"66 25%, #"+fgColor+"66 50%) #"+bgColor+";","4px 4px"];case"sphere":return["radial-gradient(#"+fgColor+" 50%, transparent 50%),#"+bgColor+";","4px 4px"];case"weave":case"shingle":return["linear-gradient(45deg, #"+bgColor+" 1.31px , #"+fgColor+" 1.4px, #"+fgColor+" 1.5px, transparent 1.5px, transparent 4.2px, #"+fgColor+" 4.2px, #"+fgColor+" 4.3px, transparent 4.31px), linear-gradient(-45deg,  #"+bgColor+" 1.31px , #"+fgColor+" 1.4px, #"+fgColor+" 1.5px, transparent 1.5px, transparent 4.2px, #"+fgColor+" 4.2px, #"+fgColor+" 4.3px, transparent 4.31px) 0 4px, #"+bgColor+";","4px 8px"];case"pct5":case"pct10":case"pct20":case"pct25":case"pct30":case"pct40":case"pct50":case"pct60":case"pct70":case"pct75":case"pct80":case"pct90":case"trellis":case"divot":var px_pr_ary;switch(prst){case"pct5":px_pr_ary=["0.3px","10%","2px 2px"];break;case"divot":px_pr_ary=["0.3px","40%","4px 4px"];break;case"pct10":px_pr_ary=["0.3px","20%","2px 2px"];break;case"pct20":px_pr_ary=["0.2px","40%","2px 2px"];break;case"pct25":px_pr_ary=["0.2px","50%","2px 2px"];break;case"pct30":px_pr_ary=["0.5px","50%","2px 2px"];break;case"pct40":px_pr_ary=["0.5px","70%","2px 2px"];break;case"pct50":px_pr_ary=["0.09px","90%","2px 2px"];break;case"pct60":px_pr_ary=["0.3px","90%","2px 2px"];break;case"pct70":case"trellis":px_pr_ary=["0.5px","95%","2px 2px"];break;case"pct75":px_pr_ary=["0.65px","100%","2px 2px"];break;case"pct80":px_pr_ary=["0.85px","100%","2px 2px"];break;case"pct90":px_pr_ary=["1px","100%","2px 2px"]}return["radial-gradient(#"+fgColor+" "+px_pr_ary[0]+", transparent "+px_pr_ary[1]+"),#"+bgColor+";",px_pr_ary[2]];default:return[0,0]}}function getSolidFill(node,clrMap,phClr,warpObj){if(void 0===node)return void 0;var clrNode,color="";if(void 0!==node["a:srgbClr"])clrNode=node["a:srgbClr"],color=getTextByPathList(clrNode,["attrs","val"]);else if(void 0!==node["a:schemeClr"]){clrNode=node["a:schemeClr"];var schemeClr=getTextByPathList(clrNode,["attrs","val"]);color=getSchemeColorFromTheme("a:"+schemeClr,clrMap,phClr,warpObj)}else if(void 0!==node["a:scrgbClr"]){clrNode=node["a:scrgbClr"];var defBultColorVals=clrNode.attrs,red=-1!=defBultColorVals.r.indexOf("%")?defBultColorVals.r.split("%").shift():defBultColorVals.r,green=-1!=defBultColorVals.g.indexOf("%")?defBultColorVals.g.split("%").shift():defBultColorVals.g,blue=-1!=defBultColorVals.b.indexOf("%")?defBultColorVals.b.split("%").shift():defBultColorVals.b;color=toHex(255*(Number(red)/100))+toHex(255*(Number(green)/100))+toHex(255*(Number(blue)/100))}else if(void 0!==node["a:prstClr"]){clrNode=node["a:prstClr"];var prstClr=getTextByPathList(clrNode,["attrs","val"]);color=getColorName2Hex(prstClr)}else if(void 0!==node["a:hslClr"]){clrNode=node["a:hslClr"];var defBultColorVals=clrNode.attrs,hue=Number(defBultColorVals.hue)/1e5,sat=Number(-1!=defBultColorVals.sat.indexOf("%")?defBultColorVals.sat.split("%").shift():defBultColorVals.sat)/100,lum=Number(-1!=defBultColorVals.lum.indexOf("%")?defBultColorVals.lum.split("%").shift():defBultColorVals.lum)/100,hsl2rgb=hslToRgb(hue,sat,lum);color=toHex(hsl2rgb.r)+toHex(hsl2rgb.g)+toHex(hsl2rgb.b)}else if(void 0!==node["a:sysClr"]){clrNode=node["a:sysClr"];var sysClr=getTextByPathList(clrNode,["attrs","lastClr"]);void 0!==sysClr&&(color=sysClr)}var isAlpha=!1,alpha=parseInt(getTextByPathList(clrNode,["a:alpha","attrs","val"]))/1e5;if(!isNaN(alpha)){var al_color=tinycolor(color);al_color.setAlpha(alpha),color=al_color.toHex8(),isAlpha=!0}var hueMod=parseInt(getTextByPathList(clrNode,["a:hueMod","attrs","val"]))/1e5;isNaN(hueMod)||(color=applyHueMod(color,hueMod,isAlpha));var lumMod=parseInt(getTextByPathList(clrNode,["a:lumMod","attrs","val"]))/1e5;isNaN(lumMod)||(color=applyLumMod(color,lumMod,isAlpha));var lumOff=parseInt(getTextByPathList(clrNode,["a:lumOff","attrs","val"]))/1e5;isNaN(lumOff)||(color=applyLumOff(color,lumOff,isAlpha));var satMod=parseInt(getTextByPathList(clrNode,["a:satMod","attrs","val"]))/1e5;isNaN(satMod)||(color=applySatMod(color,satMod,isAlpha));var shade=parseInt(getTextByPathList(clrNode,["a:shade","attrs","val"]))/1e5;isNaN(shade)||(color=applyShade(color,shade,isAlpha));var tint=parseInt(getTextByPathList(clrNode,["a:tint","attrs","val"]))/1e5;return isNaN(tint)||(color=applyTint(color,tint,isAlpha)),color}function toHex(n){for(var hex=n.toString(16);hex.length<2;)hex="0"+hex;return hex}function hslToRgb(hue,sat,light){var t1,t2,r,g,b;return hue/=60,t2=.5>=light?light*(sat+1):light+sat-light*sat,t1=2*light-t2,r=255*hueToRgb(t1,t2,hue+2),g=255*hueToRgb(t1,t2,hue),b=255*hueToRgb(t1,t2,hue-2),{r:r,g:g,b:b}}function hueToRgb(t1,t2,hue){return 0>hue&&(hue+=6),hue>=6&&(hue-=6),1>hue?(t2-t1)*hue+t1:3>hue?t2:4>hue?(t2-t1)*(4-hue)+t1:t1}function getColorName2Hex(name){var hex,colorName=["white","AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"],colorHex=["ffffff","f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"],findIndx=colorName.indexOf(name);
return-1!=findIndx&&(hex=colorHex[findIndx]),hex}function getSchemeColorFromTheme(schemeClr,clrMap,phClr,warpObj){var slideLayoutClrOvride;if(void 0!==clrMap)slideLayoutClrOvride=clrMap;else{var sldClrMapOvr=getTextByPathList(warpObj.slideContent,["p:sld","p:clrMapOvr","a:overrideClrMapping","attrs"]);if(void 0!==sldClrMapOvr)slideLayoutClrOvride=sldClrMapOvr;else{var sldClrMapOvr=getTextByPathList(warpObj.slideLayoutContent,["p:sldLayout","p:clrMapOvr","a:overrideClrMapping","attrs"]);slideLayoutClrOvride=void 0!==sldClrMapOvr?sldClrMapOvr:getTextByPathList(warpObj.slideMasterContent,["p:sldMaster","p:clrMap","attrs"])}}var schmClrName=schemeClr.substr(2);if("phClr"==schmClrName&&void 0!==phClr)color=phClr;else{if(void 0!==slideLayoutClrOvride)switch(schmClrName){case"tx1":case"tx2":case"bg1":case"bg2":schemeClr="a:"+slideLayoutClrOvride[schmClrName]}else switch(schmClrName){case"tx1":schemeClr="a:dk1";break;case"tx2":schemeClr="a:dk2";break;case"bg1":schemeClr="a:lt1";break;case"bg2":schemeClr="a:lt2"}var refNode=getTextByPathList(warpObj.themeContent,["a:theme","a:themeElements","a:clrScheme",schemeClr]),color=getTextByPathList(refNode,["a:srgbClr","attrs","val"]);void 0===color&&void 0!==refNode&&(color=getTextByPathList(refNode,["a:sysClr","attrs","lastClr"]))}return color}function extractChartData(serNode){var dataMat=new Array;if(void 0===serNode)return dataMat;if(void 0!==serNode["c:xVal"]){var dataRow=new Array;eachElement(serNode["c:xVal"]["c:numRef"]["c:numCache"]["c:pt"],function(innerNode,index){return dataRow.push(parseFloat(innerNode["c:v"])),""}),dataMat.push(dataRow),dataRow=new Array,eachElement(serNode["c:yVal"]["c:numRef"]["c:numCache"]["c:pt"],function(innerNode,index){return dataRow.push(parseFloat(innerNode["c:v"])),""}),dataMat.push(dataRow)}else eachElement(serNode,function(innerNode,index){var dataRow=new Array,colName=getTextByPathList(innerNode,["c:tx","c:strRef","c:strCache","c:pt","c:v"])||index,rowNames={};return void 0!==getTextByPathList(innerNode,["c:cat","c:strRef","c:strCache","c:pt"])?eachElement(innerNode["c:cat"]["c:strRef"]["c:strCache"]["c:pt"],function(innerNode,index){return rowNames[innerNode.attrs.idx]=innerNode["c:v"],""}):void 0!==getTextByPathList(innerNode,["c:cat","c:numRef","c:numCache","c:pt"])&&eachElement(innerNode["c:cat"]["c:numRef"]["c:numCache"]["c:pt"],function(innerNode,index){return rowNames[innerNode.attrs.idx]=innerNode["c:v"],""}),void 0!==getTextByPathList(innerNode,["c:val","c:numRef","c:numCache","c:pt"])&&eachElement(innerNode["c:val"]["c:numRef"]["c:numCache"]["c:pt"],function(innerNode,index){return dataRow.push({x:innerNode.attrs.idx,y:parseFloat(innerNode["c:v"])}),""}),dataMat.push({key:colName,values:dataRow,xlabels:rowNames}),""});return dataMat}function getTextByPathList(node,path){if(path.constructor!==Array)throw Error("Error of path type! path is not array.");if(void 0===node)return void 0;for(var l=path.length,i=0;l>i;i++)if(node=node[path[i]],void 0===node)return void 0;return node}function setTextByPathList(node,path,value){if(path.constructor!==Array)throw Error("Error of path type! path is not array.");if(void 0===node)return void 0;var nodeSet=function(parts,value){for(var obj=this,lent=parts.length,i=0;lent>i;i++){var p=parts[i];void 0===obj[p]&&(i==lent-1?obj[p]=value:obj[p]={}),obj=obj[p]}return obj};nodeSet(path,value)}function eachElement(node,doFunction){if(void 0!==node){var result="";if(node.constructor===Array)for(var l=node.length,i=0;l>i;i++)result+=doFunction(node[i],i);else result+=doFunction(node,0);return result}}function applyShade(rgbStr,shadeValue,isAlpha){var color=tinycolor(rgbStr).toHsl();shadeValue>=1&&(shadeValue=1);var cacl_l=Math.min(color.l*shadeValue,1);return isAlpha?tinycolor({h:color.h,s:color.s,l:cacl_l,a:color.a}).toHex8():tinycolor({h:color.h,s:color.s,l:cacl_l,a:color.a}).toHex()}function applyTint(rgbStr,tintValue,isAlpha){var color=tinycolor(rgbStr).toHsl();tintValue>=1&&(tintValue=1);var cacl_l=color.l*tintValue+(1-tintValue);return isAlpha?tinycolor({h:color.h,s:color.s,l:cacl_l,a:color.a}).toHex8():tinycolor({h:color.h,s:color.s,l:cacl_l,a:color.a}).toHex()}function applyLumOff(rgbStr,offset,isAlpha){var color=tinycolor(rgbStr).toHsl(),lum=offset+color.l;return lum>=1?isAlpha?tinycolor({h:color.h,s:color.s,l:1,a:color.a}).toHex8():tinycolor({h:color.h,s:color.s,l:1,a:color.a}).toHex():isAlpha?tinycolor({h:color.h,s:color.s,l:lum,a:color.a}).toHex8():tinycolor({h:color.h,s:color.s,l:lum,a:color.a}).toHex()}function applyLumMod(rgbStr,multiplier,isAlpha){var color=tinycolor(rgbStr).toHsl(),cacl_l=color.l*multiplier;return cacl_l>=1&&(cacl_l=1),isAlpha?tinycolor({h:color.h,s:color.s,l:cacl_l,a:color.a}).toHex8():tinycolor({h:color.h,s:color.s,l:cacl_l,a:color.a}).toHex()}function applyHueMod(rgbStr,multiplier,isAlpha){var color=tinycolor(rgbStr).toHsl(),cacl_h=color.h*multiplier;return cacl_h>=360&&(cacl_h-=360),isAlpha?tinycolor({h:cocacl_h,s:color.s,l:color.l,a:color.a}).toHex8():tinycolor({h:cacl_h,s:color.s,l:color.l,a:color.a}).toHex()}function applySatMod(rgbStr,multiplier,isAlpha){var color=tinycolor(rgbStr).toHsl(),cacl_s=color.s*multiplier;return cacl_s>=1&&(cacl_s=1),isAlpha?tinycolor({h:color.h,s:cacl_s,l:color.l,a:color.a}).toHex8():tinycolor({h:color.h,s:cacl_s,l:color.l,a:color.a}).toHex()}function angleToDegrees(angle){return""==angle||null==angle?0:Math.round(angle/6e4)}function getMimeType(imgFileExt){var mimeType="";switch(imgFileExt.toLowerCase()){case"jpg":case"jpeg":mimeType="image/jpeg";break;case"png":mimeType="image/png";break;case"gif":mimeType="image/gif";break;case"emf":mimeType="image/x-emf";break;case"wmf":mimeType="image/x-wmf";break;case"svg":mimeType="image/svg+xml";break;case"mp4":mimeType="video/mp4";break;case"webm":mimeType="video/webm";break;case"ogg":mimeType="video/ogg";break;case"avi":mimeType="video/avi";break;case"mpg":mimeType="video/mpg";break;case"wmv":mimeType="video/wmv";break;case"mp3":mimeType="audio/mpeg";break;case"wav":mimeType="audio/wav";break;case"emf":mimeType="image/emf";break;case"wmf":mimeType="image/wmf";case"tif":case"tiff":mimeType="image/tiff"}return mimeType}function getSvgGradient(w,h,angl,color_arry,shpId){var stopsArray=getMiddleStops(color_arry-2),svgAngle="",svgHeight=h,svgWidth=w,svg="",xy_ary=SVGangle(angl,svgHeight,svgWidth),x1=xy_ary[0],y1=xy_ary[1],x2=xy_ary[2],y2=xy_ary[3],sal=stopsArray.length,sr=20>sal?100:1e3;svgAngle=' gradientUnits="userSpaceOnUse" x1="'+x1+'%" y1="'+y1+'%" x2="'+x2+'%" y2="'+y2+'%"',svgAngle='<linearGradient id="linGrd_'+shpId+'"'+svgAngle+">\n",svg+=svgAngle;for(var i=0;sal>i;i++){var tinClr=tinycolor("#"+color_arry[i]),alpha=tinClr.getAlpha();svg+='<stop offset="'+Math.round(parseFloat(stopsArray[i])/100*sr)/sr+'" style="stop-color:'+tinClr.toHexString()+"; stop-opacity:"+alpha+';"',svg+="/>\n"}return svg+="</linearGradient>\n"}function getMiddleStops(s){var sArry=["0%","100%"];if(0==s)return sArry;for(var i=s;i--;){var middleStop=100-100/(s+1)*(i+1),middleStopString=middleStop+"%";sArry.splice(-1,0,middleStopString)}return sArry}function SVGangle(deg,svgHeight,svgWidth){var w=parseFloat(svgWidth),h=parseFloat(svgHeight),ang=parseFloat(deg),o=2,n=2,wc=w/2,hc=h/2,tx1=2,ty1=2,tx2=2,ty2=2,k=(ang%360+360)%360,j=(360-k)*Math.PI/180,i=Math.tan(j),l=hc-i*wc;0==k?(tx1=w,ty1=hc,tx2=0,ty2=hc):90>k?(n=w,o=0):90==k?(tx1=wc,ty1=0,tx2=wc,ty2=h):180>k?(n=0,o=0):180==k?(tx1=0,ty1=hc,tx2=w,ty2=hc):270>k?(n=0,o=h):270==k?(tx1=wc,ty1=h,tx2=wc,ty2=0):(n=w,o=h);var m=o+n/i,tx1=2==tx1?i*(m-l)/(Math.pow(i,2)+1):tx1,ty1=2==ty1?i*tx1+l:ty1,tx2=2==tx2?w-tx1:tx2,ty2=2==ty2?h-ty1:ty2,x1=Math.round(tx2/w*100*100)/100,y1=Math.round(ty2/h*100*100)/100,x2=Math.round(tx1/w*100*100)/100,y2=Math.round(ty1/h*100*100)/100;return[x1,y1,x2,y2]}function getSvgImagePattern(node,fill,shpId,warpObj){var pic_dim=getBase64ImageDimensions(fill),width=pic_dim[0],height=pic_dim[1],blipFillNode=node["p:spPr"]["a:blipFill"],tileNode=getTextByPathList(blipFillNode,["a:tile","attrs"]);if(void 0!==tileNode&&void 0!==tileNode.sx)var sx=parseInt(tileNode.sx)/1e5*width,sy=parseInt(tileNode.sy)/1e5*height;var blipNode=node["p:spPr"]["a:blipFill"]["a:blip"],tialphaModFixNode=getTextByPathList(blipNode,["a:alphaModFix","attrs"]),imgOpacity="";if(void 0!==tialphaModFixNode&&void 0!==tialphaModFixNode.amt&&""!=tialphaModFixNode.amt)var amt=parseInt(tialphaModFixNode.amt)/1e5,opacity=amt,imgOpacity="opacity='"+opacity+"'";if(void 0!==sx&&0!=sx)var ptrn='<pattern id="imgPtrn_'+shpId+'" x="0" y="0"  width="'+sx+'" height="'+sy+'" patternUnits="userSpaceOnUse">';else var ptrn='<pattern id="imgPtrn_'+shpId+'"  patternContentUnits="objectBoundingBox"  width="1" height="1">';var duotoneNode=getTextByPathList(blipNode,["a:duotone"]),fillterNode="",filterUrl="";if(void 0!==duotoneNode){var clr_ary=[];Object.keys(duotoneNode).forEach(function(clr_type){if("attrs"!=clr_type){var obj={};obj[clr_type]=duotoneNode[clr_type];var hexClr=getSolidFill(obj,void 0,void 0,warpObj),color=tinycolor("#"+hexClr);clr_ary.push(color.toRgb())}}),2==clr_ary.length&&(fillterNode='<filter id="svg_image_duotone"> <feColorMatrix type="matrix" values=".33 .33 .33 0 0.33 .33 .33 0 0.33 .33 .33 0 00 0 0 1 0"></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="'+clr_ary[0].r/255+" "+clr_ary[1].r/255+'"></feFuncR><feFuncG type="table" tableValues="'+clr_ary[0].g/255+" "+clr_ary[1].g/255+'"></feFuncG><feFuncB type="table" tableValues="'+clr_ary[0].b/255+" "+clr_ary[1].b/255+'"></feFuncB></feComponentTransfer> </filter>'),filterUrl='filter="url(#svg_image_duotone)"',ptrn+=fillterNode}return fill=escapeHtml(fill),ptrn+=void 0!==sx&&0!=sx?'<image  xlink:href="'+fill+'" x="0" y="0" width="'+sx+'" height="'+sy+'" '+imgOpacity+" "+filterUrl+"></image>":'<image  xlink:href="'+fill+'" preserveAspectRatio="none" width="1" height="1" '+imgOpacity+" "+filterUrl+"></image>",ptrn+="</pattern>"}function getBase64ImageDimensions(imgSrc){var w,h,image=new Image;image.onload=function(){w=image.width,h=image.height},image.src=imgSrc;do if(void 0!==image.width)return[image.width,image.height];while(void 0===image.width)}function processMsgQueue(queue){for(var i=0;i<queue.length;i++)processSingleMsg(queue[i].data)}function processSingleMsg(d){var chartID=d.chartID,chartType=d.chartType,chartData=d.chartData,data=[],chart=null;switch(chartType){case"lineChart":data=chartData,chart=nv.models.lineChart().useInteractiveGuideline(!0),chart.xAxis.tickFormat(function(d){return chartData[0].xlabels[d]||d});break;case"barChart":data=chartData,chart=nv.models.multiBarChart(),chart.xAxis.tickFormat(function(d){return chartData[0].xlabels[d]||d});break;case"pieChart":case"pie3DChart":chartData.length>0&&(data=chartData[0].values),chart=nv.models.pieChart();break;case"areaChart":data=chartData,chart=nv.models.stackedAreaChart().clipEdge(!0).useInteractiveGuideline(!0),chart.xAxis.tickFormat(function(d){return chartData[0].xlabels[d]||d});break;case"scatterChart":for(var i=0;i<chartData.length;i++){for(var arr=[],j=0;j<chartData[i].length;j++)arr.push({x:j,y:chartData[i][j]});data.push({key:"data"+(i+1),values:arr})}chart=nv.models.scatterChart().showDistX(!0).showDistY(!0).color(d3.scale.category10().range()),chart.xAxis.axisLabel("X").tickFormat(d3.format(".02f")),chart.yAxis.axisLabel("Y").tickFormat(d3.format(".02f"))}null!==chart&&(d3.select("#"+chartID).append("svg").datum(data).transition().duration(500).call(chart),nv.utils.windowResize(chart.update),isDone=!0)}function setNumericBullets(elem){for(var prgrphs_arry=elem,i=0;i<prgrphs_arry.length;i++){var buSpan=$(prgrphs_arry[i]).find(".numeric-bullet-style");if(buSpan.length>0)for(var prevBultTyp="",prevBultLvl="",buletIndex=0,tmpArry=new Array,tmpArryIndx=0,buletTypSrry=new Array,j=0;j<buSpan.length;j++){var bult_typ=$(buSpan[j]).data("bulltname"),bult_lvl=$(buSpan[j]).data("bulltlvl");0==buletIndex?(prevBultTyp=bult_typ,prevBultLvl=bult_lvl,tmpArry[tmpArryIndx]=buletIndex,buletTypSrry[tmpArryIndx]=bult_typ,buletIndex++):bult_typ==prevBultTyp&&bult_lvl==prevBultLvl?(prevBultTyp=bult_typ,prevBultLvl=bult_lvl,buletIndex++,tmpArry[tmpArryIndx]=buletIndex,buletTypSrry[tmpArryIndx]=bult_typ):bult_typ!=prevBultTyp&&bult_lvl==prevBultLvl?(prevBultTyp=bult_typ,prevBultLvl=bult_lvl,tmpArryIndx++,tmpArry[tmpArryIndx]=buletIndex,buletTypSrry[tmpArryIndx]=bult_typ,buletIndex=1):bult_typ!=prevBultTyp&&Number(bult_lvl)>Number(prevBultLvl)?(prevBultTyp=bult_typ,prevBultLvl=bult_lvl,tmpArryIndx++,tmpArry[tmpArryIndx]=buletIndex,buletTypSrry[tmpArryIndx]=bult_typ,buletIndex=1):bult_typ!=prevBultTyp&&Number(bult_lvl)<Number(prevBultLvl)&&(prevBultTyp=bult_typ,prevBultLvl=bult_lvl,tmpArryIndx--,buletIndex=tmpArry[tmpArryIndx]+1);var numIdx=getNumTypeNum(buletTypSrry[tmpArryIndx],buletIndex);$(buSpan[j]).html(numIdx)}}}function getNumTypeNum(numTyp,num){var rtrnNum="";switch(numTyp){case"arabicPeriod":rtrnNum=num+". ";break;case"arabicParenR":rtrnNum=num+") ";break;case"alphaLcParenR":rtrnNum=alphaNumeric(num,"lowerCase")+") ";break;case"alphaLcPeriod":rtrnNum=alphaNumeric(num,"lowerCase")+". ";break;case"alphaUcParenR":rtrnNum=alphaNumeric(num,"upperCase")+") ";break;case"alphaUcPeriod":rtrnNum=alphaNumeric(num,"upperCase")+". ";break;case"romanUcPeriod":rtrnNum=romanize(num)+". ";break;case"romanLcParenR":rtrnNum=romanize(num)+") ";break;case"hebrew2Minus":rtrnNum=hebrew2Minus.format(num)+"-";break;default:rtrnNum=num}return rtrnNum}function romanize(num){if(!+num)return!1;for(var digits=String(+num).split(""),key=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],roman="",i=3;i--;)roman=(key[+digits.pop()+10*i]||"")+roman;return Array(+digits.join("")+1).join("M")+roman}function archaicNumbers(arr){arr.slice().sort(function(a,b){return b[1].length-a[1].length});return{format:function(n){var ret="";return jQuery.each(arr,function(){var num=this[0];if(parseInt(num)>0)for(;n>=num;n-=num)ret+=this[1];else ret=ret.replace(num,this[1])}),ret}}}function alphaNumeric(num,upperLower){num=Number(num)-1;var aNum="";return"upperCase"==upperLower?aNum=((num/26>=1?String.fromCharCode(num/26+64):"")+String.fromCharCode(num%26+65)).toUpperCase():"lowerCase"==upperLower&&(aNum=((num/26>=1?String.fromCharCode(num/26+64):"")+String.fromCharCode(num%26+65)).toLowerCase()),aNum}function base64ArrayBuffer(arrayBuffer){for(var a,b,c,d,chunk,base64="",encodings="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bytes=new Uint8Array(arrayBuffer),byteLength=bytes.byteLength,byteRemainder=byteLength%3,mainLength=byteLength-byteRemainder,i=0;mainLength>i;i+=3)chunk=bytes[i]<<16|bytes[i+1]<<8|bytes[i+2],a=(16515072&chunk)>>18,b=(258048&chunk)>>12,c=(4032&chunk)>>6,d=63&chunk,base64+=encodings[a]+encodings[b]+encodings[c]+encodings[d];return 1==byteRemainder?(chunk=bytes[mainLength],a=(252&chunk)>>2,b=(3&chunk)<<4,base64+=encodings[a]+encodings[b]+"=="):2==byteRemainder&&(chunk=bytes[mainLength]<<8|bytes[mainLength+1],a=(64512&chunk)>>10,b=(1008&chunk)>>4,c=(15&chunk)<<2,base64+=encodings[a]+encodings[b]+encodings[c]+"="),base64}function IsVideoLink(vdoFile){var urlregex=/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/;return urlregex.test(vdoFile)}function extractFileExtension(filename){return filename.substr((~-filename.lastIndexOf(".")>>>0)+2)}function escapeHtml(text){var map={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return text.replace(/[&<>"']/g,function(m){return map[m]})}function tXml(t,r){"use strict";function e(){for(var r=[];t[l];)if(t.charCodeAt(l)==s){if(t.charCodeAt(l+1)===h)return l=t.indexOf(u,l),l+1&&(l+=1),r;if(t.charCodeAt(l+1)===v){if(t.charCodeAt(l+2)==m){for(;-1!==l&&(t.charCodeAt(l)!==d||t.charCodeAt(l-1)!=m||t.charCodeAt(l-2)!=m||-1==l);)l=t.indexOf(u,l+1);-1===l&&(l=t.length)}else for(l+=2;t.charCodeAt(l)!==d&&t[l];)l++;l++;continue}var e=a();r.push(e)}else{var i=n();i.trim().length>0&&r.push(i),l++}return r}function n(){var r=l;return l=t.indexOf(c,l)-1,-2===l&&(l=t.length),t.slice(r,l+1)}function i(){for(var r=l;-1===A.indexOf(t[l])&&t[l];)l++;return t.slice(r,l)}function a(){var r={};l++,r.tagName=i();for(var n=!1;t.charCodeAt(l)!==d&&t[l];){var a=t.charCodeAt(l);if(a>64&&91>a||a>96&&123>a){for(var f=i(),c=t.charCodeAt(l);c&&c!==p&&c!==g&&!(c>64&&91>c||c>96&&123>c)&&c!==d;)l++,c=t.charCodeAt(l);if(n||(r.attributes={},n=!0),c===p||c===g){var s=o();if(-1===l)return r}else s=null,l--;r.attributes[f]=s}l++}if(t.charCodeAt(l-1)!==h)if("script"==r.tagName){var u=l+1;l=t.indexOf("</script>",l),r.children=[t.slice(u,l-1)],l+=8}else if("style"==r.tagName){var u=l+1;l=t.indexOf("</style>",l),r.children=[t.slice(u,l-1)],l+=7}else-1==C.indexOf(r.tagName)&&(l++,r.children=e(f));else l++;return r}function o(){var r=t[l],e=++l;return l=t.indexOf(r,e),t.slice(e,l)}function f(){var e=new RegExp("\\s"+r.attrName+"\\s*=['\"]"+r.attrValue+"['\"]").exec(t);return e?e.index:-1}r=r||{};var l=r.pos||0,c="<",s="<".charCodeAt(0),u=">",d=">".charCodeAt(0),m="-".charCodeAt(0),h="/".charCodeAt(0),v="!".charCodeAt(0),p="'".charCodeAt(0),g='"'.charCodeAt(0),A="\n	>/= ",C=["img","br","input","meta","link"],y=null;if(void 0!==r.attrValue){r.attrName=r.attrName||"id";for(var y=[];-1!==(l=f());)l=t.lastIndexOf("<",l),-1!==l&&y.push(a()),t=t.substr(l),l=0}else y=r.parseNode?a():e();return r.filter&&(y=tXml.filter(y,r.filter)),r.simplify&&(y=tXml.simplify(y)),y.pos=l,y}var app_verssion,$result=$(this),divId=$result.attr("id"),isDone=!1,MsgQueue=new Array,defaultTextStyle=null,chartID=0,_order=1,rtl_langs_array=["he-IL","ar-AE","ar-SA","dv-MV","fa-IR","ur-PK"],slideFactor=96/914400,fontSizeFactor=1.25,slideWidth=0,slideHeight=0,isSlideMode=!1,processFullTheme=!0,styleTable={},settings=$.extend(!0,{pptxFileUrl:"",fileInputId:"",slidesScale:"",slideMode:!1,slideType:"divs2slidesjs",revealjsPath:"",keyBoardShortCut:!1,mediaProcess:!0,jsZipV2:!1,themeProcess:!0,incSlide:{width:0,height:0},slideModeConfig:{first:1,nav:!0,navTxtColor:"black",keyBoardShortCut:!0,showSlideNum:!0,showTotalSlideNum:!0,autoSlide:!0,randomAutoSlide:!1,loop:!1,background:!1,transition:"default",transitionTime:1},revealjsConfig:{}},options);if(processFullTheme=settings.themeProcess,$("#"+divId).prepend($("<div></div>").attr({"class":"slides-loadnig-msg",style:"display:block; width:100%; color:white; background-color: #ddd;"}).html($("<div></div>").attr({"class":"slides-loading-progress-bar",style:"width: 1%; background-color: #4775d1;"}).html("<span style='text-align: center;'>Loading... (1%)</span>"))),settings.slideMode&&(jQuery().divs2slides||jQuery.getScript("./js/divs2slides.js")),settings.jsZipV2!==!1&&(jQuery.getScript(settings.jsZipV2),"yes"!==localStorage.getItem("isPPTXjsReLoaded")&&(localStorage.setItem("isPPTXjsReLoaded","yes"),location.reload())),settings.keyBoardShortCut&&$(document).bind("keydown",function(event){event.preventDefault();var key=event.keyCode;console.log(key,isDone),116!=key||isSlideMode||(isSlideMode=!0,initSlideMode(divId,settings))}),FileReaderJS.setSync(!1),""!=settings.pptxFileUrl)try{JSZipUtils.getBinaryContent(settings.pptxFileUrl,function(err,content){var blob=new Blob([content]),file_name=settings.pptxFileUrl,fArry=file_name.split(".");fArry.pop(),blob.name=fArry[0],FileReaderJS.setupBlob(blob,{readAsDefault:"ArrayBuffer",on:{load:function(e,file){convertToHtml(e.target.result)}}})})}catch(e){console.error("file url error ("+settings.pptxFileUrl+"0)"),$(".slides-loadnig-msg").remove()}else $(".slides-loadnig-msg").remove();""!=settings.fileInputId&&$("#"+settings.fileInputId).on("change",function(evt){$result.html("");var file=evt.target.files[0],fileType=file.type;"application/vnd.openxmlformats-officedocument.presentationml.presentation"==fileType?FileReaderJS.setupBlob(file,{readAsDefault:"ArrayBuffer",on:{load:function(e,file){convertToHtml(e.target.result)}}}):alert("This is not pptx file")});var is_first_br=!1,hebrew2Minus=archaicNumbers([[1e3,""],[400,"ת"],[300,"ש"],[200,"ר"],[100,"ק"],[90,"צ"],[80,"פ"],[70,"ע"],[60,"ס"],[50,"נ"],[40,"מ"],[30,"ל"],[20,"כ"],[10,"י"],[9,"ט"],[8,"ח"],[7,"ז"],[6,"ו"],[5,"ה"],[4,"ד"],[3,"ג"],[2,"ב"],[1,"א"],[/יה/,"ט״ו"],[/יו/,"ט״ז"],[/([א-ת])([א-ת])$/,"$1״$2"],[/^([א-ת])$/,"$1׳"]]),_order=1;tXml.simplify=function(t){var r={};if(void 0===t)return{};if(1===t.length&&"string"==typeof t[0])return t[0];t.forEach(function(t){if("object"==typeof t){r[t.tagName]||(r[t.tagName]=[]);var e=tXml.simplify(t.children||[]);r[t.tagName].push(e),t.attributes&&(e.attrs=t.attributes),void 0===e.attrs?e.attrs={order:_order}:e.attrs.order=_order,_order++}});for(var e in r)1==r[e].length&&(r[e]=r[e][0]);return r},tXml.filter=function(t,r){var e=[];return t.forEach(function(t){if("object"==typeof t&&r(t)&&e.push(t),t.children){var n=tXml.filter(t.children,r);e=e.concat(n)}}),e},tXml.stringify=function(t){function r(t){if(t)for(var r=0;r<t.length;r++)"string"==typeof t[r]?n+=t[r].trim():e(t[r])}function e(t){n+="<"+t.tagName;for(var e in t.attributes)n+=null===t.attributes[e]?" "+e:-1===t.attributes[e].indexOf('"')?" "+e+'="'+t.attributes[e].trim()+'"':" "+e+"='"+t.attributes[e].trim()+"'";n+=">",r(t.children),n+="</"+t.tagName+">"}var n="";return r(t),n},tXml.toContentString=function(t){if(Array.isArray(t)){var r="";return t.forEach(function(t){r+=" "+tXml.toContentString(t),r=r.trim()}),r}return"object"==typeof t?tXml.toContentString(t.children):" "+t},tXml.getElementById=function(t,r,e){var n=tXml(t,{attrValue:r,simplify:e});return e?n:n[0]},tXml.getElementsByClassName=function(t,r,e){return tXml(t,{attrName:"class",attrValue:"[a-zA-Z0-9-s ]*"+r+"[a-zA-Z0-9-s ]*",simplify:e})},tXml.parseStream=function(t,r){if("function"==typeof r&&(cb=r,r=0),"string"==typeof r&&(r=r.length+2),"string"==typeof t){var e=require("fs");t=e.createReadStream(t,{start:r}),r=0}var n=r,i="",a=0;return t.on("data",function(r){a++,i+=r;for(var e=0;;){n=i.indexOf("<",n)+1;var o=tXml(i,{pos:n,parseNode:!0});if(n=o.pos,n>i.length-1||e>n)return void(e&&(i=i.slice(e),n=0,e=0));t.emit("xml",o),e=n}i=i.slice(n),n=0}),t.on("end",function(){console.log("end")}),t},"object"==typeof module&&(module.exports=tXml)},!function(a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(a):"undefined"!=typeof window?window.JSZipUtils=a():"undefined"!=typeof global?global.JSZipUtils=a():"undefined"!=typeof self&&(self.JSZipUtils=a())}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";function c(){try{return new window.XMLHttpRequest}catch(a){}}function d(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}var e={};e._getBinaryFromXHR=function(a){return a.response||a.responseText};var f=window.ActiveXObject?function(){return c()||d()}:c;e.getBinaryContent=function(a,b){try{var c=f();c.open("GET",a,!0),"responseType"in c&&(c.responseType="arraybuffer"),c.overrideMimeType&&c.overrideMimeType("text/plain; charset=x-user-defined"),c.onreadystatechange=function(){var d,f;if(4===c.readyState)if(200===c.status||0===c.status){d=null,f=null;try{d=e._getBinaryFromXHR(c)}catch(g){f=new Error(g)}b(f,d)}else b(new Error("Ajax error for "+a+" : "+this.status+" "+this.statusText),null)},c.send()}catch(d){b(new Error(d),null)}},b.exports=e},{}]},{},[1])(1)}),!function(a){function b(a,d){if(a=a?a:"",d=d||{},a instanceof b)return a;if(!(this instanceof b))return new b(a,d);var e=c(a);this._originalInput=a,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=P(100*this._a)/100,this._format=d.format||e.format,this._gradientType=d.gradientType,this._r<1&&(this._r=P(this._r)),this._g<1&&(this._g=P(this._g)),this._b<1&&(this._b=P(this._b)),this._ok=e.ok,this._tc_id=O++}function c(a){var b={r:0,g:0,b:0},c=1,e=null,g=null,i=null,j=!1,k=!1;return"string"==typeof a&&(a=K(a)),"object"==typeof a&&(J(a.r)&&J(a.g)&&J(a.b)?(b=d(a.r,a.g,a.b),j=!0,k="%"===String(a.r).substr(-1)?"prgb":"rgb"):J(a.h)&&J(a.s)&&J(a.v)?(e=G(a.s),g=G(a.v),b=h(a.h,e,g),j=!0,k="hsv"):J(a.h)&&J(a.s)&&J(a.l)&&(e=G(a.s),i=G(a.l),b=f(a.h,e,i),j=!0,k="hsl"),a.hasOwnProperty("a")&&(c=a.a)),c=z(c),{ok:j,format:a.format||k,r:Q(255,R(b.r,0)),g:Q(255,R(b.g,0)),b:Q(255,R(b.b,0)),a:c}}function d(a,b,c){return{r:255*A(a,255),g:255*A(b,255),b:255*A(c,255)}}function e(a,b,c){a=A(a,255),b=A(b,255),c=A(c,255);var d,e,f=R(a,b,c),g=Q(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function f(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=A(a,360),b=A(b,100),c=A(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function g(a,b,c){a=A(a,255),b=A(b,255),c=A(c,255);var d,e,f=R(a,b,c),g=Q(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function h(b,c,d){b=6*A(b,360),c=A(c,100),d=A(d,100);var e=a.floor(b),f=b-e,g=d*(1-c),h=d*(1-f*c),i=d*(1-(1-f)*c),j=e%6,k=[d,h,g,g,i,d][j],l=[i,d,d,h,g,g][j],m=[g,g,i,d,d,h][j];return{r:255*k,g:255*l,b:255*m}}function i(a,b,c,d){var e=[F(P(a).toString(16)),F(P(b).toString(16)),F(P(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function j(a,b,c,d,e){var f=[F(P(a).toString(16)),F(P(b).toString(16)),F(P(c).toString(16)),F(H(d))];return e&&f[0].charAt(0)==f[0].charAt(1)&&f[1].charAt(0)==f[1].charAt(1)&&f[2].charAt(0)==f[2].charAt(1)&&f[3].charAt(0)==f[3].charAt(1)?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0)+f[3].charAt(0):f.join("")}function k(a,b,c,d){var e=[F(H(d)),F(P(a).toString(16)),F(P(b).toString(16)),F(P(c).toString(16))];return e.join("")}function l(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.s-=c/100,d.s=B(d.s),b(d)}function m(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.s+=c/100,d.s=B(d.s),b(d)}function n(a){return b(a).desaturate(100)}function o(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.l+=c/100,d.l=B(d.l),b(d)}function p(a,c){c=0===c?0:c||10;var d=b(a).toRgb();return d.r=R(0,Q(255,d.r-P(255*-(c/100)))),d.g=R(0,Q(255,d.g-P(255*-(c/100)))),d.b=R(0,Q(255,d.b-P(255*-(c/100)))),b(d)}function q(a,c){c=0===c?0:c||10;var d=b(a).toHsl();return d.l-=c/100,d.l=B(d.l),b(d)}function r(a,c){var d=b(a).toHsl(),e=(d.h+c)%360;return d.h=0>e?360+e:e,b(d)}function s(a){var c=b(a).toHsl();return c.h=(c.h+180)%360,b(c)}function t(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+120)%360,s:c.s,l:c.l}),b({h:(d+240)%360,s:c.s,l:c.l})]}function u(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+90)%360,s:c.s,l:c.l}),b({h:(d+180)%360,s:c.s,l:c.l}),b({h:(d+270)%360,s:c.s,l:c.l})]}function v(a){var c=b(a).toHsl(),d=c.h;return[b(a),b({h:(d+72)%360,s:c.s,l:c.l}),b({h:(d+216)%360,s:c.s,l:c.l})]}function w(a,c,d){c=c||6,d=d||30;var e=b(a).toHsl(),f=360/d,g=[b(a)];for(e.h=(e.h-(f*c>>1)+720)%360;--c;)e.h=(e.h+f)%360,g.push(b(e));return g}function x(a,c){c=c||6;for(var d=b(a).toHsv(),e=d.h,f=d.s,g=d.v,h=[],i=1/c;c--;)h.push(b({h:e,s:f,v:g})),g=(g+i)%1;return h}function y(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function z(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function A(b,c){D(b)&&(b="100%");var d=E(b);return b=Q(c,R(0,parseFloat(b))),d&&(b=parseInt(b*c,10)/100),a.abs(b-c)<1e-6?1:b%c/parseFloat(c)}function B(a){return Q(1,R(0,a))}function C(a){return parseInt(a,16)}function D(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function E(a){return"string"==typeof a&&-1!=a.indexOf("%")}function F(a){return 1==a.length?"0"+a:""+a}function G(a){return 1>=a&&(a=100*a+"%"),a}function H(b){return a.round(255*parseFloat(b)).toString(16)}function I(a){return C(a)/255}function J(a){return!!V.CSS_UNIT.exec(a)}function K(a){a=a.replace(M,"").replace(N,"").toLowerCase();var b=!1;if(T[a])a=T[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=V.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=V.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=V.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=V.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=V.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=V.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=V.hex8.exec(a))?{r:C(c[1]),g:C(c[2]),b:C(c[3]),a:I(c[4]),format:b?"name":"hex8"}:(c=V.hex6.exec(a))?{r:C(c[1]),g:C(c[2]),b:C(c[3]),format:b?"name":"hex"}:(c=V.hex4.exec(a))?{r:C(c[1]+""+c[1]),g:C(c[2]+""+c[2]),b:C(c[3]+""+c[3]),a:I(c[4]+""+c[4]),format:b?"name":"hex8"}:(c=V.hex3.exec(a))?{r:C(c[1]+""+c[1]),g:C(c[2]+""+c[2]),b:C(c[3]+""+c[3]),format:b?"name":"hex"}:!1}function L(a){var b,c;return a=a||{level:"AA",size:"small"},b=(a.level||"AA").toUpperCase(),c=(a.size||"small").toLowerCase(),"AA"!==b&&"AAA"!==b&&(b="AA"),"small"!==c&&"large"!==c&&(c="small"),{level:b,size:c}}var M=/^\s+/,N=/\s+$/,O=0,P=a.round,Q=a.min,R=a.max,S=a.random;b.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},getLuminance:function(){var b,c,d,e,f,g,h=this.toRgb();return b=h.r/255,c=h.g/255,d=h.b/255,e=.03928>=b?b/12.92:a.pow((b+.055)/1.055,2.4),f=.03928>=c?c/12.92:a.pow((c+.055)/1.055,2.4),g=.03928>=d?d/12.92:a.pow((d+.055)/1.055,2.4),.2126*e+.7152*f+.0722*g},setAlpha:function(a){return this._a=z(a),this._roundA=P(100*this._a)/100,this},toHsv:function(){var a=g(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=g(this._r,this._g,this._b),b=P(360*a.h),c=P(100*a.s),d=P(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=e(this._r,this._g,this._b),b=P(360*a.h),c=P(100*a.s),d=P(100*a.l);return 1==this._a?"hsl("+b+", "+c+"%, "+d+"%)":"hsla("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHex:function(a){return i(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(a){return j(this._r,this._g,this._b,this._a,a)},toHex8String:function(a){return"#"+this.toHex8(a)},toRgb:function(){return{r:P(this._r),g:P(this._g),b:P(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+P(this._r)+", "+P(this._g)+", "+P(this._b)+")":"rgba("+P(this._r)+", "+P(this._g)+", "+P(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:P(100*A(this._r,255))+"%",g:P(100*A(this._g,255))+"%",b:P(100*A(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+P(100*A(this._r,255))+"%, "+P(100*A(this._g,255))+"%, "+P(100*A(this._b,255))+"%)":"rgba("+P(100*A(this._r,255))+"%, "+P(100*A(this._g,255))+"%, "+P(100*A(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:U[i(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var c="#"+k(this._r,this._g,this._b,this._a),d=c,e=this._gradientType?"GradientType = 1, ":"";
if(a){var f=b(a);d="#"+k(f._r,f._g,f._b,f._a)}return"progid:DXImageTransform.Microsoft.gradient("+e+"startColorstr="+c+",endColorstr="+d+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"hex4"===a||"hex8"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),("hex"===a||"hex6"===a)&&(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex4"===a&&(c=this.toHex8String(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())},clone:function(){return b(this.toString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(o,arguments)},brighten:function(){return this._applyModification(p,arguments)},darken:function(){return this._applyModification(q,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(m,arguments)},greyscale:function(){return this._applyModification(n,arguments)},spin:function(){return this._applyModification(r,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(w,arguments)},complement:function(){return this._applyCombination(s,arguments)},monochromatic:function(){return this._applyCombination(x,arguments)},splitcomplement:function(){return this._applyCombination(v,arguments)},triad:function(){return this._applyCombination(t,arguments)},tetrad:function(){return this._applyCombination(u,arguments)}},b.fromRatio=function(a,c){if("object"==typeof a){var d={};for(var e in a)a.hasOwnProperty(e)&&("a"===e?d[e]=a[e]:d[e]=G(a[e]));a=d}return b(a,c)},b.equals=function(a,c){return a&&c?b(a).toRgbString()==b(c).toRgbString():!1},b.random=function(){return b.fromRatio({r:S(),g:S(),b:S()})},b.mix=function(a,c,d){d=0===d?0:d||50;var e=b(a).toRgb(),f=b(c).toRgb(),g=d/100,h={r:(f.r-e.r)*g+e.r,g:(f.g-e.g)*g+e.g,b:(f.b-e.b)*g+e.b,a:(f.a-e.a)*g+e.a};return b(h)},b.readability=function(c,d){var e=b(c),f=b(d);return(a.max(e.getLuminance(),f.getLuminance())+.05)/(a.min(e.getLuminance(),f.getLuminance())+.05)},b.isReadable=function(a,c,d){var e,f,g=b.readability(a,c);switch(f=!1,e=L(d),e.level+e.size){case"AAsmall":case"AAAlarge":f=g>=4.5;break;case"AAlarge":f=g>=3;break;case"AAAsmall":f=g>=7}return f},b.mostReadable=function(a,c,d){var e,f,g,h,i=null,j=0;d=d||{},f=d.includeFallbackColors,g=d.level,h=d.size;for(var k=0;k<c.length;k++)e=b.readability(a,c[k]),e>j&&(j=e,i=b(c[k]));return b.isReadable(a,i,{level:g,size:h})||!f?i:(d.includeFallbackColors=!1,b.mostReadable(a,["#fff","#000"],d))};var T=b.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},U=b.hexNames=y(T),V=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{CSS_UNIT:new RegExp(c),rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+e),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):window.tinycolor=b}(Math)}(jQuery);
