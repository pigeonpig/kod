(window["webpackJsonpantd-demo-ts"]=window["webpackJsonpantd-demo-ts"]||[]).push([[0],{188:function(e,t,a){e.exports=a(402)},193:function(e,t,a){},209:function(e,t,a){},402:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(8),l=a.n(r),i=(a(193),a(194),a(184)),c=(a(196),a(186)),s=(a(130),a(23)),d=(a(201),a(107)),u=(a(77),a(14)),m=(a(203),a(7)),h=(a(132),a(47)),f=(a(133),a(105)),v=a(26),g=a(24),p=a(34),y=a(33),E=a(35),b=(a(207),a(60)),C=(a(209),a(134),a(51)),k=a(38),O=a.n(k),I=a(57),P=a(177),S=a.n(P),w=function(){function e(){var t=this;Object(v.a)(this,e),this.customTagTreeData=void 0,this.searchSession=void 0,this.localFileInput=void 0,this.file=void 0,this.openLocalFile=function(){var e=t.localFileInput;e||((e=t.localFileInput=document.createElement("input")).type="file",e.onchange=function(){var a=e.files[0];a&&(e.value="",t.file=a,t.doOpenLocalFile(a))}),e.click()},this.print=function(){t.getOfdCore().print()},window.OFDReader=this}return Object(g.a)(e,[{key:"getFilePath",value:function(){return this.file.path}}]),Object(g.a)(e,[{key:"openRemoteFile",value:function(){var t=Object(I.a)(O.a.mark(function t(a){var n,o,r,l;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=a,t.prev=1,-1!==(r=a.lastIndexOf("&param="))&&(o=a.substring(r+7),a=a.substring(0,r)),t.next=6,S.a.get(a,{responseType:"arraybuffer"});case 6:l=t.sent,e.instance.open(l.data,n,o),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),t.t0.response&&404===t.t0.response.status?f.a.info("\u627e\u4e0d\u5230\u6587\u4ef6"):console.log("open file error",t.t0);case 13:case"end":return t.stop()}},t,null,[[1,10]])}));return function(e){return t.apply(this,arguments)}}()},{key:"doOpenLocalFile",value:function(t){var a=this;if(t){var n=new FileReader;n.onload=function(){e.instance.reset(),a.getOfdCore().openLocal(n.result,t.name,null)},n.readAsArrayBuffer(t)}}},{key:"getCustomTags",value:function(){var e=Object(I.a)(O.a.mark(function e(t){var a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.customTagTreeData){e.next=2;break}return e.abrupt("return",this.customTagTreeData);case 2:return a=this.getOfdCore(),e.next=5,a.getCustomTags(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"reset",value:function(){}},{key:"scrollIntoView",value:function(e,t,a){this.getOfdCore().scrollIntoView(e,t,a)}},{key:"open",value:function(e,t,a){this.reset(),this.getOfdCore().openLocal(e,t,a)}},{key:"getOfdCore",value:function(){return window.OfdCore}},{key:"highlightcustomTagObjects",value:function(e){this.getOfdCore().highlightcustomTagObjects(e)}},{key:"search",value:function(e){e&&""!==e?this.getOfdCore().getCurrentDoc().docRoot&&this.getOfdCore().search(e):window.dispatchEvent(new CustomEvent("ShowMessage",{detail:{message:"\u641c\u7d22\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a."}}))}},{key:"beginSearch",value:function(e){e&&""!==e?this.getOfdCore().getCurrentDoc().docRoot&&(this.showSearchNextPrevButtons(!0),this.searchSession||(this.searchSession=this.getOfdCore().beginSearch(e)),this.getOfdCore().beginSearch(e)):window.dispatchEvent(new CustomEvent("ShowMessage",{detail:{message:"\u641c\u7d22\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a."}}))}},{key:"showSearchNextPrevButtons",value:function(e){var t=e?"inline-block":"none";document.getElementById("SearchNext").style.display=t,document.getElementById("SearchPrev").style.display=t}},{key:"searchNext",value:function(){if(this.getOfdCore().getCurrentDoc().docRoot){var e=document.getElementById("search");e.value&&""!==e.value&&(this.searchSession||(this.searchSession=this.getOfdCore().beginSearch(e.value)),this.searchSession.inited||this.beginSearch(e.value),this.searchSession.search(0))}}},{key:"searchPrev",value:function(){this.searchSession.search(1)}},{key:"goFirstPage",value:function(){this.getOfdCore().goFirstPage()}},{key:"goNextPage",value:function(){this.getOfdCore().goNextPage()}},{key:"goPrevPage",value:function(){this.getOfdCore().goPrevPage()}},{key:"goLastPage",value:function(){this.getOfdCore().goLastPage()}},{key:"gotoPage",value:function(e){this.getOfdCore().gotoPage(e)}},{key:"setZoom",value:function(e){this.getOfdCore().setZoom(e)}},{key:"fullScreen",value:function(){this.getOfdCore().fullScreen()}},{key:"rotate",value:function(e){this.getOfdCore().rotate(e)}},{key:"changePageState",value:function(e){this.getOfdCore().changePageState(e)}},{key:"changedrawType",value:function(e){this.getOfdCore().changedrawType(e)}},{key:"setEditFontFamily",value:function(e){var t;switch(e){case 1:t="SimSun";break;case 2:t="SimHei";break;case 3:t="KaiTi";break;case 4:t="Microsoft YaHei"}this.getOfdCore().setEditFontFamily(t)}},{key:"setEditFontSize",value:function(e){this.getOfdCore().setEditFontSize(e)}}]),e}();w.instance=new w;var N=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(p.a)(this,Object(y.a)(t).call(this,e))).docBody=void 0,a.onSelect=function(e,t){if(t.node.props.dataRef.actions[0]){var n=t.node.props.dataRef.actions[0]._goto.dest,o=n.top,r=a.docBody.doc.pageIds[n.pageID];if(w.instance.getOfdCore().gotoPage(r.index),o)document.getElementById("RightSidePanelContent").scrollTop=o}},a.renderTreeNodes=function(e){return e.map(function(e){return e.children?o.a.createElement(C.a.TreeNode,{title:e.title,key:e.key,dataRef:e},a.renderTreeNodes(e.children)):o.a.createElement(C.a.TreeNode,Object.assign({},e,{dataRef:e}))})},a.state={treeData:[]},a}return Object(E.a)(t,e),Object(g.a)(t,[{key:"setupTreeData",value:function(e){this.docBody=e;var t=w.instance.getOfdCore().getOutline(e.docRoot),a=[];a=t&&t.length>0?t[0].children:[],this.setState({treeData:a})}},{key:"render",value:function(){return o.a.createElement(C.a,{onSelect:this.onSelect},this.renderTreeNodes(this.state.treeData))}}]),t}(o.a.Component),D=(a(176),a(103)),B=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(p.a)(this,Object(y.a)(t).call(this,e))).docbodys=void 0,a.state={tableData:[]},a}return Object(E.a)(t,e),Object(g.a)(t,[{key:"setupDocsData",value:function(){var e=this.docbodys;if(e||(e=this.docbodys=w.instance.getOfdCore().getDocBodys()),e){this.docbodys=e;for(var t=[],a=0;a<e.length;a++){var n=e[a].docRoot,o={key:a,name:n=n.substring(0,n.indexOf("/")),state:0===e[a].state?"\u6253\u5f00":"\u5173\u95ed"};t.push(o)}this.setState({tableData:t})}}},{key:"render",value:function(){var e=this;return o.a.createElement(D.a,{className:"SideTable",pagination:!1,columns:[{title:"\u540d\u79f0",dataIndex:"name"},{title:"\u72b6\u6001",dataIndex:"state"}],dataSource:this.state.tableData,onRow:function(t){return{onClick:function(){if(w.instance.getOfdCore().getCurrentDoc()!==e.docbodys[t.key]){w.instance.getOfdCore().switchDoc(e.docbodys[t.key]);for(var a,n=[],o=0;o<e.docbodys.length;o++){var r={key:o,name:a=(a=e.docbodys[o].docRoot).substring(0,a.indexOf("/")),state:o===t.key?"\u6253\u5f00":"\u5173\u95ed"};n.push(r)}e.setState({tableData:n})}}}}})}}]),t}(o.a.Component),z=a(183),x=a.n(z),F=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(p.a)(this,Object(y.a)(t).call(this,e))).body=void 0,a.onSelect=function(e,t){var a=t.node.props.objectRef;a&&0!==a.length&&w.instance.highlightcustomTagObjects(a)},a.renderTreeNodes=function(e){return e.map(function(e){return e.children?o.a.createElement(C.a.TreeNode,{title:e.title,key:e.key,dataRef:e},a.renderTreeNodes(e.children)):o.a.createElement(C.a.TreeNode,Object.assign({},e,{dataRef:e}))})},a.state={treeData:[]},a}return Object(E.a)(t,e),Object(g.a)(t,[{key:"setupTreeData",value:function(){var e=Object(I.a)(O.a.mark(function e(t){var a,n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.body=t,e.next=3,w.instance.getCustomTags(t.docRoot);case 3:a=e.sent,n=a&&a.length>0?a[0].root.children:[],this.setState({treeData:n});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement(C.a,{onSelect:this.onSelect},this.renderTreeNodes(this.state.treeData))}}]),t}(o.a.Component),j=(a(374),a(185)),R=(a(376),a(76)),T=(a(378),a(187)),V=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(p.a)(this,Object(y.a)(t).call(this,e))).key=0,a.showModal=function(e){a.setState({visible:!0,data:e})},a.handleCancel=function(e){a.setState({visible:!1})},a.getDocInfoData=function(){if(a.state.data){var e=a.state.data;return o.a.createElement("div",{className:"DocInfoTabContentDiv"},o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6587\u6863ID \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.docID)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6587\u6863\u6807\u9898 \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.title)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6587\u6863\u4e3b\u4f53 \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.subject)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6458\u8981\u4e0e\u6ce8\u91ca \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e._abstract)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u521b\u5efa\u65e5\u671f \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.creationDate)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6700\u8fd1\u4fee\u6539\u65e5\u671f \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.modDate)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6587\u6863\u5206\u7c7b \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.docUsage)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6587\u6863\u5c01\u9762 \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.cover)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u5173\u952e\u8bcd \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.keywords)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u6587\u6863\u521b\u5efa\u7a0b\u5e8f \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.creator)),o.a.createElement("div",null,o.a.createElement("div",{className:"InfoItemName"},"\u521b\u5efa\u7a0b\u5e8f\u7248\u672c \uff1a"),o.a.createElement("div",{className:"InfoItemValue"},e.creatorVersion)))}},a.getCustomData=function(){if(a.state.data){var e=a.state.data.customDatas;return e?o.a.createElement("div",null,a.setCustomdata(e)):o.a.createElement("div",null)}},a.setCustomdata=function(e){return e.map(function(e){return o.a.createElement("div",{key:a.key++},o.a.createElement(T.a,null,e.name,":",e.value),o.a.createElement("br",null))})},a.getPermissionData=function(){if(a.state.data)return o.a.createElement("div",null)},a.state={visible:!1,data:null},a}return Object(E.a)(t,e),Object(g.a)(t,[{key:"setDocBody",value:function(e){if(e){var t=w.instance.getOfdCore().getDocInfoData(e.docRoot);t&&this.showModal(t)}}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(j.a,{width:"600",className:"DocInfoDialog",visible:this.state.visible,onCancel:this.handleCancel,footer:null},o.a.createElement(R.a,{defaultActiveKey:"1"},o.a.createElement(R.a.TabPane,{tab:"\u63cf\u8ff0",key:"1"},this.getDocInfoData()),o.a.createElement(R.a.TabPane,{tab:"\u5143\u6570\u636e",key:"2"},o.a.createElement("div",null,this.getCustomData())),o.a.createElement(R.a.TabPane,{tab:"\u5b89\u5168",key:"3"},this.getPermissionData()))))}}]),t}(o.a.Component),M=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(p.a)(this,Object(y.a)(t).call(this,e))).state={tableData:[]},a}return Object(E.a)(t,e),Object(g.a)(t,[{key:"setDocBody",value:function(e){this.setupDocsData(e)}},{key:"setupDocsData",value:function(){var e=Object(I.a)(O.a.mark(function e(t){var a,n,o,r,l,i,c,s,d;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.instance.getOfdCore().getAttachments(t.docRoot);case 2:for(a=e.sent,n=[],o=!0,r=!1,l=void 0,e.prev=7,i=a[Symbol.iterator]();!(o=(c=i.next()).done);o=!0)s=c.value,d={name:s.name,size:s.size+"KB",useage:s.usage},n.push(d);e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),r=!0,l=e.t0;case 15:e.prev=15,e.prev=16,o||null==i.return||i.return();case 18:if(e.prev=18,!r){e.next=21;break}throw l;case 21:return e.finish(18);case 22:return e.finish(15);case 23:this.setState({tableData:n});case 24:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement(D.a,{className:"SideTable",pagination:!1,columns:[{title:"\u540d\u79f0",dataIndex:"name"},{title:"\u5927\u5c0f",dataIndex:"size"},{title:"\u7528\u9014",dataIndex:"useage"}],dataSource:this.state.tableData})}}]),t}(o.a.Component),A=function(e){return o.a.createElement("svg",Object.assign({className:"DocManager_svg__icon",viewBox:"0 0 1024 1024",width:16,height:16},e),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M541.867 678.4H290.133c-12.8 0-21.333 8.533-21.333 21.333 0 12.8 8.533 21.334 21.333 21.334h251.734c12.8 0 21.333-8.534 21.333-21.334 0-12.8-8.533-21.333-21.333-21.333zM460.8 802.133H290.133c-12.8 0-21.333 8.534-21.333 21.334 0 12.8 8.533 21.333 21.333 21.333h166.4c12.8 0 21.334-8.533 21.334-21.333 0-8.534-8.534-21.334-17.067-21.334zm-170.667-332.8h85.334c12.8 0 21.333-8.533 21.333-21.333 0-12.8-8.533-21.333-21.333-21.333h-85.334c-12.8 0-21.333 8.533-21.333 21.333 4.267 12.8 12.8 21.333 21.333 21.333zm460.8-413.866H439.467c-46.934 0-85.334 38.4-85.334 85.333v64c0 12.8 8.534 21.333 21.334 21.333S396.8 217.6 396.8 204.8v-68.267c0-21.333 17.067-42.666 42.667-42.666H691.2V217.6c0 21.333 17.067 42.667 42.667 42.667h119.466V678.4c0 21.333-17.066 42.667-42.666 42.667h-64c-12.8 0-21.334 8.533-21.334 21.333 0 12.8 8.534 21.333 21.334 21.333h64c46.933 0 85.333-38.4 85.333-85.333V221.867l-145.067-166.4zm-21.333 166.4V98.133l106.667 123.734H729.6zm-499.2 38.4c-46.933 0-85.333 38.4-85.333 85.333v541.867c0 46.933 38.4 85.333 85.333 85.333h375.467c46.933 0 85.333-38.4 85.333-85.333v-460.8l-145.067-166.4H230.4zm413.867 627.2c0 21.333-17.067 42.666-42.667 42.666H230.4c-21.333 0-42.667-17.066-42.667-42.666V345.6c0-21.333 17.067-42.667 42.667-42.667h251.733v123.734c0 21.333 17.067 42.666 42.667 42.666h123.733v418.134zm-123.734-460.8V307.2L627.2 430.933H520.533zM273.067 576c0 12.8 8.533 21.333 21.333 21.333h251.733c12.8 0 21.334-8.533 21.334-21.333 0-12.8-8.534-21.333-21.334-21.333h-256c-8.533 0-17.066 8.533-17.066 21.333z",fill:"#515151"}))},H=function(e){return o.a.createElement("svg",Object.assign({className:"outline_svg__icon",viewBox:"0 0 1024 1024",width:200,height:200},e),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M809.984 553.984v-84.01H896v84.01h-86.016zm0-256H896V384h-86.016v-86.016zm0 428.032V640H896v86.016h-86.016zm-681.984 0V640h598.016v86.016H128zm0-172.032v-84.01h598.016v84.01H128zM128 384v-86.016h598.016V384H128z"}))},L=function(e){return o.a.createElement("svg",Object.assign({className:"attachment_svg__icon",viewBox:"0 0 1024 1024",width:16,height:16},e),o.a.createElement("defs",null,o.a.createElement("style",null)),o.a.createElement("path",{d:"M503.63 1005.714a53.76 53.76 0 0 1-37.852-91.428l381.805-382.537A237.714 237.714 0 0 0 511.31 195.474L154.738 552.046a161.097 161.097 0 0 0 228.023 227.84l334.811-334.812a81.554 81.554 0 0\r\n0-115.2-115.931L333.389 598.674a53.577 53.577 0 0 1-75.886-75.885l268.983-268.983A188.891 188.891 0 0 1 793.458 520.96L458.646 855.771A268.434 268.434 0 0 1 78.852 475.43l356.571-356.572A345.051 345.051 0 0 1 923.47 607.634L541.663 989.623a54.857 54.857 0 0 1-38.034 16.091z"}))},Z=b.a.Header,_=b.a.Sider,W=b.a.Content,K=b.a.Footer,G=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(p.a)(this,Object(y.a)(t).call(this,e))).collapsed=!0,a.sidePanel=void 0,a.sidePanelContent=void 0,a.currentSidePanelKey=void 0,a.outline=void 0,a.docsManager=void 0,a.customtag=void 0,a.attachment=void 0,a.currentZoom=1,a.docsManagerPanel=void 0,a.outlinePanel=void 0,a.customtagPanel=void 0,a.attachmentPanel=void 0,a.docBody=void 0,a.pageNumberInput=o.a.createRef(),a.docInfoRef=o.a.createRef(),a.onCollapse=function(e){console.log(e),a.setState({collapsed:e})},a.onDocManagerIconClick=function(){a._onSideIconClick("sidepanel-DocsManagerPanel")},a.onOutlineIconClick=function(){a._onSideIconClick("sidepanel-OutlinePanel")},a.onCustomtagIconClick=function(){a._onSideIconClick("sidepanel-CustomtagPanel")},a.onAttachmentIconClick=function(){a._onSideIconClick("sidepanel-AttachmentPanel")},a._switchSidePanel=function(e){var t=a.sidePanelContent;if(t||(t=a.sidePanelContent=document.getElementById("SidePanelContent")),l.a.unmountComponentAtNode(t),a.docBody)switch(e){case"sidepanel-DocsManagerPanel":a.getDocsManagerPanel(t).setupDocsData();break;case"sidepanel-OutlinePanel":a.getOutlinePanel(t).setupTreeData(a.docBody);break;case"sidepanel-CustomtagPanel":a.getCustomtagPanel(t).setupTreeData(a.docBody);break;case"sidepanel-AttachmentPanel":a.getAttachmentPanel(t).setDocBody(a.docBody)}},a.onZoomChange=function(e){w.instance.setZoom(parseFloat(e));var t=a.currentZoom=parseFloat(e);a.setState({zoomValue:t+""})},a.onfontchange=function(e){w.instance.setEditFontFamily(parseInt(e));var t=parseFloat(e);a.setState({editFontFamily:t+""})},a.onfontsizechange=function(e){w.instance.setEditFontSize(parseInt(e));var t=parseFloat(e);a.setState({editFontSize:t+""})},a.pageSetup=function(e){w.instance.changePageState(parseInt(e))},a.onGotoPage=function(e){var t=parseInt(e.target.value);w.instance.gotoPage(t-1)},a.onDocInfoButtonClick=function(){a.docInfoRef.current&&a.docInfoRef.current.setDocBody(a.docBody)},a.zoomIn=function(){if(a.docBody){a.currentZoom+=.1,a.currentZoom<.5&&(a.currentZoom=.5),a.currentZoom>1.5&&(a.currentZoom=1.5);var e=parseFloat(a.currentZoom.toFixed(2));w.instance.setZoom(e),a.setState({zoomValue:e+""})}},a.zoomOut=function(){if(a.docBody){a.currentZoom-=.1,a.currentZoom<.5&&(a.currentZoom=.5),a.currentZoom>1.5&&(a.currentZoom=1.5);var e=parseFloat(a.currentZoom.toFixed(2));w.instance.setZoom(e),a.setState({zoomValue:e+""})}},a.handleOptionChange=function(e){var t=e.target["data-option"],a=e.target.checked;dispatchEvent(new CustomEvent("OfdReaderOptionChanged",{detail:{name:t,value:a}}))},a.esealClick=function(){},a.getHand=function(){var e=document.getElementById("OfdCanvasWrapper");e&&e.classList.add("getHand")},a.cancelHand=function(){var e=document.getElementById("OfdCanvasWrapper");e&&(e.className=e.className.replace("getHand",""))},a.state={totalpage:null,collapsed:!0,zoomValue:"1",editFontFamily:"1",editFontSize:"12"},a}return Object(E.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("reader mounted."),window.docBody=this.docBody;var t=window.ofdReaderParams;window.addEventListener("OfdFileOpened",function(){var t=e.sidePanel;t||(t=e.sidePanel=document.getElementById("SidePanel")),t.style.display="none",e.collapsed=!0;var a=w.instance.getOfdCore().getCurrentDoc().doc.pages.length;(e.docBody=w.instance.getOfdCore().getCurrentDoc(),e.docBody)&&(e.setState({totalpage:a}),document.getElementById("PageNumberInput").value="1")}),window.addEventListener("StartPageIndexChanged",function(t){e.pageNumberInput.current.setValue(t.detail.value,null)}),window.addEventListener("ShowMessage",function(e){f.a.info(e.detail.message)}),document.body.onkeydown=function(e){if(27===e.keyCode){var t=document.documentElement;t.isfullScreen&&(t.isfullScreen=!1)}};var a=window.location.search;if(a.startsWith("?file=")){var n=a.substring(6);if(n.startsWith("file://")){var o=new XMLHttpRequest;o.onload=function(){w.instance.getOfdCore().openLocal(o.response,n.substring(7),null)},o.open("GET",n),o.responseType="arraybuffer",o.send()}else w.instance.openRemoteFile(n)}else if(a||t)try{if(a=a.substring(1),t||(t=JSON.parse(window.base64Decode(a))),1===t.isCopy&&(document.body.oncopy=function(e){e.returnValue=!1}),1===t.isPrint){var r=document.getElementById("printButton"),l=document.getElementById("more");r.style.display="none",l.style.display="none"}document.body.onkeydown=function(e){(1===t.isPrint&&e.ctrlKey&&80===e.keyCode||e.ctrlKey&&83===e.keyCode)&&(e.returnValue=!1)},t.isDownload,w.instance.openRemoteFile(t.file)}catch(i){}requestAnimationFrame(function(){var e=window.electron;if(e){var t=e.remote.process,a=t.argv;if("win32"===t.platform||"linux"===t.platform){var n=a&&a[1];if(n&&n.length>2){var o=window.nodefs.readFileSync(n);w.instance.open(o,n,null)}}}})}},{key:"addPanelBackGround",value:function(e){var t=this.docsManagerPanel;t||(t=this.docsManagerPanel=document.getElementById("sidepanel-DocsManagerPanel"));var a=this.outlinePanel;a||(a=this.outlinePanel=document.getElementById("sidepanel-OutlinePanel"));var n=this.customtagPanel;n||(n=this.customtagPanel=document.getElementById("sidepanel-CustomtagPanel"));var o=this.attachmentPanel;this.attachmentPanel||(o=this.attachmentPanel=document.getElementById("sidepanel-AttachmentPanel")),t.style.backgroundColor="sidepanel-DocsManagerPanel"===e?"#ebe8e8":"",a.style.backgroundColor="sidepanel-OutlinePanel"===e?"#ebe8e8":"",n.style.backgroundColor="sidepanel-CustomtagPanel"===e?"#ebe8e8":"",o.style.backgroundColor="sidepanel-AttachmentPanel"===e?"#ebe8e8":""}},{key:"_onSideIconClick",value:function(e){var t=this.sidePanel;t||(t=this.sidePanel=document.getElementById("SidePanel"));var a,n=this.currentSidePanelKey;(a=!(!n||n===e)||this.collapsed)?(t.style.display="block",t.style.width="250px",t.style.maxWidth="250px",t.style.flex="0 0 250px",this._switchSidePanel(e),this.addPanelBackGround(e)):(t.style.display="none",this.addPanelBackGround("close")),this.currentSidePanelKey=e,this.collapsed=!a,document.body.style.overflowY="hidden"}},{key:"getOutlinePanel",value:function(e){var t=this.outline;if(!t){var a=o.a.createElement(N);t=l.a.render(a,e)}return t}},{key:"getDocsManagerPanel",value:function(e){var t=this.docsManager;if(!t){var a=o.a.createElement(B);t=l.a.render(a,e)}return t}},{key:"getCustomtagPanel",value:function(e){var t=this.customtag;if(!t){var a=o.a.createElement(F);t=l.a.render(a,e)}return t}},{key:"getAttachmentPanel",value:function(e){var t=this.attachment;if(!t){var a=o.a.createElement(M);t=l.a.render(a,e)}return t}},{key:"getFilePath",value:function(){return w.instance.file.path}},{key:"changeToolbarDisplay",value:function(e){var t=document.getElementById("normalBar"),a=document.getElementById("editBar");0==e?(t.style.display="block",a.style.display="none"):(t.style.display="none",a.style.display="block")}},{key:"render",value:function(){var e=o.a.createElement("div",null,o.a.createElement(h.a,{"data-option":"option-selectPrint",onChange:this.handleOptionChange},"\u9009\u62e9\u6253\u5370"));return o.a.createElement("div",{className:"App"},o.a.createElement(b.a,{style:{minHeight:"100vh"}},o.a.createElement(Z,{className:"header",id:"OFDReader-Header",style:{whiteSpace:"nowrap"}},o.a.createElement("div",{className:"HFlexBox"},o.a.createElement("div",{className:"HFlexBoxLeftContainer"},o.a.createElement(u.a,{size:"small",style:{marginRight:4},onClick:w.instance.openLocalFile},o.a.createElement(m.a,{type:"folder-open"}),"\u6253\u5f00\u6587\u4ef6"),o.a.createElement(u.a,{id:"printButton",size:"small",style:{border:"none"},onClick:w.instance.print},o.a.createElement(m.a,{type:"printer"}),"\u6253\u5370"),o.a.createElement(d.a,{type:"vertical"}),o.a.createElement(u.a,{size:"small",style:{border:"none"},onClick:this.zoomIn,title:"\u653e\u5927"},o.a.createElement(m.a,{type:"zoom-in"})),o.a.createElement(u.a,{size:"small",style:{border:"none"},onClick:this.zoomOut,title:"\u7f29\u5c0f"},o.a.createElement(m.a,{type:"zoom-out"})),o.a.createElement(s.a,{defaultValue:"1",value:this.state.zoomValue,style:{width:100},onChange:this.onZoomChange},o.a.createElement(s.a.Option,{value:"-1"},"\u81ea\u52a8\u7f29\u653e"),o.a.createElement(s.a.Option,{value:"0.5"},"50%"),o.a.createElement(s.a.Option,{value:"0.6"},"60%"),o.a.createElement(s.a.Option,{value:"0.7"},"70%"),o.a.createElement(s.a.Option,{value:"0.8"},"80%"),o.a.createElement(s.a.Option,{value:"0.9"},"90%"),o.a.createElement(s.a.Option,{value:"1"},"100%"),o.a.createElement(s.a.Option,{value:"1.1"},"110%"),o.a.createElement(s.a.Option,{value:"1.2"},"120%"),o.a.createElement(s.a.Option,{value:"1.3"},"130%"),o.a.createElement(s.a.Option,{value:"1.4"},"140%"),o.a.createElement(s.a.Option,{value:"1.5"},"150%")),o.a.createElement(d.a,{type:"vertical"}),o.a.createElement(u.a,{size:"small",style:{border:"none"},onClick:function(e){return w.instance.goFirstPage()},title:"\u9996\u9875"},o.a.createElement(m.a,{type:"step-backward"})),o.a.createElement(u.a,{size:"small",style:{border:"none"},onClick:function(e){return w.instance.goPrevPage()},title:"\u4e0a\u4e00\u9875"},o.a.createElement(m.a,{type:"caret-left"})),o.a.createElement(c.a,{ref:this.pageNumberInput,id:"PageNumberInput",onPressEnter:this.onGotoPage,className:"PageNumberInput"}),o.a.createElement("div",{id:"totalPage",className:"TotalPageLabel"},"/",this.state.totalpage),o.a.createElement(u.a,{size:"small",style:{border:"none"},onClick:function(e){return w.instance.goNextPage()},title:"\u4e0b\u4e00\u9875"},o.a.createElement(m.a,{type:"caret-right"})),o.a.createElement(u.a,{size:"small",style:{border:"none"},onClick:function(e){return w.instance.goLastPage()},title:"\u5c3e\u9875"},o.a.createElement(m.a,{type:"step-forward"})),o.a.createElement(d.a,{type:"vertical"}),o.a.createElement(u.a,{style:{border:"none"},onClick:function(e){return w.instance.rotate(-1)},size:"small",title:"\u9006\u65f6\u9488\u65cb\u8f6c"},o.a.createElement(m.a,{type:"undo"})),o.a.createElement(u.a,{style:{border:"none"},onClick:function(e){return w.instance.rotate(1)},size:"small",title:"\u987a\u65f6\u9488\u65cb\u8f6c"},o.a.createElement(m.a,{type:"redo"})),o.a.createElement(u.a,{style:{border:"none"},size:"small",onClick:function(e){return w.instance.fullScreen()},title:"\u5168\u5c4f"},o.a.createElement(m.a,{type:"fullscreen"}))),o.a.createElement("div",{className:"HFlexBoxRightContainer"},o.a.createElement(x.a,{id:"search",placeholder:"\u8f93\u5165\u641c\u7d22\u5185\u5bb9",allowClear:!0,onSearch:function(e){return w.instance.beginSearch(e)},className:"SearchBox"}),o.a.createElement(u.a,{id:"SearchPrev",size:"small",style:{border:"none",width:20},onClick:function(e){return w.instance.searchPrev()}},o.a.createElement(m.a,{type:"left"})),o.a.createElement(u.a,{id:"SearchNext",size:"small",style:{border:"none",width:20},onClick:function(e){return w.instance.searchNext()}},o.a.createElement(m.a,{type:"right"})),o.a.createElement(u.a,{style:{border:"none"},size:"small",title:"\u6587\u6863\u5c5e\u6027",onClick:this.onDocInfoButtonClick},o.a.createElement(m.a,{type:"info-circle"})),o.a.createElement(V,{ref:this.docInfoRef}),o.a.createElement(i.a,{content:e},o.a.createElement(u.a,{id:"more",size:"small",icon:"more",style:{border:"none",fontSize:14},title:"\u66f4\u591a"}))))),o.a.createElement(b.a,null,o.a.createElement(_,{collapsible:!1,collapsed:!0,collapsedWidth:40,style:{}},o.a.createElement(u.a,{id:"sidepanel-DocsManagerPanel",className:"SidebarButton",title:"\u6587\u6863\u7ba1\u7406",onClick:this.onDocManagerIconClick},o.a.createElement(m.a,{className:"SidebarIcon",component:A})),o.a.createElement(u.a,{id:"sidepanel-OutlinePanel",className:"SidebarButton",title:"\u5927\u7eb2",onClick:this.onOutlineIconClick},o.a.createElement(m.a,{className:"SidebarIcon",component:H})),o.a.createElement(u.a,{id:"sidepanel-CustomtagPanel",className:"SidebarButton",title:"\u8bed\u4e49\u6811",onClick:this.onCustomtagIconClick},o.a.createElement(m.a,{className:"SidebarIcon",type:"apartment"})),o.a.createElement(u.a,{id:"sidepanel-AttachmentPanel",className:"SidebarButton",title:"\u9644\u4ef6",onClick:this.onAttachmentIconClick},o.a.createElement(m.a,{className:"SidebarIcon",component:L}))),o.a.createElement(_,{id:"SidePanel",width:0,style:{borderLeft:"1px solid lightgray"}},o.a.createElement("div",{id:"SidePanelContent",className:"SidePanelContent"})),o.a.createElement(W,{id:"MainPanelContent",className:"MainPanelContent"}),o.a.createElement(_,{id:"RightSidePanel",className:"RightSidePanel",collapsible:!1,collapsed:!0,width:16,collapsedWidth:16},o.a.createElement("div",{id:"RightSidePanelContent",className:"RightSidePanelContent"},o.a.createElement("div",{id:"RightVScroller",style:{width:1}})))),o.a.createElement(K,{id:"OFDReader-Footer",style:{height:25,padding:0,fontSize:12,display:"none"}})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.base64Encode=function(e){var t=new Uint16Array(e.length);return Array.prototype.forEach.call(t,function(t,a,n){n[a]=e.charCodeAt(a)}),btoa(String.fromCharCode.apply(null,new Uint8Array(t.buffer)))},window.base64Decode=function(e){var t=atob(e),a=new Uint8Array(t.length);return Array.prototype.forEach.call(a,function(e,a,n){n[a]=t.charCodeAt(a)}),String.fromCharCode.apply(null,new Uint8Array(a.buffer))},l.a.render(o.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[188,1,2]]]);